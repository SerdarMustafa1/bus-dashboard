(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{180:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsIAAA7CARUoSoAAAAHuSURBVDhPY0AHZ8+etf/06dPsjx8/3vv69et/EAay7wPxbKCcA1QZJpg6dSr7mzdvlv/79+8/LgCSA6kBqYVqY2AEESCB6Ojok/z8/Pog/oHTdxg2HX7A8OjlZwaG/wwMchK8DH62CgwOpiogaQagay4uW7bMPCsr6yfYAJCpwsLCEb9+/WEonbiH4djV9wyMjGApOAA6gMFKW4ihK9+ZgZ2NheHdu3crgHoiGUF+NjQ0PADSUNy3i+Hw5XdQLdiBra4QQ2+RG9jA8+fPOzCpqqrGgDSfuvSA4eClt1BluMHBi2/BakF6QHqZgCY5gyQ2HXnAwITmbGyAiYkRrBYEgHpdmFhYWBRBnMevvoIFiQEwtUC9CkxgFhAwA00mFiCrZfrz5w/YPYqSPGABYoCiFC+YBukFuWAPiBPuqg701D8QEz8Aqgl3UYNyGPYw3blzZykoStQUxBmC7WWh4rgBSA1ILUgPSC8sIYESRThIsHfxUYbV+x8BEyA8eMCAkeEfQ6iDHENxnDU4Ct++fbtSREQkghkkKS8vv1ldXd2Xg4NDwkpfjsHTQhro1N8MfFwsDLJiXAxWumIMTakWDJ426mDNoKS8YsUK761bt/4Fmw4C06ZNA2WmFURkphUgtVBtmACUZaHZ+T7h7MzAAADkjSMLDltY0QAAAABJRU5ErkJggg=="},181:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsIAAA7CARUoSoAAAAGPSURBVDhPjZPPSgJRFMbPHYdaFijUsizbz7Y/JNQLBEEGPUKLgnqKhFa6cR0ZtGnVxoVotQhkegDLwBYJKmrMRse5ne92RwbNmh/cuWfO+b7LHeYcGqdSqWz3er1ct9t9cxxHYnFc45XjWlLLJslkMrPNZvPa8zw5DdSggVbbfkCi0+m8aJ0cfBTloHwi+/d7aiFGzgfabDarDhF44NRoNJqiYZ/cpzOixqNfCiCJFjbIXE8TRWao3W7n2XMo8M2WZRWFEOQ+nBJ9lrVhCotbZG5eEl+EbNtOGolE4gjmYeOZzSWt+gPWQAsPvAaftIO8rN3xc/zavyG0lj1S7hqmaS6rN6eutlBoLXuXDBUxHkV09D9BreG67rsK5uIqEQZfCy9uUMCLWD3AFoqAtmBUq9Ur/JLI/BqJ+L7OTwcaaOGB128kNAUfK8m1L4hebznroRTAILHCZuucY0GtVusmFoulVAmtzMMyauXhV10O7LTsl47VQoycT7CVRyCBm4QYpvyEOQhGVo9z7f9xJvoGl9RK2nAZgogAAAAASUVORK5CYII="},182:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsIAAA7CARUoSoAAAAGISURBVDhPjZM/S8NQFMVfnvUPutjiB6hDRBSELq4WdFFRcFAcOikIxaXgoH6Qdik4VdpNVNSliLiHOGQRQtMlW4NJIFQk5PnOM6nVEM0vXPJy7zk3Kb2X/EZRlBXXdeuO43Q8z2MIfjZ41HmtGMriVKvV8V6v1wyCgCWBGjTQhrYvkLBt+yXUseu3e7Zt7LP512UROCMXAW2tVvtugq4o9IN3tmnsMapl2YiW+xFUmxY1aIBlWU14JfzmQqHwJEkS2emWyK33IJomsTW1Tq7yDcJ7EFVVi1SW5RLMj+4zufHuQlky0EALD7yUd1pF4cJuEIlQIfoLaKAF3LtGM5nMLB70j45IpiHScm9+8MpRfqVlWEt93+/isDAxJxJpiLTw4gvaeDjOHeGWiiFtm+q6fom/ZGlykZSzh2E+mXL2QGjhgVck+SC1eIIF/KqYZ2xMm4kNEnIV81RoADzCDDDKfFkGo6z3DXZinrONzq4InJGLiI0yQAJdUyxTK2YeBisbrrPx/zoT8glMe3fWyqhIqgAAAABJRU5ErkJggg=="},183:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsEAAA7BAbiRa+0AAAGVSURBVDhPjZO9TsJgFIZPC2HDSNoFU0IUouBmZAMl4sA16AV4UY4McgkkECGoCQM1TEgcEEkRGfizkBASfux7QgmCSp+kzfl536/92vPROuVyOdLtdhPD4VAbjUZzXIg7nU4CvYVsk1QqtdNut+9ms9n8L9CDBtqFjQTcUAiHw/dOpzOEvF7XqFqtUa/XR0ou1y75fPvk9Xo4HwwGaqFQuIzH4zovgFUlSbqaTCaUzz9Ro9Fk4TqKskfRaITsdjsZW0rKsnwtYF/BYPBREATKZh9I0xoL+e94PArFYudk7IgqlcqZ6Ha7b2D+aH5uNQNooIUHXtHhcFygUXt7Z4EVTC28os1mU5D0+19ctIKphVfkyEAQluFWVrXidDrljUuSiwtWMLXwiuPxOIfE7z/gD7MNaKAF8IqtVusWv0SWJQoEDrnxH9BACw+8PwYJRfW5RJWXVxasgicHj48odHrCsTlI3MQo67peNEyMMcJzVS3NM5kcX4hRMzFGuZhOp5fngUHBeJOklcO0YV4Fo42ja+04E30DoEc977NtoxoAAAAASUVORK5CYII="},186:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAB3RJTUUH5AMEBTI2rcIdsAAABQRJREFUWMO1V11oU2cYfs53TpPUo02zpm6wrKWdpgpTZ8OwXuynTJrtJsqgndALvdEtKQiCjFEGS2ctg+HVlhirF1JGwYatAcERJ1XZYBVx6SqoJ+1O/AmKq/mp+enx5Jzz7WbRnCar1sbn8vm+7/35zvt+530YLIGxsTH09PQAAMLhcIvVanXwPO/ieX4bx3F2k8kEAJAkCYqizORyuclsNnsmkUhcdTqdIgCEQiHs2rULy0YgEAAAeL3ezaIoRmRZzquqSp8FVVWpLMt5URQjXq93CwAcO3bs+R0PDQ0BAA4fPtwoCMJxWZbpi0KWZSoIwvEjR440ltp+Jnw+ny2ZTKZolZBMJlM+n89WyRdTmnl/fz8mJia62tvbfzGbzaTSgT/+FBCJPsTtB1lk8wUAwJraGjS9thpb7VZsb2+rmNT8/LwWiUQ+7uzsPFf0pQugmHlvb+/txc4ppfjtynX0+3/HAjWDJQwAWpaLqlHUMmkMed7Du+9sBMMwZUGMjo42ezyeuO4GAoEA5ubmGvv6+qIWi6W+9FAqlcKB787h2m0ZBoOhguPyS5VlGW81G/D9F05Y6nXmkE6n0z6fz97Q0DDndrvBFFtNEITjdrt9f+nmew+S6P4yhAKzGqDa8tqIITDQHE5/uxOvv/qKbikajZ5oa2vbHwwGwQaDQXi93s0ul+sky7JPNmWzGew89DNkugrMM7OuBAqF1mB84hp6PlwHg8H4ZKWurs7Bcdy4x+N5wACAKIqRlpaWt0u/+f6Bn/DXHW35mVe4iS1NLIa//kRXE7FYbKq1tXUrCYfDLTabTVe60dg9XJnJrdw5AFANV6JZRGP3dLTNZmsLh8MtxGq1OliWrS1dPHT0LGoMJlQLNUYTDh09q+NYlq21Wq0OwvO8i5CnXTcbu4v4I/4Fv/v/9QVFPMNjNnb3CUcIAc/zLsLz/LbSzdOzD8GyBNUGSwimZxM6juf5DsJxnL2UvHU/A7LoAakGCMPg1v1HOo7juPWk+EstIicpeFlYbNtkMoGUXxXz0gKoZJtIkqQj6tcYXloAi21LkgSiKMpMKbnOZoZGadWda5Rinc2s4xRFmSH5fH6ylOzY9AakfKbqATxeyKJjU5O+JnK5SZLJZM5omlbyTpvxkaMeqlY956oGdLWbUVdX9/RGNA3ZbPYMSSQSV1VVXSg9MHDABQ5S1QLgIOGbAy59UKq6kEgkrhKn0ynG4/Go7oGoNWJ3pw0FdeXOCyqwu9MGvtao4+PxeNTpdIoEAEZGRvYUCgXdhoN7d8DRrK2oIDVK4WjWcHDvDn1QhQJGRkb2AABTnNsFQRi22+379FWqom9wDJN/A0Zuee/DY4Vi+5vAD1/1gONY3ZogCCc3bNiwLxQKPR3JEolEo9vtnrFYLObFxoZPX8KP5+/gkcTCwLFLjGUMZEVFnVFF744mfLb7/bIdqVRq3u/32xsaGv5xu90Vh9I7ZrO5LN3HsoKTwUsIjF9HzSorCGFQ/GVQCmgahZx/iM93bsS+Tz+A0cBVmozp6OhoU+lQWiZILl682JVOp7Wl5vzpGyIdPz9FT4Uu01Ohy3T81yk6fSO2pDZIp9PahQsXup5LoPj9flsymUxXUZik/X6/bbnSbK0gCMMrlWY3b948MTg4uHZZ0qxUUA4MDGwWRXHqBcTp1POI0yV7KxgMoru7uyjPW61Wa/t/8ryD47j11ZDn/wJiWtpgN/kHzAAAAABJRU5ErkJggg=="},187:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAB3RJTUUH5AMEBTAJKZJSDwAABJ1JREFUWMO1V01MG0cYfTu7gGFVHMKaA7JamSiGQ5qkBUHUHipVCr5ZuYCQOOTSEBlOVMqlJ0ckXHuy+QnKgYMPWKJIHCr3AFRKI9QGgVIqsZBslMap1Dpr1sV27PXOTg8Otdc2/+YdP++8ed8383m+x+EQzM3Nob+/HwAQiURckiR1iqLoFUWxRxAEt81mAwBkMhkYhrGTSqVWk8nkoqqqax6PRwGAhYUF3Lp1CyfG5OQkAMDv919VFGVd1/U0pZQdBUop03U9rSjKut/vvwYAExMTx994fHwcADA2NuaQZXlK13V2Wui6zmRZnnr48KGjmPtIBAIBZzwe32VVQjwe3w0EAs5jZb60tNSraVrFWpuMMePtE5Z9PsGMp/dYeukuSy/dZcbTe/nY2yfMPECEpml0eXm5t7QSXGnmg4ODr+12O7HKY8hEfwH323fgjT2A4ytnwSgo/xFY9zhszi9L6ZFIJMxQKPTJ8PBw1CJgcnISsVjMMTIyst3U1HSheBFNx0CffgsSfw4QoYy0ggrANMAufgryxffgGxyWXzVN0wKBgLu5uTnm8/nA7beaLMtTbrd7qPhjM/UXzJ/6AJrFqcDXgfSGQcRWS3h7e/tRe3v7UDgcBh8Oh+H3+696vd4Zni+Ulmb/BfvRC5jZY2R9UDEMMGUerK0fRKj7P9zY2NgpCMIPw8PDf3MAoCjKusvlul5cxuzSEPj4OqoB8+I11H49Y0nk1atXG21tbZ+RSCTicjqd7cULsuoL8O9+RbVA3j1DVn1hiTmdzvZIJOIikiR18jxfb1mwOvrhwlVLgQBuddR6PXi+XpKkTiKKopeQQtdR7QW41JvTn3tFcCCpN6BaoQqEEIii6CWiKPZY2u7d7wf3+Zk08HnuIoiieIMIguC2lCb1GuDIOQggee4iCIJwmew/qfswMnGcF0q5bTYbylKlpP7cBFTiJplMxhKoqWs8NwGl3JlMBsQwjB2LogtugNHq785onrv4SAxjh6TT6VXLv1ZLz7kJMFssDYdUKrVK9vb2Fk3TLJTJ1gjaerO6IhgFbb2JGlvhCEzTRDKZXCSqqq5RSt9bWrF7DIzUVm9/Ugu+e8x6ISl9r6rqGvF4PEo0Gt229GdtA9ilAcDMVeElyoFdGoBQ22AJR6PRbY/HoxAAmJ2dvZ3LWTervT4KSF0AY2dInQFSV56rCLlcDrOzs7cBgNuf22VZnna73Xcs600D9OchIPYMOOmRmDrg6AL/1TS4kodNluWZjo6OOwsLC4WRTFVVh8/n22lqarKXDFjIbU4BOyGQnAaQmiNLbtZcAHd5AMIVX9mTtru7mwgGg+7m5uZ/fD5fxaH0T7vdXv4U0iwymzMQtiYATsi/FxxXKDUzAWYg1+FD/ZVvAL6ujCKRSLBQKPRx8VBaNpavrKz0appmHuh8GGN67A9GX86z9OZjlt58zOjL+XzsEG+gaZpZaSyviGAw6IzH41oVjYkWDAadJ7VmLbIsT5/Vmm1tbT168OBBy4msWbGhvH///lVFUTZOYU43jmNOD527wuEw+vr69u15myRJn3+w5zcEQbhcDXv+H1Kc+KaA2vifAAAAAElFTkSuQmCC"},188:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAB3RJTUUH5AMEBS0dzCTqbgAABLpJREFUWMO1V01MFGcYfubbAQam2B13sG26LbWty8VgUhP1QGIvdQ9t8K+amqjcTDYe7K2JbcISRI02vdhdVC7CrXIxNZosB+FIqwbrbiKzqxst0LTF2R3C7jLM39sDXZyBBRTXJ5nL837f977P+81knpfDKrh+/ToOHz4MAEgkEptlWd4uimK7KIo7eZ4PCYIAANB1HZZlZYrF4mihULipqur9cDicBYAbN25g3759eGVcvnwZABCNRluz2eyYYRgl27ZpLdi2TYZhlLLZ7Fg0Gt0GAL29vS+f+OzZswCA7u7uJkVRrhiGQeuFYRikKMqVnp6eJvfZayIWiwVzuVyeqoRcLpePxWLBl1J+586dPZqmVe61Q3R7Zog6p87T1087KJw+SOH0Qfr6aQd1Tp2n2zNDRE7lIjRNs4eHh/es2olYLBaslNwhh27lhsj/sJmQ3EAsJZEvtdHzsJRESG4g/8NmupUbIqdCJZqm2fF43NMJrvzCTU9PN508eTItSZLfveAf/Tn2TnyD3/TfwRgPbmHLiiAQHDKxo24Hfv3gF7wjyJ64pmlaLBYLBQKB6UgkAq78qSmKciUUCp1wL35q/Imtj3dBp3msBwJXh9Sno/io9kMPn06n+1paWk4MDg4uyIlGo62nT5/+o6amZnHRrFHEu4+3QCd9TdWrdUPgBPz9SQaNdeIib5omzp07t62zs/MhA4Djx4/3u5MTCHufHcE8za87+cL9cpinebRPHAGBFvmamhocO3asHwBYIpHYHAwGW9wbU7OPMDw/jGphRB9GavaRhwsGgy2JRGIzk2V5u8/nq3cH908cBcfxVSuA43jsnzjq4Xw+X70sy9uZKIrtjLHFQLL0CE+cDBhY1QpgYHjiZJAsvegCYwyiKLYzURR3uhePFu5VVb27C6OFex5OFMVdjOf5kJvMmNVV7+5Cxsx4OJ7nt7DyL7UM1crjTWHp2YIgLJcqkvjGCqh0NtN13UNsqHvrjRWw9Gxd18Esy/JcTKuwFTbsqie3YaNV2OrhLMvKsFKpNOomvxA/B2yr+vIdc+FsF4rF4iibnZ296TjOIinV+nFAPAAbVhXVWzjQcBBS7YsfreM4KBQKN5mqqvdt255zb7jW3ItaEqpWQC3V4Vqz1xfatj2nqup9Fg6Hs5OTk2l3sJEXccofgU3G66snA6ekCBp57xcwOTmZDofDWQYAAwMDHaZpehZcCEbR1tAGB876rx0O2hracOH9Lg9vmiYGBgY6UPbtAKAoytVlrtYxaXfmK0KyYZkFW+tBUqTdj78kwzGXWbPx8fG+cu5FS6aqalMkEslIkvT2UiXdf/2In/I/QyMVPq52zZb7uQC+3RhB53vfLYvn8/mZeDweCgQC/0YikYqmtKKvnbPn6IdnPYRkPSHZSFzKTywlEUtJxKX8hGQjIVlP3z/roTl7biVn7Cw1pcts+cjIyJ6Viihb87szY9T3vJ8uTl2ii1OXqO95P92dGVvRkpeTr2nLy4jH48FcLqdVcTDRVlS+ymi2SVGUq687mo2Pj/edOXNm0yuNZu6BsqurqzWbzT5Yx3D64GWG01Ut7+DgIA4dOlQezz+WZfmz/8fzXTzPb6nGeP4fNK2j/eABaRYAAAAASUVORK5CYII="},189:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsIAAA7CARUoSoAAAAQnSURBVFhHtZddTxtHFIYPu8YmNYi4xnwFx0BkqJI0wEVLKVKRFWrftspN1SpSpUr8AH4B/6IS4qpF6VWVCwqoLrSGqCDKBViitHwIWOwmARxC7DWJHbA77/Tg+gNSqJdHWjFzxvOeZebMmbMldA4GBgaooaHhekdHx6dVVVUei8XSZjKZrpvNZgXjyWQydXR0tJ1IJIJ7e3uBxcXFh+FwWMO8ohkbG/twc3PzB13XX6fPCX6LOaOjo93/+yWGhoaqVldXvxH/1THrXhjMFRrfQotlz8f4+Pj7u7u7GusUDbSgyfI5FMTA1NSUV+z19xUVFeVsyiC06OnTXfHs0PODA9L1Q2kvt75FNttVqq2tEU81lZQUhlYsFtMXFhbu9fT0+Nkkyfkl3rK7u3sy33kqlaK1tQ1aWloWTnW2nk55uZVu375FbnczKYqM0Qxirj4zM3PX5/P9xiZS+a/cc4/HM2Gz2RxskogXp4nJAK2triPa2Xo2yeRrCof/osePn1BdXS1ZLGYeIRKnxlxZWelraWkZHhkZkcuXWQEEnNvtvs9dyfODF/STf5JevnzFlotx5UoZfey9S7arlWz5B+FruLW1VfqSa4Sj5nK5vkD7hHj8sCjnAHOhAa1sGhsbP4dPtFWc097e3q/tdnurHBUg2H7+5REdiBUoFpGg6Nn+Pt240ZQJTlVVS0pLS2vFdj9QkOEcDodPjjDadoh2RKQbxY44OdDMBj7hW0F6tVqtJrZLfl/6g1vGka8Jn/CtILezTRKNxigSecY944AmtLOBbwUXC/clSDSXRb42fCu41bgviUaj3DKefG34Vk6u1BPyj4yRxA9zteE7N1cKFDWTHA1HUQq1FRQT3JbgYrks8rXhW0Elw32J3f42t4wnXxu+FZRR3JdUVzuQqbhnHNCEdjbwraCG476krMxCTmcD94wDmtDOBr4VFJDxePyIbZI7d24V3OXFAC1oZgOfwWDwoYLqVbzJj2yXoLq5efMd7hUPtKCZDXyGQiFNDQQC5PV6NXEdf4lbiseppqZapk8UJMVQX19HXV2dYhX+Lb4Q/XNzc1/19fWF5DrPz8//qmnaAznKqKpCHs9HdO1aPVsuDuZCA1rZbG1tfQefaMtwxyq0tbU9cjqdn4lbKlO+YO+amlxoiNWIUDqV5pE3o5pUofcudX3wXoFzobPt9/vv9ff355ZkQBSlnaIonTitItb1OC0v/0kbm1uUeJVgay7icqHm5ka55yhO80FROjs72yu2fI5NhaAsFyV0TBb0p3B8fJyORPbT6+sb6cXgknzQhg1jZwHN6elpL7t5M2KJOkWUbvPcohFaGjRZ/nwMDg46VlZWhov9NIOGKPlzU+BFEHFxqR+nOUF4FhARJ8TV3t7+yRmf52lxsWjI7UivyHBIMv/9ZUz0NwKdjI1k5P8pAAAAAElFTkSuQmCC"},192:function(e,t,a){e.exports=a(302)},198:function(e,t,a){},199:function(e,t,a){},201:function(e,t,a){},202:function(e,t,a){},203:function(e,t,a){},204:function(e,t,a){},222:function(e,t,a){},223:function(e,t,a){},228:function(e,t,a){e.exports=a.p+"static/media/trolleybus.b1dd7a6e.svg"},229:function(e,t,a){e.exports=a.p+"static/media/bus.a489e26c.svg"},23:function(e,t,a){var n={1:{name:"trolleybus",img:a(228)},2:{name:"bus",img:a(229)},3:{name:"tram",img:a(230)}};function r(e){return e?parseInt(e.split("-").slice(-2)[0]):""}t.vehID=function(e){return e?e.split("-").slice(-1)[0]:""},t.vehType=r,t.vehTypeStr=function(e,t){var a=r(e);return Object.keys(n).includes(a.toString())?t("vehicle.type."+n[a].name):t("vehicle.type.unk")},t.vehTypeObject=function(e){return n[r(e)]},t.measure=function(e,t,a,n){var r=a*Math.PI/180-e*Math.PI/180,c=n*Math.PI/180-t*Math.PI/180,l=Math.sin(r/2)*Math.sin(r/2)+Math.cos(e*Math.PI/180)*Math.cos(a*Math.PI/180)*Math.sin(c/2)*Math.sin(c/2);return 1e3*(6378.137*(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))))}},230:function(e,t,a){e.exports=a.p+"static/media/tram.23f970ee.svg"},302:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(33),l=a.n(c),i=(a(197),a(198),a(199),a(200),a(201),a(202),a(203),a(204),a(131)),o=a(171),s=a(6),m=a(174),u=[{short:"en",name:"English"},{short:"fi",name:"Suomi"}];i.a.use(m.a).use(o.a).use(s.a).init({whitelist:u.map((function(e){return e.short})),fallbackLng:"en",backend:{loadPath:"/assets/i18n/{{ns}}/{{lng}}.json"},ns:["translations"],defaultNS:"translations",keySeparator:!1,interpolation:{escapeValue:!1,formatSeparator:","},react:{wait:!0},missingKeyHandler:function(e,t,a,n){console.log("MISSING LANGUAGE KEY:",e,t,a,n)}}),i.a.validLangs=u;i.a;var d=a(1),p=a.n(d),h=a(9),f=a(12),b=a(13),g=a(15),v=a(14),E=a(175),y=a.n(E),w=a(7),x=a(37),k=a(31),A=r.a.createContext({token:null,tokenExpiration:null,_id:null,name:null,role:null,login:function(){},logout:function(){}}),O=a(43),C=a(21),j=a(26),S=a(27),N=a(8),_=a(2),D=a(177),I=a(18),T=a(22),B=a(32),R=a(36),L=function(){var e=Object(h.a)(p.a.mark((function e(t,a,n){var r,c,l;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n||sessionStorage.getItem("_t")||localStorage.getItem("_t"),e.next=3,fetch("/api",{method:"POST",signal:a,body:JSON.stringify({query:t}),headers:{"Content-Type":"application/json",Authorization:r?"Bearer ".concat(r):""}});case 3:return c=e.sent,e.next=6,c.json();case 6:if(!(l=e.sent).errors){e.next=9;break}throw new Error(JSON.stringify(l.errors));case 9:return e.abrupt("return",l.data);case 10:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),F=function(){var e=Object(h.a)(p.a.mark((function e(t,a,n,r){var c,l,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==(c=n?parseInt(n):0)){e.next=3;break}return e.abrupt("return",M(t,a,r));case 3:return l='mutation{installOrderCreate(placement:"'.concat(a,'", team:"').concat(t,'", count:').concat(c,"){count}}"),e.prev=4,e.next=7,L(l);case 7:i=e.sent,i.installOrderCreate&&r(),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(4),console.log("Ohnoo, ",e.t0.toString());case 15:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(t,a,n,r){return e.apply(this,arguments)}}(),M=function(){var e=Object(h.a)(p.a.mark((function e(t,a,n){var r,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r='mutation{installOrderRemove(placement:"'.concat(a,'", team:"').concat(t,'")}'),console.log(r),e.prev=2,e.next=5,L(r);case 5:c=e.sent,c.installOrderRemove?n():console.log("Cant Remove"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.log("Ohnoo, ",e.t0.toString());case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,a,n){return e.apply(this,arguments)}}(),U=Object(s.b)()((function(e){e.t;var t=e.assigned,a=e.team,c=e.placement,l=e.refresh,i=Object(n.useState)(String(t)),o=Object(O.a)(i,2),s=o[0],m=o[1];return r.a.createElement("td",null,r.a.createElement(I.a,{onSubmit:function(e){e.preventDefault(),""===s&&m("0"),F(a,c,s,l)}},r.a.createElement(B.a,null,r.a.createElement(R.a,{value:s,onChange:function(e){return""===(t=e.target.value)||/^\d+$/.test(t)?m(e.target.value):void 0;var t},style:{maxWidth:"55px"},type:"text"}),s!==String(t)&&r.a.createElement(B.a.Append,null,r.a.createElement(T.a,{variant:"primary",type:"submit"},r.a.createElement("i",{className:"fa fa-paper-plane"}))))))})),q=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={campaign:{},teams:{},loaded:!1},e.controller=new AbortController,e.loadFullData=Object(h.a)(p.a.mark((function t(){var a,n,r,c,l,i,o,s,m,u,d,h,f,b;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a='query{teams{_id company} campaign(_id:"'.concat(e.props.match.params.id,'"){name placements {_id count place{name}installOrders{team{_id}count}}}}'),t.prev=1,t.next=4,L(a,e.controller.signal);case 4:n=t.sent,r=n.campaign,c=n.teams,l={},i=Object(S.a)(c);try{for(i.s();!(o=i.n()).done;)s=o.value,l[s._id]=s}catch(p){i.e(p)}finally{i.f()}m=Object(S.a)(r.placements);try{for(m.s();!(u=m.n()).done;){(d=u.value).teamsInstallOrder={},h=Object(S.a)(d.installOrders);try{for(h.s();!(f=h.n()).done;)b=f.value,d.teamsInstallOrder[b.team._id]=b}catch(p){h.e(p)}finally{h.f()}}}catch(p){m.e(p)}finally{m.f()}console.log(r),e.setState({campaign:r,teams:l,loaded:!0}),t.next=20;break;case 16:t.prev=16,t.t0=t.catch(1),console.log("Ohnoo, ",t.t0.toString()),e.setState({loaded:!0});case 20:case"end":return t.stop()}}),t,null,[[1,16]])}))),e.refresh=Object(h.a)(p.a.mark((function t(){var a,n,r,c,l,i,o,s,m;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("REFRESHING"),a='query{campaign(_id:"'.concat(e.props.match.params.id,'"){name placements {_id count place{name}installOrders{team{_id}count}}}}'),t.prev=2,t.next=5,L(a,e.controller.signal);case 5:n=t.sent,r=n.campaign,c=Object(S.a)(r.placements);try{for(c.s();!(l=c.n()).done;){(i=l.value).teamsInstallOrder={},o=Object(S.a)(i.installOrders);try{for(o.s();!(s=o.n()).done;)m=s.value,i.teamsInstallOrder[m.team._id]=m}catch(u){o.e(u)}finally{o.f()}}}catch(u){c.e(u)}finally{c.f()}e.setState({campaign:r}),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(2),console.log("Ohnoo, ",t.t0.toString()),e.setState({loaded:!0});case 16:case"end":return t.stop()}}),t,null,[[2,12]])}))),e}return Object(b.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){console.log("Assigns"),this.loadFullData()}},{key:"render",value:function(){var e=this;if(!this.state.loaded)return null;var t=this.props.t;return r.a.createElement("div",{className:"container-fluid"},r.a.createElement(N.a,null,r.a.createElement(_.a,null,r.a.createElement(w.a,null,r.a.createElement(w.a.Header,null,t("db.assign.table.title")," ",this.state.campaign.name),r.a.createElement(w.a.Body,null,r.a.createElement(D.a,{responsive:!0,striped:!0,bordered:!0,hover:!0,size:"sm"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,t("db.assign.table.placements")),Object.keys(this.state.teams).map((function(t){return r.a.createElement("th",{key:t},e.state.teams[t].company)})),r.a.createElement("th",null,t("db.assign.table.total")))),r.a.createElement("tbody",null,this.state.campaign.placements.map((function(t){var a=t.installOrders.map((function(e){return e.count})).reduce((function(e,t){return e+t}),0);return r.a.createElement("tr",{key:t._id},r.a.createElement("td",null,t.place.name," ",t.count-a===0&&r.a.createElement("i",{className:"text-lime fa fa-check"})),Object.keys(e.state.teams).map((function(a){return r.a.createElement(U,{key:a,assigned:t.teamsInstallOrder[a]?t.teamsInstallOrder[a].count:0,refresh:e.refresh,placement:t._id,team:a})})),r.a.createElement("td",null,a,"/",t.count))})))))))))}}]),a}(n.Component),P=Object(s.b)()(q),V=(a(222),a(223),a(157),a(224),a(97));V.DataTable=a(136);var W=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).arrayToObject=function(e,t){return e.reduce((function(e,a){return e[a[t]]=a,e}),{})},e}return Object(b.a)(a,[{key:"componentWillUnmount",value:function(){}},{key:"componentDidMount",value:function(){var e=Object(h.a)(p.a.mark((function e(){var t,a,n=this;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.props.columns.map((function(e){return e.load?e.load(n.arrayToObject):""})));case 2:t=this.props.t,a=sessionStorage.getItem("_t")||localStorage.getItem("_t"),this.$table=V(this.el).DataTable({order:this.props.order,data:this.props.data,ajax:this.props.data?void 0:{url:this.props.ajax,type:"GET",beforeSend:function(e){a&&e.setRequestHeader("Authorization","Bearer ".concat(a))}},columns:this.props.columns,rowCallback:this.props.rowCallback,responsive:!0,language:{lengthMenu:t("dataTable.lengthMenu"),zeroRecords:t("dataTable.zeroRecords"),info:t("dataTable.info"),infoEmpty:t("dataTable.infoEmpty"),infoFiltered:t("dataTable.infoFiltered"),search:t("dataTable.search"),loadingRecords:t("dataTable.loadingRecords"),processing:t("dataTable.processing"),thousands:t("dataTable.thousands"),paginate:{first:t("dataTable.paginate.first"),last:t("dataTable.paginate.last"),next:t("dataTable.paginate.next"),previous:t("dataTable.paginate.previous")}}}),this.props.setRefresh&&this.props.setRefresh(this.$table.ajax.reload);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement("table",{className:"display",width:"100%",ref:function(t){e.el=t}},r.a.createElement("thead",null,r.a.createElement("tr",null,this.props.thead.map((function(e){return r.a.createElement("th",{key:e},e)})))))}}]),a}(n.Component),H=Object(s.b)()(W),G=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={redirect:"",thead:["#",e.props.t("db.assignments.table.name"),e.props.t("db.assignments.table.placements"),e.props.t("db.assignments.table.assigned"),e.props.t("db.assignments.table.start"),e.props.t("db.assignments.table.end")],columns:[{data:"_id",visible:!1,searchable:!1},{data:"name",render:function(e,t,a){return"".concat(e).concat(a.priority?' <badge class="badge badge-danger ml-2">Removal priority</badge>':"")}},{data:"placements",defaultContent:"0"},{data:"assigned",defaultContent:"0"},{data:"startDate",render:function(e){var t=new Date(e);return"".concat(t.getDate().toString().padStart(2,"0"),".").concat((t.getMonth()+1).toString().padStart(2,"0"),".").concat(t.getFullYear())},searchable:!1},{data:"endDate",render:function(e){var t=new Date(e);return"".concat(t.getDate().toString().padStart(2,"0"),".").concat((t.getMonth()+1).toString().padStart(2,"0"),".").concat(t.getFullYear())},searchable:!1}],ajax:"/api/datatable/assignments",rowCallback:function(t,a){t.classList.add("click"),t.onclick=function(){return e.setState({redirect:a._id})}}},e}return Object(b.a)(a,[{key:"componentDidMount",value:function(){console.log("assignments")}},{key:"render",value:function(){if(this.state.redirect)return r.a.createElement(k.a,{push:!0,to:"/dashboard/assign/".concat(this.state.redirect)});var e=this.props.t;return r.a.createElement("div",{className:"container-fluid"},r.a.createElement(N.a,null,r.a.createElement(_.a,{xs:12},r.a.createElement(w.a,{className:"m-b-20"},r.a.createElement(w.a.Body,null,r.a.createElement("h4",{className:"mt-0 header-title"},e("db.assignments.table.title")),r.a.createElement(H,{ajax:this.state.ajax,columns:this.state.columns,thead:this.state.thead,rowCallback:this.state.rowCallback}))))))}}]),a}(n.Component),z=Object(s.b)()(G),Q=a(107),Y=a(178),Z=a.n(Y),J=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={options:{chart:{stacked:!1},xaxis:{type:"bar"}},total:0,series:[]},e.controller=new AbortController,e}return Object(b.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){var e=Object(h.a)(p.a.mark((function e(){var t,a,n,r,c,l,i,o,s,m,u,d;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t='query{place(_id:"'.concat(this.props.data._id,'") {placements {count created_at}}}'),e.prev=1,e.next=4,L(t,this.controller.signal);case 4:if(a=e.sent,(n=a.place)&&n.placements.length>0){c={name:"",data:[]},l={},i=0,o=Object(S.a)(n.placements);try{for(o.s();!(s=o.n()).done;)m=s.value,u=new Date(parseInt(m.created_at)).toISOString().split("T")[0].slice(0,-2)+"01",l[u]?l[u].y+=m.count:(d=new Date(u),l[u]={x:"".concat(this.props.t("month."+d.getMonth())," ").concat(d.getFullYear()),y:m.count}),i+=m.count}catch(p){o.e(p)}finally{o.f()}(r=c.data).push.apply(r,Object(Q.a)(Object.values(l))),this.setState({series:[c],total:i})}e.next=11;break;case 9:e.prev=9,e.t0=e.catch(1);case 11:case"end":return e.stop()}}),e,this,[[1,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return this.state.total<=0?null:r.a.createElement(_.a,{sm:12,md:6,xl:4},r.a.createElement(w.a,{className:"m-b-20"},r.a.createElement(w.a.Body,null,r.a.createElement(N.a,{className:"pl-3 p-0 m-0"},this.state.total," ",this.props.data.name),r.a.createElement(Z.a,{options:this.state.options,series:this.state.series,type:"bar",height:"250"}))))}}]),a}(n.Component),K=Object(s.b)()(J),X=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={places:[]},e.controller=new AbortController,e}return Object(b.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){var e=Object(h.a)(p.a.mark((function e(){var t,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"query{places { _id name }}",e.prev=1,e.next=4,L("query{places { _id name }}",this.controller.signal);case 4:t=e.sent,(a=t.places)&&this.setState({places:a}),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(1);case 11:case"end":return e.stop()}}),e,this,[[1,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement("div",{className:"container-fluid"},r.a.createElement(N.a,null,this.state.places.map((function(e){return r.a.createElement(K,{key:e._id,data:e})}))))}}]),a}(n.Component),$=a(20),ee=a.n($),te=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={client:{_id:"",company:"",person:"",email:"",phone:""}},e.controller=new AbortController,e.handleDelete=function(){var t=Object(h.a)(p.a.mark((function t(a){var n,r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.props.t,r='mutation{clientHardDelete(_id:"'.concat(e.state.client._id,'")}'),ee.a.fire({title:n("db.client.form.delete.warning.title"),text:n("db.client.form.delete.warning.text"),icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes",cancelButtonText:"Cancel"}).then(function(){var t=Object(h.a)(p.a.mark((function t(a){var c;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.value){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,L(r,e.controller.signal);case 5:c=t.sent,c.clientHardDelete?(ee.a.fire({icon:"success",title:n("db.client.form.delete.success.title"),showConfirmButton:!1,timer:1500}),e.setState({client:{_id:"",company:"",person:"",email:"",phone:""}}),e.props.doRefresh()):ee.a.fire({icon:"error",title:n("db.client.form.delete.failed.title"),text:n("db.client.form.delete.failed.text"),showConfirmButton:!1,timer:1500}),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(2),console.log("Error while loading",t.t0.toString());case 13:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e){return t.apply(this,arguments)}}());case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(b.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState({client:{_id:"",company:"",person:"",email:"",phone:""}}),e.selected&&this.loadClientData(e.selected)}},{key:"loadClientData",value:function(){var e=Object(h.a)(p.a.mark((function e(t){var a,n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a='query{ client(_id: "'.concat(t,'"){ company person email phone }}'),e.prev=1,e.next=4,L(a,this.controller.signal);case 4:n=e.sent,(r=n.client)&&(r.email||(r.email=""),r.phone||(r.phone=""),this.setState({client:Object(C.a)(Object(C.a)({},r),{},{_id:t})})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log("Fetch failed: ",e.t0.toString());case 12:case"end":return e.stop()}}),e,this,[[1,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"handleSubmit",value:function(){var e=Object(h.a)(p.a.mark((function e(t){var a,n,r,c,l,i,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=this.state.client,n=a._id,r=a.company,c=a.email,l=a.person,i=a.phone,o=n?'mutation{clientUpdate(_id:"'.concat(n,'" company:"').concat(r,'",person:"').concat(l,'",email:"').concat(c,'",phone:"').concat(i,'"){ company }}'):'mutation{clientCreate(company:"'.concat(r,'",person:"').concat(l,'",email:"').concat(c,'",phone:"').concat(i,'"){ company }}'),e.prev=3,e.next=6,L(o,this.controller.abort());case 6:this.setState({client:{_id:"",company:"",person:"",email:"",phone:""}}),this.props.doRefresh(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),console.log(e.t0);case 13:case"end":return e.stop()}}),e,this,[[3,10]])})));return function(t){return e.apply(this,arguments)}}()},{key:"handleNameChange",value:function(e){this.state.client.company=e.target.value,this.setState({client:this.state.client})}},{key:"handlePersonChange",value:function(e){this.state.client.person=e.target.value,this.setState({client:this.state.client})}},{key:"handleEmailChange",value:function(e){this.state.client.email=e.target.value,this.setState({client:this.state.client})}},{key:"handlePhoneChange",value:function(e){this.state.client.phone=e.target.value,this.setState({client:this.state.client})}},{key:"render",value:function(){var e=this,t=this.props.t;return r.a.createElement(_.a,{xl:4},r.a.createElement(w.a,{className:"m-b-20"},r.a.createElement(w.a.Body,null,r.a.createElement("h4",null,this.state.client._id?r.a.createElement(r.a.Fragment,null,t("db.client.form.title"),r.a.createElement(ba,{to:"client",id:this.state.client._id,className:"pull-right"},r.a.createElement("i",{className:"mdi mdi-arrow-expand-all m-r-5 text-primary"}))):t("db.client.form.title.new")),r.a.createElement(I.a,{onSubmit:function(t){return e.handleSubmit(t)}},r.a.createElement(I.a.Group,null,r.a.createElement(I.a.Label,null,t("db.client.form.name")),r.a.createElement(I.a.Control,{type:"text",value:this.state.client.company,onChange:function(t){return e.handleNameChange(t)},required:!0})),r.a.createElement(I.a.Group,null,r.a.createElement(I.a.Label,null,t("db.client.form.person")),r.a.createElement(I.a.Control,{type:"text",value:this.state.client.person,onChange:function(t){return e.handlePersonChange(t)},required:!0})),r.a.createElement(N.a,null,r.a.createElement(_.a,{sm:6},r.a.createElement(I.a.Group,null,r.a.createElement(I.a.Label,null,t("db.client.form.email")),r.a.createElement(I.a.Control,{type:"email",value:this.state.client.email,onChange:function(t){return e.handleEmailChange(t)}}))),r.a.createElement(_.a,{sm:6},r.a.createElement(I.a.Group,null,r.a.createElement(I.a.Label,null,t("db.client.form.phone")),r.a.createElement(I.a.Control,{type:"text",value:this.state.client.phone,onChange:function(t){return e.handlePhoneChange(t)}})))),r.a.createElement(N.a,null,r.a.createElement(_.a,null,r.a.createElement(T.a,{block:!0,variant:"primary",type:"submit",className:"waves-effect waves-light"},this.state.client._id?t("db.client.form.button.update"):t("db.client.form.button.create"))),this.state.client._id&&[5,11].includes(this.context.role)&&r.a.createElement(_.a,null,r.a.createElement(T.a,{variant:"danger",onClick:this.handleDelete,block:!0,className:"waves-effect waves-light"},t("db.client.form.button.delete"))))))))}}]),a}(n.Component);te.contextType=A;var ae=Object(s.b)()(te),ne=Object(s.b)()((function(e){var t=e.t,a=e.rowCallback,n=e.setRefresh,c=["ID",t("db.clients.table.name"),t("db.clients.table.person"),t("db.clients.table.campaigns"),t("db.clients.table.totalBudget"),t("db.clients.table.createdAt")],l=[{data:"_id",visible:!1,searchable:!1},{data:"company",render:function(e){return e.length>22?e.slice(0,21)+"...":e}},{data:"person"},{data:"campaigns",defaultContent:"0",searchable:!1},{data:"totalBudget",defaultContent:"0",render:function(e){return"".concat(e," \u20ac")},searchable:!1},{data:"created_at",render:function(e){var t=new Date(e);return"".concat(t.getDate().toString().padStart(2,"0"),".").concat((t.getMonth()+1).toString().padStart(2,"0"),".").concat(t.getFullYear())},searchable:!1}];return r.a.createElement(w.a,{className:"m-b-20"},r.a.createElement(w.a.Body,null,r.a.createElement("h4",{className:"mt-0 header-title"},t("db.clients.table.title")),r.a.createElement(H,{ajax:"/api/datatable/clients",order:[[5,"desc"]],columns:l,thead:c,rowCallback:a,setRefresh:n})))})),re=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={selected:{},handleRefresh:function(){}},e.controller=new AbortController,e.setRefresh=function(t){return e.setState({handleRefresh:t})},e}return Object(b.a)(a,[{key:"componentDidMount",value:function(){console.log("Clients")}},{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"handleSelection",value:function(e){this.state.selected===e?this.setState({selected:{}}):this.setState({selected:e})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"container-fluid"},r.a.createElement(N.a,null,r.a.createElement(_.a,{xs:12,xl:8},r.a.createElement(ne,{setRefresh:this.setRefresh,rowCallback:function(t,a){return t.onclick=function(){return e.handleSelection(a)}}})),r.a.createElement(ae,{doRefresh:this.state.handleRefresh,selected:this.state.selected._id})))}}]),a}(n.Component),ce=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={thead:["ID",e.props.t("db.sales.table.userName"),e.props.t("db.sales.table.activeCampaigns"),e.props.t("db.sales.table.totalCampaigns"),e.props.t("db.sales.table.totalBudget")],columns:[{data:"_id",visible:!1,orderable:!1,searchable:!1},{data:"name"},{data:"running",searchable:!1,orderable:!1},{data:"campaigns",searchable:!1,orderable:!1},{data:"budget",searchable:!1,orderable:!1}],ajax:"/api/datatable/sales",redirect:""},e}return Object(b.a)(a,[{key:"componentDidMount",value:function(){console.log("Sales")}},{key:"render",value:function(){var e=this.props.t;return r.a.createElement("div",{className:"container-fluid"},r.a.createElement(N.a,null,r.a.createElement(_.a,{xs:12},r.a.createElement(w.a,{className:"m-b-20"},r.a.createElement(w.a.Body,null,r.a.createElement("h4",{className:"mt-0 header-title"},e("db.sales.table.title")),r.a.createElement(H,{ajax:this.state.ajax,columns:this.state.columns,thead:this.state.thead,rowCallback:this.state.rowCallback}))))))}}]),a}(n.Component),le=Object(s.b)()(ce),ie=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){return Object(f.a)(this,a),t.apply(this,arguments)}return Object(b.a)(a,[{key:"componentDidMount",value:function(){console.log("settings")}},{key:"render",value:function(){return r.a.createElement("div",{className:"container-fluid"},r.a.createElement("div",{className:"row"}),r.a.createElement("div",{className:"row"}),r.a.createElement("div",{className:"row"}))}}]),a}(n.Component),oe=a(23),se=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).controller=new AbortController,n.content=function(){var e=n.props.t;return n.state.loaded?n.state.loaded&&!n.state.vehicle._id?r.a.createElement("h4",{className:"text-center"},e("error")):r.a.createElement(r.a.Fragment,null,r.a.createElement("h4",{className:"mb-1"},Object(oe.vehTypeStr)(n.state.vehicle._id,e).toUpperCase()," ",Object(oe.vehID)(n.state.vehicle._id)),r.a.createElement("h5",{className:"mt-1"},n.state.vehicle.city.name),r.a.createElement("h5",{className:"mb-0 border-bottom"},e("db.campaign.vehicle.list.title")),r.a.createElement("p",null,JSON.stringify(n.state.placements)),n.state.installs&&n.state.installs.map((function(e){return r.a.createElement(N.a,{key:e.placement._id},r.a.createElement(_.a,{className:"shadow p-3 mb-2 bg-white rounded"},r.a.createElement("h6",null,e.campaign.name,": ",e.count,"x ",e.placement.place.name)))}))):r.a.createElement("div",{className:"text-center m-3"},r.a.createElement(x.a,{animation:"border",variant:"warning"}))},n.state={loaded:!1,vehicle:{},installs:[]},n}return Object(b.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){this.refreshData(this.props.data)}},{key:"refreshData",value:function(){var e=Object(h.a)(p.a.mark((function e(t){var a,n,r,c,l,i,o,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loaded:!1,vehicle:{}}),a='query{vehicle(_id:"'.concat(t,'"){_id type city{name}}\n        vehicleInstalls(_id:"').concat(t,'"){count placement{_id place{name}}campaign{ _id name startDate endDate client{_id company}}}}'),e.prev=2,e.next=5,L(a,this.controller.signal,this.props.token);case 5:n=e.sent,r=n.vehicle,c=n.vehicleInstalls,l={},i=Object(S.a)(c);try{for(i.s();!(o=i.n()).done;)(s=o.value).placement._id in l?l[s.placement._id].count+=s.count:l[s.placement._id]=s}catch(m){i.e(m)}finally{i.f()}r&&c?this.setState({vehicle:r,installs:Object.values(l),loaded:!0}):this.setState({loaded:!0}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),"AbortError"!==e.t0.name&&(console.log("Ohnoo, ",e.t0.toString()),this.setState({loaded:!0}));case 17:case"end":return e.stop()}}),e,this,[[2,14]])})));return function(t){return e.apply(this,arguments)}}()},{key:"componentWillReceiveProps",value:function(e){e.data!==this.state.vehicle._id&&this.refreshData(e.data)}},{key:"render",value:function(){return r.a.createElement(w.a,{className:"m-b-20"},r.a.createElement(w.a.Body,null,this.content()))}}]),a}(n.Component),me=Object(s.b)()(se),ue=a(47),de=a(184),pe=a(89),he=a(53),fe=a(41),be=function(e){var t=e.item,a=t.link,n=t.id,c=t.colorDescription,l=t.loaded,i=t.title,o=t.main,s=t.description,m=e.item.color||"orange";return r.a.createElement("div",{className:"mini-stat bg-white text-center"},i,!l&&r.a.createElement("div",{className:"text-center m-3"},r.a.createElement(x.a,{variant:"warning",animation:"border"})),l&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"mini-stat-info"},a&&r.a.createElement(ba,{to:a,id:n},r.a.createElement("span",{className:"counter text-"+m},o)),!a&&r.a.createElement("span",{className:"counter text-"+m},o)),r.a.createElement("p",{className:"mb-0 m-t-20 text-"+(c||"primary")},s)))},ge=a(70),ve=a.n(ge),Ee=(a(238),function(e){var t=new Date(e);return"".concat(t.getDate().toString().padStart(2,"0"),".").concat((t.getMonth()+1).toString().padStart(2,"0"),".").concat(t.getFullYear())}),ye=Object(s.b)()((function(e){var t=e.t,a=e.campaign,n=e.selected,c=e.click;return r.a.createElement(w.a,{style:{backgroundColor:"rgba(0,0,0,0)",border:"unset"}},r.a.createElement(ue.a.Toggle,{as:w.a.Header,eventKey:a._id,style:{border:"unset"},onClick:c,className:"p-1"},r.a.createElement("strong",null,r.a.createElement("a",{href:"/dashboard/campaign/".concat(a._id),className:"text-orange"}," ",a.name))," ",r.a.createElement("i",{className:"fa ".concat(n?"fa-angle-up":"fa-angle-down"),style:{cursor:"pointer"}})),r.a.createElement(ue.a.Collapse,{eventKey:a._id},r.a.createElement(w.a.Body,{className:"p-2"},r.a.createElement(_.a,null,r.a.createElement(N.a,null,t("map.marker.pre.client"),"\xa0",r.a.createElement("strong",null,r.a.createElement("a",{href:"/dashboard/client/".concat(a.client._id),className:"text-orange"},a.client.company))),r.a.createElement(N.a,null,t("map.marker.pre.startDate"),"\xa0",r.a.createElement("strong",null,Ee(parseInt(a.startDate)))),r.a.createElement(N.a,null,t("map.marker.pre.endDate"),"\xa0",r.a.createElement("strong",null,Ee(parseInt(a.endDate))))))))})),we=Object(s.b)()((function(e){var t=e.t;return r.a.createElement("div",null,t("map.marker.empty"))})),xe=Object(s.b)()((function(e){var t=e.t,a=e.data;return e.list?r.a.createElement("a",{href:"/dashboard/vehicle/".concat(a._id)},Object(oe.vehTypeStr)(a._id,t).toUpperCase()," ",Object(oe.vehID)(a._id)," ",a.line?"(".concat(a.line,")"):""," ",a.vehicleNumber?": ".concat(a.vehicleNumber):""):r.a.createElement("span",null,Object(oe.vehTypeStr)(a._id,t).toUpperCase()," ",Object(oe.vehID)(a._id)," ",a.line?"(".concat(a.line,")"):""," ",a.vehicleNumber?": ".concat(a.vehicleNumber):"")})),ke=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={selected:null,campaigns:[]},e.controller=new AbortController,e.handleClick=Object(h.a)(p.a.mark((function t(){var a,n,r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.state.selected){t.next=2;break}return t.abrupt("return");case 2:return a='query{campaignVehicles(_id:"'.concat(e.state.selected,'"){ _id }}'),t.prev=3,t.next=6,L(a,e.controller.signal);case 6:if(n=t.sent,r=n.campaignVehicles){t.next=10;break}return t.abrupt("return");case 10:e.props.doHighLight(r.map((function(e){return e._id}))),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(3),console.log(t.t0);case 16:case"end":return t.stop()}}),t,null,[[3,13]])}))),e.loadCampaigns=Object(h.a)(p.a.mark((function t(){var a,n,r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a='query{vehicleCampaigns(_id:"'.concat(e.props.data._id,'"){ _id name startDate endDate client {_id company}}}'),t.prev=1,t.next=4,L(a,e.controller.signal);case 4:n=t.sent,r=n.vehicleCampaigns,e.setState({campaigns:r}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),console.log(t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])}))),e.handleAccordionClick=function(t){e.state.selected===t?e.setState({selected:null}):e.setState({selected:t})},e}return Object(b.a)(a,[{key:"componentDidMount",value:function(){var e=Object(h.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadCampaigns();case 2:this.props.cb();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return this.state.selected?this.handleClick():this.props.doUnHighLight(),r.a.createElement("div",null,r.a.createElement("strong",null,r.a.createElement(xe,{data:this.props.data,list:this.props.list})),this.state.campaigns.length>0&&this.props.list&&r.a.createElement("div",{className:"scrollable",style:{maxHeight:140,width:"max-content"}},r.a.createElement(ue.a,null,this.state.campaigns.map((function(t){return r.a.createElement(ye,{key:t._id,campaign:t,selected:t._id===e.state.selected,click:function(){return e.handleAccordionClick(t._id)}})})))),0===this.state.campaigns.length&&this.props.list&&r.a.createElement(we,null))}}]),a}(n.Component);ke.contextType=A;var Ae=ke,Oe=a(180),Ce=a.n(Oe),je=a(181),Se=a.n(je),Ne=a(182),_e=a.n(Ne),De=a(183),Ie=a.n(De),Te=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).intervalID=0,n.controller=new AbortController,n.doHighLight=function(e){n.removeHighLight(),e.forEach((function(e){return e in n.vehicles?n.vehicles[e].setIcon(n.dotIconSpecial):""}))},n.removeHighLight=function(){Object.values(n.vehicles).forEach((function(e){return e.setIcon(e.origIcon)}))},n.refreshData=Object(h.a)(p.a.mark((function e(){var t,a,r,c,l;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,L(n.props.data.query,n.controller.signal,n.props.data.token);case 3:t=e.sent,a=n.props.data.getData(t),r=Object(S.a)(a);try{for(r.s();!(c=r.n()).done;)(l=c.value)._id in n.vehicles?n.moveVehicle(l):n.createVehicle(l)}catch(i){r.e(i)}finally{r.f()}e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])}))),n.createVehicle=function(e){var t=n.state.doSelection,a=e._id,c=e.latitude,i=e.longitude,o=e.haveAds,s=!1!==e.listed?o?n.dotIconActive:n.dotIcon:n.dotIconUnlisted,m=ve.a.marker([c,i],{riseOnHover:!0,icon:s,zIndexOffset:e.haveAds?800:void 0}).addTo(n.map);m.origIcon=s,m.click=function(){var t=n.vehicles[a];if(!t.getPopup()){var c=document.createElement("div");t.vehicle=l.a.render(r.a.createElement(Ae,{data:e,list:!(!1===n.props.data.details),doUnHighLight:n.removeHighLight,doHighLight:n.doHighLight,cb:function(){t.bindPopup(c),t.openPopup()}}),c)}},m.on("click",(function(e){var r=e.target;t?n.props.selected!==a&&t(a):r.click()})),m.on("popupopen",(function(){var e=n.vehicles[a];e.setIcon(n.dotIconSpecial),e.vehicle.handleClick()})),m.on("popupclose",(function(e){n.removeHighLight(),n.props.doSelection&&n.props.selected===a&&t("")})),n.vehicles[a]=m},n.moveVehicle=function(e){var t=n.state,a=t.smooth,r=t.refreshRate,c=e._id,l=e.latitude,i=e.longitude;n.vehicles[c].getLatLng().equals([l,i])||(a&&n.vehicles[c].getLatLng().distanceTo([l,i])<500?n.vehicles[c].slideTo([l,i],{duration:r,keepAtCenter:!1}):n.vehicles[c].setLatLng(new ve.a.latLng(l,i)))},n.hiLight=function(e){var t=n.vehicles[e];t.click(),t.getPopup()&&t.openPopup()},n.unHiLight=function(){for(var e=0,t=Object.values(n.vehicles);e<t.length;e++){var a=t[e];a.isPopupOpen()&&a.closePopup()}},n.state={size:e.data.height||580,smooth:!0,refreshRate:1e4,doSelection:e.doSelection},n}return Object(b.a)(a,[{key:"componentDidMount",value:function(){var e=this.props.data,t=e.latitude,a=e.longitude,n=this.state.refreshRate;this.map=ve.a.map("map",{center:[t||0,a||0],zoom:this.props.data.zoom||11,continuousWorld:!0});ve.a.tileLayer("https://4.base.maps.cit.api.here.com/maptile/2.1/maptile/newest/normal.day/{z}/{x}/{y}/256/png8?app_id=fL46BlQybP6rGwlfCw9f&app_code=nbbrVKYICWOqgenUhmpEBg",{detectRetina:!0,maxZoom:19,maxNativeZoom:17,minZoom:8}).addTo(this.map),this.dotIcon=ve.a.icon({iconUrl:Ce.a,iconSize:[13,13],iconAnchor:[7,7],popupAnchor:[0,0]}),this.dotIconActive=ve.a.icon({iconUrl:_e.a,iconSize:[13,13],iconAnchor:[7,7],popupAnchor:[0,0]}),this.dotIconSpecial=ve.a.icon({iconUrl:Se.a,iconSize:[13,13],iconAnchor:[7,7],popupAnchor:[0,0]}),this.dotIconUnlisted=ve.a.icon({iconUrl:Ie.a,iconSize:[13,13],iconAnchor:[7,7],popupAnchor:[0,0]}),this.vehicles={},this.refreshData(),this.intervalID=setInterval(this.refreshData,n)}},{key:"componentWillReceiveProps",value:function(e){var t=this,a=this.state.doSelection;e.selected?setTimeout((function(){return t.hiLight(e.selected)}),1):a&&this.unHiLight()}},{key:"componentWillUnmount",value:function(){this.controller.abort(),clearInterval(this.intervalID)}},{key:"render",value:function(){var e=this.state,t=e.size;e.doSelection,e.smooth,e.refreshRate;return r.a.createElement("div",{style:{minHeight:t,borderRadius:5},id:"map"})}}]),a}(n.Component);Te.contextType=A;var Be=Te,Re=Object(s.b)()((function(e){var t=e.data,a=e.t;return r.a.createElement(w.a,{style:{minHeight:156}},r.a.createElement(w.a.Body,null,!t.loaded&&r.a.createElement("div",{className:"text-center m-3"},r.a.createElement(x.a,{variant:"warning",animation:"border"})),t.loaded&&r.a.createElement(r.a.Fragment,null,r.a.createElement(N.a,{className:"text-center",style:{marginTop:0}},r.a.createElement(_.a,null,a("db.campaign.card.date.start"),r.a.createElement("div",{className:"mini-stat-info"},r.a.createElement("span",{className:"counter text-primary"},Ee(parseInt(t.startDate))))),r.a.createElement(_.a,null,a("db.campaign.card.date.end"),r.a.createElement("div",{className:"mini-stat-info"},r.a.createElement("span",{className:"counter text-orange"},Ee(parseInt(t.endDate)))))))),t.loaded&&r.a.createElement(fe.a,{className:"card-bottom-progress",variant:"warning",now:t.now,style:{borderRadius:0}}))})),Le=Object(s.b)()((function(e){var t=e.t,a=e.data;return r.a.createElement(be,{item:{title:t("db.campaign.card.cities.title"),main:a.cities,description:"".concat(t("db.campaign.card.cities.text")," ").concat(a.vehicles),loaded:a.loaded}})})),Fe=Object(s.b)()((function(e){var t=e.t,a=e.data;return r.a.createElement(be,{item:{title:t("db.campaign.card.saleBy.title"),main:r.a.createElement(ba,{to:"user",id:a.creator._id},r.a.createElement("span",{className:"counter text-success"},a.creator.name)),description:Ee(parseInt(a.date)),loaded:a.loaded}})})),Me=Object(s.b)()((function(e){var t=e.t,a=e.data;return r.a.createElement(be,{item:{title:t("db.campaign.card.budget.title"),main:a.budget,description:"".concat(t("db.campaign.card.budget.text")," ").concat(a.placements),loaded:a.loaded}})})),Ue=Object(s.b)()((function(e){var t=e.t,a=e.data;return r.a.createElement(w.a,{className:"m-b-10"},r.a.createElement(w.a.Body,null,r.a.createElement("h4",{className:"mt-0 header-title"},t("db.campaign.live.title")),!a.loaded&&r.a.createElement("div",{className:"text-center m-3"},r.a.createElement(x.a,{variant:"warning",animation:"border"})),a.loaded&&r.a.createElement(Be,{data:a.mapData,selected:a.selected,doSelection:a.handleSelection})))})),qe=function(e){var t=e.data.installs.filter((function(e){return e.installed})).map((function(e){return e.count})).reduce((function(e,t){return e+t}),0);return r.a.createElement("div",{className:"m-3"},r.a.createElement(N.a,{className:"text-center"},r.a.createElement(_.a,null,r.a.createElement("strong",null,e.data.place.name)),r.a.createElement(_.a,null,t,"/",e.data.count)),r.a.createElement(fe.a,{striped:!0,variant:e.data.count<=t?"success":"warning",now:100*t/e.data.count}))},Pe=Object(s.b)()((function(e){var t=e.t,a=e.data;return r.a.createElement(w.a,{className:"m-b-20"},r.a.createElement(w.a.Body,null,r.a.createElement("h4",{className:"mt-0 mb-2 header-title"},t("db.campaign.progress.title")),!a.loaded&&r.a.createElement("div",{className:"text-center m-3"},r.a.createElement(x.a,{variant:"warning",animation:"border"})),a.loaded&&r.a.createElement(r.a.Fragment,null,a.placements.map((function(e){return r.a.createElement(qe,{key:e._id,data:e})})))))})),Ve=function(e){var t,a={},n=Object(S.a)(e);try{for(n.s();!(t=n.n()).done;){var r,c=t.value,l=Object(S.a)(c.installs);try{for(l.s();!(r=l.n()).done;){var i=r.value;i.vehicle._id in a||(a[i.vehicle._id]=Object(C.a)(Object(C.a)({},i.vehicle),{},{ads:0,removed:0})),i.installed?a[i.vehicle._id].ads+=i.count:a[i.vehicle._id].removed+=i.count}}catch(o){l.e(o)}finally{l.f()}}}catch(o){n.e(o)}finally{n.f()}return Object.values(a).map((function(e){if(!e)return null;var t=e._id,a=e.operator,n=e.city,r=e.ads,c=e.removed;return{_id:t,city:n.name,operator:a.company||a.operatorId,ads:r,removed:c}}))},We=Object(s.b)()((function(e){var t=e.t,a=e.data,n=[t("db.campaign.atable.id"),t("db.campaign.atable.city"),t("db.campaign.atable.operator"),t("db.campaign.atable.ads"),t("db.campaign.atable.removed")],c=[{data:"_id",render:function(e){return Object(oe.vehID)(e)}},{data:"city"},{data:"operator"},{data:"ads"},{data:"removed"}];return r.a.createElement(w.a,{className:"m-b-20"},r.a.createElement(w.a.Body,null,r.a.createElement("h4",{className:"mt-0 header-title"},t("db.campaign.atable.title")),r.a.createElement(H,{data:Ve(a.placements),columns:c,thead:n,rowCallback:a.rowCallback})))})),He=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={campaign:{},loaded:!1,selected:"",progress:{},index:0,lightbox:!1},e.controller=new AbortController,e.handleSelection=function(t){e.state.selected!==t?e.setState({selected:t}):e.setState({selected:""})},e.openLightBox=function(){var t=e.props.t;e.state.campaign&&e.state.campaign.pictures&&e.state.campaign.pictures.length>0?e.setState({lightbox:!0}):ee.a.fire({icon:"info",title:t("db.campaign.images.info.empty.title"),text:t("db.campaign.images.info.empty.text"),showConfirmButton:!1,timer:3e3})},e}return Object(b.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){var e=Object(h.a)(p.a.mark((function e(){var t,a,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t='query{campaign(_id:"'.concat(this.props.match.params.id,'"){\n            _id name client{_id company}creator{_id name}budget startDate endDate created_at cities{name latitude longitude}\n            pictures { path thumbnail created_at }\n            placements{_id place{name} installs{installed vehicle{_id city{name}operator{company operatorId}}created_at count}\n      count isPublic}}}'),e.prev=1,e.next=4,L(t,this.controller.signal);case 4:a=e.sent,(n=a.campaign)?this.setState({campaign:n,loaded:!0}):this.setState({loaded:!0}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.log("Ohnoo, ",e.t0.toString()),this.setState({loaded:!0});case 13:case"end":return e.stop()}}),e,this,[[1,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"getMapData",value:function(){return{height:530,query:'query{campaignVehicles(_id: "'.concat(this.state.campaign._id,'"){_id haveAds longitude latitude}}'),latitude:this.state.campaign.cities[0].latitude,longitude:this.state.campaign.cities[0].longitude,zoom:7,getData:function(e){return e.campaignVehicles},smooth:!0}}},{key:"totalFleets",value:function(){var e,t=[],a=Object(S.a)(this.state.campaign.placements);try{for(a.s();!(e=a.n()).done;){var n,r=e.value,c=Object(S.a)(r.installs);try{for(c.s();!(n=c.n()).done;){var l=n.value;t.push(l.vehicle._id)}}catch(i){c.e(i)}finally{c.f()}}}catch(i){a.e(i)}finally{a.f()}return new Set(t).size}},{key:"timeLeftPercent",value:function(){return((new Date).getTime()-this.state.campaign.startDate)/(this.state.campaign.endDate-this.state.campaign.startDate)*100}},{key:"render",value:function(){var e=this;console.log("campaignDetails.state",this.state);var t=this.props.t;if(this.state.loaded&&0===Object.keys(this.state.campaign).length)return r.a.createElement("div",{className:"container-fluid text-center"},r.a.createElement("h3",{className:"text-white"},t("db.campaign.404")));var a=this.state.campaign.pictures,n=this.state,c=n.index,l=n.loaded;return r.a.createElement("div",{className:"container-fluid"},this.state.lightbox&&r.a.createElement(pe.a,{mainSrc:a[c].path,nextSrc:a[(c+1)%a.length].path,prevSrc:a[(c+a.length-1)%a.length].path,onCloseRequest:function(){return e.setState({lightbox:!1})},onMovePrevRequest:function(){return e.setState({index:(c+a.length-1)%a.length})},onMoveNextRequest:function(){return e.setState({index:(c+1)%a.length})}}),r.a.createElement(N.a,{className:"border-bottom mb-4"},r.a.createElement(_.a,{xs:12},r.a.createElement("h3",{className:"text-white"},!l&&"Loading...",l&&this.state.campaign.client.company+": "+this.state.campaign.name))),r.a.createElement(N.a,null,r.a.createElement(_.a,{md:this.props.client?12:6,xl:this.props.client?4:3,className:"mb-4"},r.a.createElement(Re,{data:{loaded:l,startDate:l&&this.state.campaign.startDate,endDate:l&&this.state.campaign.endDate,now:l&&this.timeLeftPercent()}})),r.a.createElement(_.a,{md:6,xl:this.props.client?4:3},r.a.createElement(Le,{data:{loaded:l,cities:l&&this.state.campaign.cities.map((function(e){return e.name})).join(", "),vehicles:l&&this.totalFleets()}})),!this.props.client&&r.a.createElement(_.a,{md:6,xl:this.props.client?4:3},r.a.createElement(Me,{data:{loaded:l,budget:this.state.campaign.budget,placements:l&&this.state.campaign.placements.map((function(e){return e.count})).reduce((function(e,t){return e+t}),0)}})),r.a.createElement(_.a,{md:6,xl:this.props.client?4:3},r.a.createElement(Fe,{data:{loaded:l,creator:l&&this.state.campaign.creator,date:l&&this.state.campaign.created_at}}))),r.a.createElement(N.a,null,r.a.createElement(_.a,{xl:8},r.a.createElement(Ue,{data:{loaded:l,mapData:l&&this.getMapData(),selected:this.state.selected,handleSelection:this.handleSelection}})),r.a.createElement(_.a,{xl:4},r.a.createElement(Pe,{data:{loaded:l,placements:l&&this.state.campaign.placements}}),l&&r.a.createElement(ue.a,null,r.a.createElement(w.a,null,r.a.createElement(ue.a.Toggle,{as:w.a.Header,eventKey:"0"},r.a.createElement("i",{className:"ion ion-images"})," Campaign Images"," ",r.a.createElement(he.a,{className:"hvr-grow",variant:a.length?"success":"danger"},a.length)),r.a.createElement(ue.a.Collapse,{eventKey:"0"},r.a.createElement(w.a.Body,{style:{display:"flex",flexDirection:"row",alignItems:"center"}},a.map((function(t,a){return r.a.createElement("div",{style:{padding:"5px"}},r.a.createElement(de.a,{onClick:e.openLightBox,src:t.thumbnail,key:a,thumbnail:!0}))})))))))),r.a.createElement(N.a,null,l&&r.a.createElement(_.a,{xl:8},r.a.createElement(We,{data:{placements:this.state.campaign.placements,rowCallback:function(t,a){return t.onclick=function(){return e.handleSelection(a._id)}}}})),this.state.selected&&r.a.createElement(_.a,{xl:4},r.a.createElement(me,{data:this.state.selected}))))}}]),a}(n.Component);He.contextType=A;var Ge=Object(s.b)()(He),ze=a(130),Qe=a.n(ze),Ye=(a(239),a(59)),Ze=a(191),Je=a(83),Ke=a(84);function Xe(){var e=Object(Je.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n"]);return Xe=function(){return e},e}function $e(){var e=Object(Je.a)(["\n  padding: 5px;\n"]);return $e=function(){return e},e}var et=Ke.a.div($e()),tt=Ke.a.div(Xe());Object(ze.registerLocale)("et",Ze.a);var at=function(e){return r.a.createElement(_.a,{sm:6,md:6,lg:4,xl:6},r.a.createElement("label",{className:"mb-0"},e.label),r.a.createElement(B.a,{className:"mb-3 place-field"},r.a.createElement(B.a.Prepend,null,r.a.createElement(T.a,{variant:"primary",onClick:function(t){return e.doButtonPress(t,-10)}},"-")),r.a.createElement(R.a,{type:"text",value:e.value,onChange:e.doChange}),r.a.createElement(B.a.Append,null,r.a.createElement(T.a,{variant:"primary",onClick:function(t){return e.doButtonPress(t,10)}},"+"))))},nt=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={campaign:{_id:"",name:"",client:"",budget:"",priority:!1,cities_selected:[],places:{},start_date:new Date,end_date:new Date,contactEmail:""},places:[],clients:[],cities:[]},e.empty=Object(C.a)({},e.state.campaign),e.controller=new AbortController,e.loadCampaignData=function(){var t=Object(h.a)(p.a.mark((function t(a){var n,r,c,l;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(a),n='query{campaign(_id:"'.concat(a,'"){name client{_id email}creator{_id}budget cities{_id}placements{place{_id}count}endDate startDate priority}}'),t.prev=2,t.next=5,L(n,e.controller.signal);case 5:if(r=t.sent,(c=r.campaign).cities){t.next=10;break}return console.log("No cities defined"),t.abrupt("return");case 10:if(c.client){t.next=13;break}return console.log("No client defined"),t.abrupt("return");case 13:l=c.client.email,c.cities_selected=c.cities.map((function(t){return e.state.cities.find((function(e){return e.value===t._id}))})),c.client=e.state.clients.find((function(e){return e.value===c.client._id})),delete c.cities,c.places={},c.placements.forEach((function(e){c.places[e.place._id]=e.count})),delete c.placements,c.end_date=new Date(parseInt(c.endDate)),c.start_date=new Date(parseInt(c.startDate)),delete c.endDate,delete c.startDate,delete c.placements,e.setState({campaign:Object(C.a)(Object(C.a)({},c),{},{_id:a,contactEmail:l})}),t.next=31;break;case 28:t.prev=28,t.t0=t.catch(2),console.log("Error finding user",t.t0.toString());case 31:case"end":return t.stop()}}),t,null,[[2,28]])})));return function(e){return t.apply(this,arguments)}}(),e.initialLoad=Object(h.a)(p.a.mark((function t(){var a,n,r,c;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"query{cities{ _id name } places{ _id name } clients{ _id company }}",t.prev=1,t.next=4,L("query{cities{ _id name } places{ _id name } clients{ _id company }}",e.controller.signal);case 4:a=t.sent,n=a.cities,r=a.clients,c=a.places,e.setState({places:c,clients:r.map((function(e){return{value:e._id,label:e.company}})),cities:n.map((function(e){return{value:e._id,label:e.name}}))}),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),console.log("Error while loading",t.t0.toString());case 14:case"end":return t.stop()}}),t,null,[[1,11]])}))),e.handleDelete=Object(h.a)(p.a.mark((function t(){var a,n;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=e.props.t,n='mutation{campaignHardDelete(_id:"'.concat(e.state.campaign._id,'")}'),ee.a.fire({title:a("db.campaign.form.delete.warning.title"),text:a("db.campaign.form.delete.warning.text"),icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes"}).then(function(){var t=Object(h.a)(p.a.mark((function t(r){var c;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.value){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,L(n,e.controller.signal);case 5:c=t.sent,c.campaignHardDelete?(ee.a.fire({icon:"success",title:a("db.campaign.form.delete.success.title"),showConfirmButton:!1,timer:1500}),e.setState({campaign:{_id:"",name:"",client:"",budget:"",cities_selected:[],places:{},start_date:new Date,end_date:new Date,contactEmail:""}}),e.props.doRefresh()):ee.a.fire({icon:"error",title:a("db.campaign.form.delete.failed.title"),text:a("db.campaign.form.delete.failed.text"),showConfirmButton:!1,timer:1500}),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(2),console.log("Error while loading",t.t0.toString());case 13:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e){return t.apply(this,arguments)}}());case 3:case"end":return t.stop()}}),t)}))),e.handleShare=function(){var t=Object(h.a)(p.a.mark((function t(a){var n,r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a.preventDefault(),n=e.props.t,r=e.state.campaign.contactEmail||"",ee.a.fire({title:n("db.campaign.form.share.title"),input:"text",inputValue:r,inputAttributes:{autocapitalize:"off"},showCancelButton:!0,confirmButtonText:"Share",showLoaderOnConfirm:!0,preConfirm:function(t){return Object(h.a)(p.a.mark((function a(){var n,r,c;return p.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n='mutation{campaignShare(_id:"'.concat(e.state.campaign._id,'", email:"').concat(t,'")}'),a.prev=1,a.next=4,L(n,e.controller.signal);case 4:if(r=a.sent,!(c=r.campaignShare)){a.next=8;break}return a.abrupt("return",c);case 8:ee.a.showValidationMessage("Invalid input"),a.next=15;break;case 11:a.prev=11,a.t0=a.catch(1),console.log("Error",a.t0),ee.a.showValidationMessage("Invalid request");case 15:case"end":return a.stop()}}),a,null,[[1,11]])})))()},allowOutsideClick:function(){return!ee.a.isLoading()}}).then((function(e){e.value&&ee.a.fire({icon:"success",title:n("db.campaign.form.share.title"),showConfirmButton:!1,timer:1500})}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleSubmit=function(){var t=Object(h.a)(p.a.mark((function t(a){var n,r,c,l,i,o,s,m,u,d,h,f,b,g,v,E,y,w,x;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),n=e.state.campaign,r=n._id,c=n.name,l=n.client,i=n.budget,o=n.start_date,s=n.end_date,m=n.cities_selected,u=n.places,d=n.priority,h=e.props.t,m&&!(m.length<=0)){t.next=6;break}return ee.a.fire({icon:"error",title:h("db.campaign.form.submit.invalid.city.title"),text:h("db.campaign.form.submit.invalid.city.text"),showConfirmButton:!1,timer:1500}),t.abrupt("return");case 6:if(f=!1,b=[],Object.keys(u).forEach((function(t){var a=e.state.campaign.places[t];a&&0!==parseInt(a)&&(f=!0,b.push('{ place: "'.concat(t,'", count: ').concat(parseInt(a),"}")))})),f){t.next=12;break}return ee.a.fire({icon:"error",title:h("db.campaign.form.submit.invalid.places.title"),text:h("db.campaign.form.submit.invalid.places.text"),showConfirmButton:!1,timer:1500}),t.abrupt("return");case 12:if(b="[".concat(b.join(","),"]"),g=r?'mutation{campaignUpdate(_id:"'.concat(r,'",name:"').concat(c,'",client:"').concat(l.value,'",budget:').concat(i,",priority: ").concat(d?"true":"false",",cities:").concat(JSON.stringify(m.map((function(e){return e.value}))),',startDate:"').concat(o.getTime(),'",endDate:"').concat(s.getTime(),'",places:').concat(b,") { _id }}"):'mutation{campaignCreate(name:"'.concat(c,'",client:"').concat(l.value,'",budget:').concat(i,",priority:").concat(d?"true":"false",",cities:").concat(JSON.stringify(m.map((function(e){return e.value}))),',startDate:"').concat(o.getTime(),'",endDate:"').concat(s.getTime(),'",places:').concat(b,") { _id }}"),t.prev=14,!r){t.next=23;break}return t.next=18,L(g,e.controller.signal);case 18:E=t.sent,y=E.campaignUpdate,v=y,t.next=28;break;case 23:return t.next=25,L(g,e.controller.signal);case 25:w=t.sent,x=w.campaignCreate,v=x;case 28:if(v){t.next=31;break}return ee.a.fire({icon:"error",title:e.state.campaign._id?h("db.campaign.form.submit.invalid.update"):h("db.campaign.form.submit.invalid.create"),showConfirmButton:!1,timer:1500}),t.abrupt("return");case 31:ee.a.fire({icon:"success",title:e.state.campaign._id?h("db.campaign.form.submit.success.update"):h("db.campaign.form.submit.success.create"),showConfirmButton:!1,timer:1500}),e.setState({campaign:{_id:"",name:"",client:"",budget:"",cities_selected:[],places:{},start_date:new Date,end_date:new Date,contactEmail:""}}),e.props.doRefresh(),t.next=39;break;case 36:t.prev=36,t.t0=t.catch(14),console.log("Fetch failed: ",t.t0.toString());case 39:case"end":return t.stop()}}),t,null,[[14,36]])})));return function(e){return t.apply(this,arguments)}}(),e.handleCityChange=function(t){e.state.campaign.cities_selected=t,e.setState({campaign:e.state.campaign})},e.handleClientChange=function(t){e.state.campaign.client=t,e.setState({campaign:e.state.campaign})},e.handleStart=function(t){e.state.campaign.start_date=t,e.setState({campaign:e.state.campaign})},e.handleEnd=function(t){e.state.campaign.end_date=t,e.setState({campaign:e.state.campaign})},e.handleBudgetChange=function(t){e.state.campaign.budget=t.target.value,e.setState({campaign:e.state.campaign})},e.handleNameChange=function(t){e.state.campaign.name=t.target.value,e.setState({campaign:e.state.campaign})},e.handlePriorityChange=function(t){e.state.campaign.priority=t.target.checked,e.setState({campaign:e.state.campaign})},e.handlePlaceButtonPress=function(t,a,n){t.preventDefault();var r=(e.state.campaign.places[a]?parseInt(e.state.campaign.places[a]):0)+n;e.state.campaign.places[a]=r>0?r:0,e.setState({campaign:e.state.campaign})},e.handlePlaceCountChange=function(t,a){(""===t.target.value||/^\d+$/.test(t.target.value))&&(e.state.campaign.places[a]=t.target.value,e.setState({campaign:e.state.campaign}))},e.handlePlaceGetCount=function(t){return t in e.state.campaign.places?e.state.campaign.places[t]:""},e}return Object(b.a)(a,[{key:"componentDidMount",value:function(){this.initialLoad()}},{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentWillReceiveProps",value:function(e){this.setState({campaign:Object(C.a)(Object(C.a)({},this.empty),{},{places:{}})}),e.selected&&this.loadCampaignData(e.selected)}},{key:"render",value:function(){var e=this,t=this.props.t;return r.a.createElement(_.a,{xl:4},r.a.createElement(w.a,{className:"m-b-20"},r.a.createElement(w.a.Body,null,r.a.createElement("h4",null,this.state.campaign._id?r.a.createElement(tt,null,t("db.campaign.form.title"),r.a.createElement(et,null,r.a.createElement(ba,{to:"campaign",id:this.state.campaign._id,className:"btn btn-block btn-primary waves-effect waves-light"},t("db.campaign.form.button.fullView")))):t("db.campaign.form.title.new")),r.a.createElement(I.a,{onSubmit:this.handleSubmit},r.a.createElement(I.a.Group,{className:"form-group"},r.a.createElement(I.a.Label,{className:"mb-0"},t("db.campaign.form.name")),r.a.createElement(I.a.Control,{type:"text",value:this.state.campaign.name,onChange:this.handleNameChange,required:!0})),r.a.createElement(I.a.Group,null,r.a.createElement(I.a.Label,{className:"mb-0"},t("db.campaign.form.client")),r.a.createElement(Ye.a,{value:this.state.campaign.client,onChange:this.handleClientChange,options:this.state.clients,required:!0})),r.a.createElement(N.a,null,r.a.createElement(_.a,null,r.a.createElement("div",null,r.a.createElement("label",{className:"mb-0"},t("db.campaign.form.startDate"))),r.a.createElement(Qe.a,{className:"form-control",selected:this.state.campaign.start_date,onSelect:this.handleStart,dateFormat:"dd/MM/yyyy",required:!0})),r.a.createElement(_.a,{className:"text-right"},r.a.createElement("div",null,r.a.createElement("label",{className:"mb-0"},t("db.campaign.form.endDate"))),r.a.createElement(Qe.a,{className:"form-control",dateFormat:"dd/MM/yyyy",selected:this.state.campaign.end_date,onSelect:this.handleEnd,required:!0}))),r.a.createElement(I.a.Group,null,r.a.createElement(I.a.Label,{className:"mb-0"},t("db.campaign.form.cities")),r.a.createElement(Ye.a,{value:this.state.campaign.cities_selected,onChange:this.handleCityChange,options:this.state.cities,isMulti:!0,required:!0})),r.a.createElement(N.a,null,this.state.places&&this.state.places.map((function(t){return r.a.createElement(at,{key:t._id,value:e.handlePlaceGetCount(t._id),label:t.name,doButtonPress:function(a,n){return e.handlePlaceButtonPress(a,t._id,n)},doChange:function(a){return e.handlePlaceCountChange(a,t._id)}})}))),r.a.createElement(N.a,null,r.a.createElement(_.a,{sm:6},r.a.createElement("label",{className:"mb-0"},t("db.campaign.form.budget")),r.a.createElement(I.a.Group,{className:"input-group mb-3"},r.a.createElement(R.a,{type:"text",value:this.state.campaign.budget,onChange:function(t){return e.handleBudgetChange(t)},required:!0}),r.a.createElement(B.a.Append,null,r.a.createElement("span",{className:"input-group-text"},"\u20ac")))),r.a.createElement(_.a,null,r.a.createElement("label",{className:"mb-0"},t("db.campaign.form.priority")),r.a.createElement(I.a.Group,{className:"input-group mb-3"},r.a.createElement("input",{type:"checkbox",id:"priority",switch:"danger",checked:this.state.campaign.priority,onChange:this.handlePriorityChange}),r.a.createElement("label",{htmlFor:"priority","data-on-label":t("db.campaign.form.priority.on"),"data-off-label":t("db.campaign.form.priority.off"),className:"mt-1"})))),this.state.campaign._id?r.a.createElement(N.a,null,r.a.createElement(_.a,{sm:12,className:"text-right"},r.a.createElement("button",{className:"btn btn-block btn-warning waves-effect waves-light",onClick:this.handleShare},t("db.campaign.form.button.share")))):null,r.a.createElement(N.a,{className:"mt-2"},r.a.createElement(_.a,null,r.a.createElement("button",{type:"submit",className:"btn btn-success btn-block waves-effect waves-light"},this.state.campaign._id?t("db.campaign.form.button.update"):t("db.campaign.form.button.create"))),this.state.campaign._id&&[5,11].includes(this.context.role)&&r.a.createElement(_.a,null,r.a.createElement(T.a,{variant:"danger",onClick:this.handleDelete,block:!0,className:"waves-effect waves-light"},t("db.campaign.form.button.delete"))))))))}}]),a}(n.Component);nt.contextType=A;var rt=Object(s.b)()(nt),ct=Object(s.b)()((function(e){var t=e.t,a=e.rowCallback,n=e.setRefresh,c=["ID",t("db.campaigns.table.name"),t("db.campaigns.table.company"),t("db.campaigns.table.budget"),t("db.campaigns.table.startDate"),t("db.campaigns.table.endDate"),t("db.campaigns.table.createdAt")],l=[{data:"_id",visible:!1,searchable:!1},{data:"name"},{data:"company"},{data:"budget"},{data:"startDate",render:Ee,searchable:!1},{data:"endDate",render:Ee,searchable:!1},{data:"created_at",render:Ee,searchable:!1}];return r.a.createElement(w.a,{className:"m-b-20"},r.a.createElement(w.a.Body,null,r.a.createElement("h4",{className:"mt-0 header-title"},t("db.campaigns.table.title")),r.a.createElement(H,{ajax:"/api/datatable/campaigns",order:[[6,"desc"]],columns:l,thead:c,rowCallback:a,setRefresh:n})))})),lt=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={selected:{},handleRefresh:function(){}},e.setRefresh=function(t){return e.setState({handleRefresh:t})},e}return Object(b.a)(a,[{key:"componentDidMount",value:function(){console.log("Campaigns")}},{key:"handleSelection",value:function(e){this.state.selected===e?this.setState({selected:{}}):this.setState({selected:e})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"container-fluid"},r.a.createElement(N.a,null,r.a.createElement(_.a,{xl:8},r.a.createElement(ct,{setRefresh:this.setRefresh,rowCallback:function(t,a){return t.onclick=function(){return e.handleSelection(a)}}})),r.a.createElement(rt,{doRefresh:this.state.handleRefresh,selected:this.state.selected._id})))}}]),a}(n.Component),it=[0,1,3,5],ot={0:"primary",1:"success",3:"warning",5:"danger",11:"danger"},st=function(e,t){return it.includes(e)?t("user.role."+e):t("user.role.-")},mt=function(e){return e in ot?ot[e]:"secondary"},ut=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).handleClick=function(){var e=Object(h.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.target.checked,e.next=3,n.props.doChange(a);case 3:if(!e.sent){e.next=5;break}n.setState({checked:a});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.state={checked:e.checked},n}return Object(b.a)(a,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{type:"checkbox",id:this.props.id,switch:"none",checked:this.state.checked?"checked":"",onChange:this.handleClick}),r.a.createElement("label",{htmlFor:this.props.id,"data-on-label":"Yes","data-off-label":"No",style:{margin:"auto"}}))}}]),a}(n.Component),dt=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,c=new Array(n),i=0;i<n;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).state={thead:["ID","Role","User","Email","Camp. Created","Camp. Changed","Camp. Pre-Start","Camp. Start","Camp. Pre-End","Camp. End","Install Done","Remove Done"],columns:[{data:"_id",visible:!1,orderable:!1,searchable:!1},{data:"role",render:function(t){return'<div style="width: 100%; text-align: center"><span class="badge badge-'.concat(mt(t),'">').concat(st(t,e.props.t),"</span></div>")}},{data:"name"},{data:"email"},{data:"mailCampCreated",defaultContent:"",searchable:!1,createdCell:function(t,a,n){return e.createCell(t,a,n,"mailCampCreated")}},{data:"mailCampChanged",defaultContent:"",searchable:!1,createdCell:function(t,a,n){return e.createCell(t,a,n,"mailCampChanged")}},{data:"mailPreStart",defaultContent:"",searchable:!1,createdCell:function(t,a,n){return e.createCell(t,a,n,"mailPreStart")}},{data:"mailStart",defaultContent:"",searchable:!1,createdCell:function(t,a,n){return e.createCell(t,a,n,"mailStart")}},{data:"mailPreEnd",defaultContent:"",searchable:!1,createdCell:function(t,a,n){return e.createCell(t,a,n,"mailPreEnd")}},{data:"mailEnd",defaultContent:"",searchable:!1,createdCell:function(t,a,n){return e.createCell(t,a,n,"mailEnd")}},{data:"mailInstallDone",defaultContent:"",searchable:!1,createdCell:function(t,a,n){return e.createCell(t,a,n,"mailInstallDone")}},{data:"mailRemoveDone",defaultContent:"",searchable:!1,createdCell:function(t,a,n){return e.createCell(t,a,n,"mailRemoveDone")}}],ajax:"/api/datatable/mails"},e.createCell=function(t,a,n,c){var i=!!a;l.a.render(r.a.createElement(ut,{id:"".concat(c).concat(n._id),checked:i,doChange:function(t){return e.handleCheckboxClick(c,n._id,t)}}),t)},e.handleCheckboxClick=function(){var t=Object(h.a)(p.a.mark((function t(a,n,r){var c,l,i;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c='mutation{ userMailing(_id: "'.concat(n,'", mail:"').concat(a,'", value:').concat(r,") }"),t.prev=1,t.next=4,L(c,e.controller.signal);case 4:return l=t.sent,i=l.userMailing,t.abrupt("return",i);case 9:return t.prev=9,t.t0=t.catch(1),"SyntaxError"===t.t0.name?ee.a.fire({position:"top-end",icon:"error",title:"Check internet connection",showConfirmButton:!1,timer:1800}):"AbortError"===t.t0.name||ee.a.fire({position:"top-end",icon:"error",title:"Bad request",showConfirmButton:!1,timer:1800}),t.abrupt("return",!1);case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e,a,n){return t.apply(this,arguments)}}(),e.controller=new AbortController,e}return Object(b.a)(a,[{key:"componentDidMount",value:function(){console.log("Mailing")}},{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"render",value:function(){return r.a.createElement("div",{className:"container-fluid"},r.a.createElement(N.a,null,r.a.createElement(_.a,{xs:12},r.a.createElement(w.a,{className:"m-b-20"},r.a.createElement(w.a.Body,null,r.a.createElement(H,{ajax:this.state.ajax,columns:this.state.columns,thead:this.state.thead}))))))}}]),a}(n.Component),pt=Object(s.b)()(dt),ht=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={user:{_id:"",name:"",role:null,city:null,email:"",phone:""},selection:{cities:[],roles:it.map((function(t){return{value:t,label:st(t,e.props.t)}}))}},e.empty=Object(C.a)({},e.state.user),e.edit=!1,e.controller=new AbortController,e.loadAllCities=Object(h.a)(p.a.mark((function t(){var a;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"query{cities{_id name}}",t.prev=1,t.next=4,L("query{cities{_id name}}",e.controller.signal);case 4:a=t.sent,e.state.selection.cities=a.cities.map((function(e){return{value:e._id,label:e.name}})),e.setState({selection:e.state.selection}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),console.log("City load failed: ",t.t0.toString());case 12:case"end":return t.stop()}}),t,null,[[1,9]])}))),e.componentWillReceiveProps=function(t){t.selected?e.loadUserData(t.selected):e.setState({user:e.empty})},e.loadUserData=function(){var t=Object(h.a)(p.a.mark((function t(a){var n,r,c;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n='query{user(_id:"'.concat(a,'"){name email phone city{_id name}role}}'),t.prev=1,t.next=4,L(n,e.controller.signal);case 4:r=t.sent,c=r.user,console.log(c),c.city&&(c.city={value:c.city._id,label:c.city.name}),c.role={value:c.role,label:st(c.role,e.props.t)},c.phone||(c.phone=""),e.setState({user:Object(C.a)(Object(C.a)({},c),{},{_id:a})}),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(1),console.log("Error finding user",t.t0.toString());case 16:case"end":return t.stop()}}),t,null,[[1,13]])})));return function(e){return t.apply(this,arguments)}}(),e.handleSubmit=function(){var t=Object(h.a)(p.a.mark((function t(a){var n,r,c,l,i,o,s,m,u;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),n=e.state.user,r=n._id,c=n.name,l=n.email,i=n.phone,o=n.city,s=n.role,o){t.next=5;break}return console.log("City is not selected"),t.abrupt("return");case 5:if(c&&l){t.next=7;break}return t.abrupt("return");case 7:return m="",s&&(m=s.value),u=r?'mutation{userUpdate(_id:"'.concat(r,'",name:"').concat(c,'",email:"').concat(l,'",phone:"').concat(i,'",role:').concat(m,', city:"').concat(o.value,'"){_id}}'):'mutation{userCreate(name:"'.concat(c,'",email:"').concat(l,'",phone:"').concat(i,'",role:').concat(m,', city:"').concat(o.value,'"){_id}}'),t.prev=10,t.next=13,L(u);case 13:t.sent&&(e.setState({user:{_id:"",name:"",role:null,city:null,email:"",phone:""}}),e.props.doRefresh()),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(10),console.log("Fetch failed: ",t.t0.toString());case 20:case"end":return t.stop()}}),t,null,[[10,17]])})));return function(e){return t.apply(this,arguments)}}(),e.handleDelete=function(){var t=Object(h.a)(p.a.mark((function t(a){var n,r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.props.t,r='mutation{userHardDelete(_id:"'.concat(e.state.user._id,'")}'),ee.a.fire({title:n("db.user.form.delete.warning.title"),text:n("db.user.form.delete.warning.text"),icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes",cancelButtonText:"Cancel"}).then(function(){var t=Object(h.a)(p.a.mark((function t(a){var c;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.value){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,L(r,e.controller.signal);case 5:c=t.sent,c.userHardDelete?(ee.a.fire({icon:"success",title:n("db.user.form.delete.success.title"),showConfirmButton:!1,timer:1500}),e.props.doRefresh()):ee.a.fire({icon:"error",title:n("db.user.form.delete.failed.title"),text:n("db.user.form.delete.failed.text"),showConfirmButton:!1,timer:1500}),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(2),console.log("Error while loading",t.t0.toString());case 13:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e){return t.apply(this,arguments)}}());case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleNameChange=function(t){e.state.user.name=t.target.value,e.setState({user:e.state.user})},e.handleEmailChange=function(t){e.state.user.email=t.target.value,e.setState({user:e.state.user})},e.handlePhoneChange=function(t){e.state.user.phone=t.target.value,e.setState({user:e.state.user})},e.handleCityChange=function(t){e.state.user.city=t,e.setState({user:e.state.user})},e.handleRoleChange=function(t){e.state.user.role=t,e.setState({user:e.state.user})},e}return Object(b.a)(a,[{key:"componentDidMount",value:function(){this.loadAllCities()}},{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"render",value:function(){var e=this.props.t;return r.a.createElement(_.a,{xl:4},r.a.createElement(w.a,{className:"m-b-20"},r.a.createElement(w.a.Body,null,r.a.createElement("h4",null,this.state.user._id?r.a.createElement(r.a.Fragment,null,e("db.user.form.title")):e("db.user.form.title.new")),r.a.createElement(I.a,{onSubmit:this.handleSubmit},r.a.createElement(I.a.Group,{className:"form-group"},r.a.createElement(I.a.Label,null,e("db.user.form.name")),r.a.createElement(I.a.Control,{type:"text",value:this.state.user.name,onChange:this.handleNameChange,required:!0})),r.a.createElement(N.a,null,r.a.createElement(_.a,{sm:6},r.a.createElement(I.a.Group,null,r.a.createElement(I.a.Label,null,e("db.user.form.email")),r.a.createElement(I.a.Control,{type:"email",value:this.state.user.email,onChange:this.handleEmailChange,required:!0}))),r.a.createElement(_.a,{sm:6},r.a.createElement(I.a.Group,null,r.a.createElement(I.a.Label,null,e("db.user.form.phone")),r.a.createElement(I.a.Control,{type:"text",value:this.state.user.phone,onChange:this.handlePhoneChange})))),r.a.createElement(N.a,null,r.a.createElement(_.a,{sm:6},r.a.createElement(I.a.Group,null,r.a.createElement(I.a.Label,{className:"mb-0"},e("db.user.form.city")),r.a.createElement(Ye.a,{value:this.state.user.city,onChange:this.handleCityChange,options:this.state.selection.cities}))),r.a.createElement(_.a,{sm:6},r.a.createElement(I.a.Group,null,r.a.createElement(I.a.Label,{className:"mb-0"},e("db.user.form.role")),r.a.createElement(Ye.a,{value:this.state.user.role,onChange:this.handleRoleChange,options:this.state.selection.roles})))),r.a.createElement(N.a,null,r.a.createElement(_.a,null,r.a.createElement(T.a,{variant:"primary",type:"submit",block:!0,className:"waves-effect waves-light"},this.state.user._id?e("db.user.form.button.update"):e("db.user.form.button.create"))),this.state.user._id&&[5,11].includes(this.context.role)&&r.a.createElement(_.a,null,r.a.createElement(T.a,{variant:"danger",onClick:this.handleDelete,block:!0,className:"waves-effect waves-light"},e("db.user.form.button.delete"))))))))}}]),a}(n.Component);ht.contextType=A;var ft=Object(s.b)()(ht),bt=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={thead:[e.props.t("db.users.table.role"),e.props.t("db.users.table.name"),e.props.t("db.users.table.email"),e.props.t("db.users.table.phone"),e.props.t("db.users.table.createdAt")],columns:[{data:"role",render:function(t){return'<span style="width: 100%;" class="badge badge-'.concat(mt(t),'">').concat(st(t,e.props.t),"</span>")}},{data:"name"},{data:"email",render:function(e){return e}},{data:"phone",render:function(e){return e||"<i>Not set</i>"}},{data:"created_at",render:function(e){var t=new Date(e);return"".concat(t.getDate().toString().padStart(2,"0"),".").concat((t.getMonth()+1).toString().padStart(2,"0"),".").concat(t.getFullYear())},searchable:!1}],order:[[4,"desc"]],ajax:"/api/datatable/users",rowCallback:function(t,a){return t.onclick=function(){return e.handleSelection(a)}},selected:{},handleRefresh:function(){console.log("old")}},e.controller=new AbortController,e.setRefresh=function(t){return e.setState({handleRefresh:t})},e}return Object(b.a)(a,[{key:"componentDidMount",value:function(){console.log("users")}},{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"handleSelection",value:function(e){this.state.selected===e?this.setState({selected:{}}):this.setState({selected:e})}},{key:"render",value:function(){var e=this.props.t;return r.a.createElement("div",{className:"container-fluid"},r.a.createElement(N.a,null,r.a.createElement(_.a,{xl:8},r.a.createElement(w.a,{className:"m-b-20"},r.a.createElement(w.a.Body,null,r.a.createElement("h4",{className:"mt-0 header-title"},e("db.users.table.title")),r.a.createElement(H,{order:this.state.order,ajax:this.state.ajax,columns:this.state.columns,thead:this.state.thead,rowCallback:this.state.rowCallback,setRefresh:this.setRefresh})))),r.a.createElement(ft,{doRefresh:this.state.handleRefresh,selected:this.state.selected._id})))}}]),a}(n.Component),gt=Object(s.b)()(bt),vt=a(110),Et=Object(s.b)()((function(e){var t=e.t,a=e.data,n=e.doChange;return r.a.createElement(w.a,null,r.a.createElement(w.a.Header,null,r.a.createElement(ue.a.Toggle,{as:N.a,variant:"link",eventKey:a._id},r.a.createElement(_.a,{xs:12,sm:6},a.name),r.a.createElement(_.a,{className:"align-self-end text-right text-secondary font-md"},t("db.operators.vehicles")," ",a.operatorsAll.map((function(e){return e.vehicles.length})).reduce((function(e,t){return e+t}),0)," | ",t("db.operators.operators")," ",a.operatorsAll.length))),r.a.createElement(ue.a.Collapse,{eventKey:a._id},r.a.createElement(r.a.Fragment,null,a.operatorsAll.map((function(e){return r.a.createElement(wt,{key:e._id,data:e,doChange:n})})))))})),yt=Object(s.b)()((function(e){var t=e.t,a=e.eventKey,c=e.data,l=e.doChange,i=Object(vt.b)(a),o=Object(n.useState)(c.company||""),s=Object(O.a)(o,2),m=s[0],u=s[1],d=Object(n.useState)(!1),p=Object(O.a)(d,2),h=p[0],f=p[1],b='mutation{operatorUpdate(_id:"'.concat(c._id,'",company:"').concat(m,'"){_id}}');return r.a.createElement(N.a,null,r.a.createElement(_.a,{sm:12,md:6,className:"ml-3"},h&&r.a.createElement(B.a,null,r.a.createElement(R.a,{value:m,onChange:function(e){return u(e.target.value)},type:"text"}),r.a.createElement(B.a.Append,null,m!==c.company&&r.a.createElement(T.a,{variant:"primary",onClick:function(){l(b,(function(e){return f(!1)}))}},r.a.createElement("i",{className:"fa fa-paper-plane"})),r.a.createElement(T.a,{variant:"outline-danger",onClick:function(){f(!1),u(c.company||"")}},r.a.createElement("i",{className:"fa fa-close"})))),!h&&r.a.createElement(r.a.Fragment,null,r.a.createElement("a",{href:"#",className:"",onClick:function(e){e.preventDefault(),i(e)}},c.company||c.operatorId),r.a.createElement("a",{href:"#",onClick:function(e){e.preventDefault(),f(!0)},className:"fa fa-edit font-md ml-1"}))),r.a.createElement(_.a,{className:"align-self-end text-right text-secondary font-md"},t("db.operators.vehicles")," ",c.vehicles.length))})),wt=Object(s.b)()((function(e){var t=e.t,a=e.data,n=e.doChange;return r.a.createElement(ue.a,null,r.a.createElement(w.a,{className:a.listed?"operator-active":a.visible?"operator-visible":"operator-disabled"},r.a.createElement(w.a.Header,null,r.a.createElement(yt,{eventKey:a._id,data:a,doChange:n})),r.a.createElement(ue.a.Collapse,{eventKey:a._id},r.a.createElement(w.a.Body,{className:"font-md"},r.a.createElement(I.a,null,r.a.createElement(I.a.Group,{as:N.a,className:"mb-0"},r.a.createElement(I.a.Label,{column:!0,sm:"2"},t("db.operators.listed")),r.a.createElement(_.a,{sm:"10"},r.a.createElement("input",{onChange:function(){console.log("yep"),n('mutation{operatorUpdate(_id:"'.concat(a._id,'",listed:').concat(!a.listed,"){_id}}"))},type:"checkbox",id:a._id+"s",switch:"primary",checked:a.listed}),r.a.createElement("label",{htmlFor:a._id+"s",className:"mb-0","data-on-label":t("db.operators.switch.yes"),"data-off-label":t("db.operators.switch.no")}))),r.a.createElement(I.a.Group,{as:N.a},r.a.createElement(I.a.Label,{column:!0,sm:"2"},t("db.operators.visible")),r.a.createElement(_.a,{sm:"10"},r.a.createElement("input",{disabled:a.listed,onChange:function(){console.log("nope"),n('mutation{operatorUpdate(_id:"'.concat(a._id,'",visible:').concat(!a.visible,"){_id}}"))},type:"checkbox",id:a._id+"d",switch:a.listed?"default":"primary",checked:a.visible}),r.a.createElement("label",{htmlFor:a._id+"d",className:"mb-0","data-on-label":t("db.operators.switch.yes"),"data-off-label":t("db.operators.switch.no")})))),r.a.createElement(N.a,null,r.a.createElement(_.a,null,t("db.operators.placements")," ",a.vehicles.map((function(e){return e.totalAds})).reduce((function(e,t){return e+t}),0)))))))})),xt=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={cities:[],loaded:!1},e.controller=new AbortController,e.loadCityOperators=Object(h.a)(p.a.mark((function t(){var a,n;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"query{cities{_id name operatorsAll{_id operatorId company vehicles{totalAds} listed visible}}}",t.prev=1,t.next=4,L("query{cities{_id name operatorsAll{_id operatorId company vehicles{totalAds} listed visible}}}",e.controller.signal,e.props.token);case 4:a=t.sent,n=a.cities,e.setState({cities:n||[],loaded:!0}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),console.log("Ohnoo, ",t.t0.toString()),e.setState({loaded:!0});case 13:case"end":return t.stop()}}),t,null,[[1,9]])}))),e.handleOperatorChange=function(){var t=Object(h.a)(p.a.mark((function t(a,n){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,L(a,e.controller.signal,e.props.token);case 3:n&&n(),e.loadCityOperators(),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log("Ohnoo, ",t.t0.toString());case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e,a){return t.apply(this,arguments)}}(),e}return Object(b.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){this.loadCityOperators()}},{key:"render",value:function(){var e=this,t=this.props.t;return r.a.createElement("div",{className:"container-fluid"},r.a.createElement("h3",{className:"text-white border-bottom mb-4"},t("db.operators.title")),this.state.loaded&&r.a.createElement(ue.a,null,this.state.cities.map((function(t){return r.a.createElement(Et,{key:t._id,data:t,doChange:e.handleOperatorChange})}))))}}]),a}(n.Component),kt=Object(s.b)()(xt),At=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={team:{_id:"",company:""}},e.controller=new AbortController,e.handleDelete=function(){var t=Object(h.a)(p.a.mark((function t(a){var n,r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.props.t,r='mutation{teamHardDelete(_id:"'.concat(e.state.team._id,'")}'),ee.a.fire({title:n("db.team.form.delete.warning.title"),text:n("db.team.form.delete.warning.text"),icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes",cancelButtonText:"Cancel"}).then(function(){var t=Object(h.a)(p.a.mark((function t(a){var c;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.value){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,L(r,e.controller.signal);case 5:c=t.sent,c.teamHardDelete?(ee.a.fire({icon:"success",title:n("db.team.form.delete.success.title"),showConfirmButton:!1,timer:1500}),e.setState({team:{_id:"",company:""}}),e.props.doRefresh()):ee.a.fire({icon:"error",title:n("db.team.form.delete.failed.title"),text:n("db.team.form.delete.failed.text"),showConfirmButton:!1,timer:1500}),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(2),console.log("Error while loading",t.t0.toString());case 13:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e){return t.apply(this,arguments)}}());case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(b.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentWillReceiveProps",value:function(e){console.log("teamsTool.props",e),this.setState({team:{_id:"",company:""}}),Object.keys(e.selected).length&&(this.setState({team:{_id:e.selected._id,company:e.selected.company}}),this.loadTeamData(e.selected._id))}},{key:"loadTeamData",value:function(){var e=Object(h.a)(p.a.mark((function e(t){var a,n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a='query{ team(_id: "'.concat(t,'") { company }}'),e.prev=1,e.next=4,L(a,this.controller.signal);case 4:n=e.sent,(r=n.team)&&this.setState({team:Object(C.a)(Object(C.a)({},r),{},{_id:t})}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log("Fetch failed: ",e.t0.toString());case 12:case"end":return e.stop()}}),e,this,[[1,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"handleSubmit",value:function(){var e=Object(h.a)(p.a.mark((function e(t){var a,n,r,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=this.state.team,n=a._id,r=a.company,c=n?'mutation{teamUpdate(_id:"'.concat(n,'" company:"').concat(r,'"){ _id }}'):'mutation{teamCreate(company:"'.concat(r,'"){ _id company }}'),e.prev=3,e.next=6,L(c,this.controller.signal);case 6:e.sent,this.props.doRefresh(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),console.log(e.t0);case 13:case"end":return e.stop()}}),e,this,[[3,10]])})));return function(t){return e.apply(this,arguments)}}()},{key:"handleNameChange",value:function(e){this.state.team.company=e.target.value,this.setState({team:this.state.team})}},{key:"render",value:function(){var e=this,t=this.props.t;return r.a.createElement(w.a,{className:"m-b-20"},r.a.createElement(w.a.Body,null,r.a.createElement("h4",null,this.state.team._id?r.a.createElement(r.a.Fragment,null,t("db.team.form.title"),r.a.createElement(ba,{to:"team",id:this.state.team._id,className:"pull-right"},r.a.createElement("i",{className:"mdi mdi-arrow-expand-all m-r-5 text-primary"}))):t("db.team.form.title.new")),r.a.createElement(I.a,{onSubmit:function(t){return e.handleSubmit(t)}},r.a.createElement(I.a.Group,null,r.a.createElement(I.a.Label,null,t("db.team.form.company")),r.a.createElement(I.a.Control,{type:"text",placeholder:t("db.team.form.company"),value:this.state.team.company,onChange:function(t){return e.handleNameChange(t)},required:!0})),r.a.createElement(N.a,null,this.state.team._id&&r.a.createElement(_.a,{xs:12,className:"mb-2"},r.a.createElement(ba,{to:"team",id:this.state.team._id,className:"btn btn-block btn-primary waves-effect waves-light"},t("db.team.form.button.view"))),r.a.createElement(_.a,null,r.a.createElement(T.a,{block:!0,variant:"success",type:"submit",className:"waves-effect waves-light"},this.state.team._id?t("db.team.form.button.update"):t("db.team.form.button.create"))),this.state.team._id&&[5,11].includes(this.context.role)&&r.a.createElement(_.a,null,r.a.createElement(T.a,{variant:"danger",onClick:this.handleDelete,block:!0,className:"waves-effect waves-light"},t("db.team.form.button.delete")))))))}}]),a}(n.Component);At.contextType=A;var Ot=Object(s.b)()(At),Ct=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={redirect:"",thead:["#",e.props.t("db.teams.table.company"),e.props.t("db.teams.table.members"),e.props.t("db.teams.table.createdAt")],columns:[{data:"_id",visible:!1,searchable:!1,orderable:!1},{data:"company"},{data:"members",searchable:!1},{data:"created_at",render:function(e){var t=new Date(e);return"".concat(t.getDate().toString().padStart(2,"0"),".").concat((t.getMonth()+1).toString().padStart(2,"0"),".").concat(t.getFullYear())},searchable:!1}],ajax:"/api/datatable/teams",rowCallback:function(t,a){return t.onclick=function(){return e.handleSelection(a)}},selected:"",handleRefresh:function(){console.log("old")}},e.controller=new AbortController,e.setRefresh=function(t){return e.setState({handleRefresh:t})},e}return Object(b.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){console.log("Teams")}},{key:"handleSelection",value:function(e){this.state.selected._id===e._id?this.setState({selected:{}}):this.setState({selected:e})}},{key:"render",value:function(){var e=this.props.t;return r.a.createElement("div",{className:"container-fluid"},r.a.createElement(N.a,null,r.a.createElement(_.a,{xl:8},r.a.createElement(w.a,{className:"m-b-20"},r.a.createElement(w.a.Body,null,r.a.createElement("h4",{className:"mt-0 header-title"},e("db.teams.table.title")),r.a.createElement(H,{order:this.state.order,ajax:this.state.ajax,columns:this.state.columns,thead:this.state.thead,rowCallback:this.state.rowCallback,setRefresh:this.setRefresh})))),r.a.createElement(_.a,{xl:4},r.a.createElement(Ot,{doRefresh:this.state.handleRefresh,doSelect:this.handleSelection,selected:this.state.selected}))))}}]),a}(n.Component),jt=Object(s.b)()(Ct),St=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={options:[],selected:{}},e.controller=new AbortController,e.handleInstallerChange=function(t){e.setState({selected:t})},e}return Object(b.a)(a,[{key:"componentDidMount",value:function(){this.loadInstallers()}},{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"loadInstallers",value:function(){var e=Object(h.a)(p.a.mark((function e(){var t,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"query{ installersValid { _id name }}",e.prev=1,e.next=4,L("query{ installersValid { _id name }}",this.controller.signal);case 4:t=e.sent,(a=t.installersValid)&&this.setState({options:a.map((function(e){return{value:e._id,label:e.name}}))}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log("Fetch failed: ",e.t0.toString());case 12:case"end":return e.stop()}}),e,this,[[1,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"handleSubmit",value:function(){var e=Object(h.a)(p.a.mark((function e(t){var a,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a='mutation{installerCreate(team:"'.concat(this.props.team,'", user:"').concat(this.state.selected.value,'"){ _id }}'),e.prev=2,e.next=5,L(a,this.controller.signal);case 5:n=e.sent,n.installerCreate&&(this.setState({selected:{}}),this.loadInstallers(),this.props.doRefresh()),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.log(e.t0);case 13:case"end":return e.stop()}}),e,this,[[2,10]])})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.t;return r.a.createElement(w.a,{className:"m-b-20"},r.a.createElement(w.a.Body,null,r.a.createElement("h4",null,t("db.installer.form.title.new")),r.a.createElement(I.a,{onSubmit:function(t){return e.handleSubmit(t)}},r.a.createElement(I.a.Group,null,r.a.createElement(I.a.Label,{className:"mb-0"},t("db.installer.form.installer")),r.a.createElement(Ye.a,{value:this.state.selected,onChange:this.handleInstallerChange,options:this.state.options,required:!0})),r.a.createElement(N.a,null,r.a.createElement(_.a,null,r.a.createElement(T.a,{block:!0,variant:"primary",type:"submit",className:"waves-effect waves-light"},t("db.installer.form.button.add")))))))}}]),a}(n.Component),Nt=Object(s.b)()(St),_t=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).controller=new AbortController,e.handleDelete=Object(h.a)(p.a.mark((function t(){var a,n;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=e.props.t,n='mutation{installerRemove(_id:"'.concat(e.props.selected._id,'")}'),ee.a.fire({title:a("db.installer.form.delete.warning.title"),text:a("db.installer.form.delete.warning.text"),icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes",cancelButtonText:"Cancel"}).then(function(){var t=Object(h.a)(p.a.mark((function t(r){var c;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.value){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,L(n,e.controller.signal);case 5:c=t.sent,c.installerRemove?(ee.a.fire({icon:"success",title:a("db.installer.form.delete.success.title"),showConfirmButton:!1,timer:1500}),e.props.doRefresh()):ee.a.fire({icon:"error",title:a("db.installer.form.delete.failed.title"),text:a("db.installer.form.delete.failed.text"),showConfirmButton:!1,timer:1500}),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(2),console.log("Error while loading",t.t0.toString());case 13:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e){return t.apply(this,arguments)}}());case 3:case"end":return t.stop()}}),t)}))),e}return Object(b.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"render",value:function(){var e=this.props.t;return r.a.createElement(w.a,{className:"m-b-20"},r.a.createElement(w.a.Body,null,r.a.createElement("h4",null,e("db.installer.form.title")),r.a.createElement("h6",null,e("db.installers.table.name"),": ",this.props.selected.name),r.a.createElement(N.a,null,r.a.createElement(_.a,null,r.a.createElement(T.a,{onClick:this.handleDelete,block:!0,variant:"primary",type:"submit",className:"waves-effect waves-light"},e("db.installer.form.button.remove"))))))}}]),a}(n.Component),Dt=Object(s.b)()(_t),It=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={redirect:"",thead:["#",e.props.t("db.installers.table.name"),e.props.t("db.installers.table.createdAt")],columns:[{data:"_id",visible:!1,searchable:!1,orderable:!1},{data:"name"},{data:"created_at",render:function(e){var t=new Date(e);return"".concat(t.getDate().toString().padStart(2,"0"),".").concat((t.getMonth()+1).toString().padStart(2,"0"),".").concat(t.getFullYear())},searchable:!1}],ajax:"/api/datatable/team/"+e.props.match.params.id,rowCallback:function(t,a){return t.onclick=function(){return e.handleSelection(a)}},selected:null,handleRefresh:function(){console.log("old")}},e.handleSelection=function(t){if(e.state.selected&&e.state.selected._id===t._id)return e.setState({selected:null});e.setState({selected:t})},e.setRefresh=function(t){return e.setState({handleRefresh:function(){t(),e.setState({selected:null})}})},e}return Object(b.a)(a,[{key:"render",value:function(){var e=this.props.t;return r.a.createElement("div",{className:"container-fluid"},r.a.createElement(N.a,null,r.a.createElement(_.a,{xl:8},r.a.createElement(w.a,{className:"m-b-20"},r.a.createElement(w.a.Body,null,r.a.createElement("h4",{className:"mt-0 header-title"},e("db.teams.table.title")),r.a.createElement(H,{order:this.state.order,ajax:this.state.ajax,columns:this.state.columns,thead:this.state.thead,rowCallback:this.state.rowCallback,setRefresh:this.setRefresh})))),r.a.createElement(_.a,{xl:4},this.state.selected&&r.a.createElement(Dt,{team:this.props.match.params.id,doRefresh:this.state.handleRefresh,selected:this.state.selected}),!this.state.selected&&r.a.createElement(Nt,{team:this.props.match.params.id,doRefresh:this.state.handleRefresh}))))}}]),a}(n.Component),Tt=Object(s.b)()(It),Bt=a(71);var Rt=Object(s.b)()((function(e){var t=e.item,a=e.t;return r.a.createElement("li",{className:"feed-item"},r.a.createElement("span",{className:"date"},function(e,t){var a=new Date(parseInt(e));return"".concat((new Date).getFullYear()!==a.getFullYear()?"".concat((new Date).getFullYear()," "):"").concat(t("month."+a.getMonth()).toUpperCase()," ").concat(a.getDate())}(t.created_at,a)),r.a.createElement("span",{className:"activity-text",dangerouslySetInnerHTML:{__html:t.message}}))})),Lt=function(){var e=Object(h.a)(p.a.mark((function e(t,a){var n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.loading){e.next=20;break}return t.loading=!0,t.setState({loading:!0}),e.prev=3,e.next=6,L(a,t.controller.signal);case 6:if(n=e.sent,1!==Object.keys(n).length){e.next=13;break}if(!(r=n[Object.keys(n)[0]])||0===r.length){e.next=13;break}return t.setState({feed:[].concat(Object(Q.a)(t.state.feed),Object(Q.a)(r)),loading:!1}),t.loading=r.length<t.limit,e.abrupt("return");case 13:t.setState({loading:!1}),t.loading=!0,e.next=20;break;case 17:e.prev=17,e.t0=e.catch(3),"AbortError"!==e.t0.name&&console.log("Fetch failed: ",e.t0.toString());case 20:case"end":return e.stop()}}),e,null,[[3,17]])})));return function(t,a){return e.apply(this,arguments)}}(),Ft=Object(s.b)()((function(e){var t=e.t,a=e.data,n=e.className,c=e.doLoadMore;return r.a.createElement("div",{className:n||"col-md-6"},r.a.createElement(w.a,{className:"m-b-20"},r.a.createElement(w.a.Body,null,r.a.createElement("h4",{className:"mt-0 m-b-15 header-title"},t(a.title)),a.feed.length<=0&&!a.loading&&t("db.feed.empty"),a.feed.length>0&&r.a.createElement("div",{className:"scrollable mx-280",onScroll:function(e){return function(e,t){e.target.scrollHeight-e.target.clientHeight-e.target.scrollTop<90&&t()}(e,c)}},r.a.createElement("ol",{className:"activity-feed mb-0"},a.feed.map((function(e,t){return r.a.createElement(Rt,{key:t,item:e})})))),a.loading&&r.a.createElement("div",{className:"text-center m-3"},r.a.createElement(x.a,{animation:"border",variant:"warning"})))))})),Mt={NEW:"campaign.new",EDIT:{NAME:"campaign.edit.name",CLIENT:"campaign.edit.client",BUDGET:"campaign.edit.budget",CITIES:"campaign.edit.cities",START_DATE:"campaign.edit.start_date",END_DATE:"campaign.edit.end_date"},NOTIFICATION:{PRE_START:"campaign.notification.pre_start",START:"campaign.notification.start",PRE_END:"campaign.notification.pre_end",END:"campaign.notification.end",INSTALLED:"campaign.notification.installed",REMOVED:"campaign.notification.removed"},SHARE:"campaign.share",DELETE:"campaign.del"},Ut={NEW:"install.new",EDIT:{COUNT:"install.edit.count"},DELETE:"install.del"},qt={NEW:"remove.new",EDIT:{COUNT:"remove.edit.count"},DELETE:"remove.del",CLEAR:"client.clear"},Pt=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,c=new Array(n),l=0;l<n;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))).state={feed:[],loading:!0},e.loading=!1,e.controller=new AbortController,e.activities=[Ut.NEW,qt.NEW],e.limit=4,e.load=function(){return Lt(Object(Bt.a)(e),'query{vehicleActivities(_id:"'.concat(e.props.id,'", types:').concat(JSON.stringify(e.activities),", skip:").concat(e.state.feed.length,", limit:").concat(e.limit,"){ message created_at }}"))},e.render=function(){return r.a.createElement(Ft,{className:"col-12",data:Object(C.a)(Object(C.a)({},e.state),{},{title:"db.feed.vehicle.activity"}),doLoadMore:e.load})},e}return Object(b.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){this.load()}}]),a}(n.Component),Vt=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={thead:[e.props.t("db.vehicle.ptable.campaignName"),e.props.t("db.vehicle.ptable.place"),e.props.t("db.vehicle.ptable.amount"),e.props.t("db.vehicle.ptable.createdAt")],columns:[{data:"campaign"},{data:"place"},{data:"count",defaultContent:"0",searchable:!1},{data:"created_at",render:function(e){var t=new Date(e);return"".concat(t.getDate().toString().padStart(2,"0"),".").concat((t.getMonth()+1).toString().padStart(2,"0"),".").concat(t.getFullYear())},searchable:!1}],ajax:"/api/datatable/vehicle/",vehicle:{},campaigns:[],loaded:!1},e.controller=new AbortController,e.campaignsOnTheFleet=function(){return e.state.campaigns.length},e.getMapData=function(){return{height:254,query:'query{vehicle(_id: "'.concat(e.state.vehicle._id,'"){ _id haveAds longitude latitude line }}'),latitude:e.state.vehicle.latitude,longitude:e.state.vehicle.longitude,getData:function(e){return[e.vehicle]},smooth:!0,zoom:12}},e}return Object(b.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){var e=Object(h.a)(p.a.mark((function e(){var t,a,n,r,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("fleetFetails"),t=this.props.match.params.id,a='query{vehicle(_id:"'.concat(t,'"){ _id numberPlate totalAds line city{name}type operator{company} latitude longitude } vehicleCampaigns(_id:"').concat(t,'"){ _id name }}'),e.prev=3,e.next=6,L(a,this.controller.signal);case 6:n=e.sent,r=n.vehicle,c=n.vehicleCampaigns,this.setState({vehicle:r||{},loaded:!0,campaigns:c}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(3),"SyntaxError"===e.t0.name?console.log("No connection"):(console.log("Ohnoo, ",e.t0.toString()),this.setState({loaded:!0}));case 15:case"end":return e.stop()}}),e,this,[[3,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.t;if(!this.state.loaded)return r.a.createElement("div",{className:"container-fluid text-center"},r.a.createElement("h3",{className:"text-white"},e("loading")));if(0===Object.keys(this.state.vehicle).length)return r.a.createElement("div",{className:"container-fluid text-center"},r.a.createElement("h3",{className:"text-white"},e("db.vehicle.404")));var t=Object(oe.vehTypeObject)(this.state.vehicle._id),a=t.name,n=t.img;return r.a.createElement("div",{className:"container-fluid"},r.a.createElement(N.a,{className:"border-bottom mb-4"},r.a.createElement(_.a,{xs:12},r.a.createElement("h3",{className:"text-white"},a.toUpperCase()+" "+Object(oe.vehID)(this.state.vehicle._id)+(this.state.vehicle.numberPlate?"(".concat(this.state.vehicle.numberPlate,")"):"")))),r.a.createElement(N.a,null,r.a.createElement(_.a,{xl:8},r.a.createElement(N.a,null,r.a.createElement(_.a,{xl:6},r.a.createElement(w.a,{className:"m-b-20"},r.a.createElement(w.a.Body,null,r.a.createElement("div",{className:"profile-widget text-center"},r.a.createElement(N.a,{className:"mb-4"},r.a.createElement(_.a,{className:"text-vehicle-info"},this.state.vehicle.operator.company)),r.a.createElement(N.a,{className:"text-vehicle-info"},r.a.createElement(_.a,null,r.a.createElement("img",{src:n,alt:a,height:"60"}),r.a.createElement("br",null),this.state.vehicle.numberPlate||""),r.a.createElement(_.a,null,r.a.createElement("i",{className:"fa fa-map-marker"}),a,r.a.createElement("br",null),Object(oe.vehID)(this.state.vehicle._id),r.a.createElement("br",null),e("db.vehicle.line")," ",this.state.vehicle.line)),r.a.createElement("ul",{className:"list-inline row mt-3 mb-0"},r.a.createElement("li",{className:"col-md-6"},r.a.createElement("p",{className:"m-b-5 font-18 font-600"},this.campaignsOnTheFleet()),r.a.createElement("p",{className:"mb-0"},e("db.vehicle.campaigns"))),r.a.createElement("li",{className:"col-md-6"},r.a.createElement("p",{className:"m-b-5 font-18 font-600"},this.state.vehicle.totalAds),r.a.createElement("p",{className:"mb-0"},e("db.vehicle.placements")))))))),r.a.createElement(_.a,{xl:6,className:"mb-3"},r.a.createElement(Be,{data:this.getMapData()}))),r.a.createElement(N.a,null,r.a.createElement(_.a,{sm:12},r.a.createElement(w.a,null,r.a.createElement(w.a.Body,null,r.a.createElement("h4",{className:"mt-0 header-title"},e("db.vehicle.ptable.title")),r.a.createElement(H,{order:this.state.order,ajax:"".concat(this.state.ajax).concat(this.props.match.params.id),columns:this.state.columns,thead:this.state.thead})))))),r.a.createElement(_.a,{xl:4},r.a.createElement(Pt,{id:this.state.vehicle._id}))))}}]),a}(n.Component),Wt=Object(s.b)()(Vt),Ht=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={redirect:"",thead:["#",e.props.t("db.vehicles.table.id"),e.props.t("db.vehicles.table.numberPlate"),e.props.t("db.vehicles.table.operator"),e.props.t("db.vehicles.table.placements")],columns:[{data:"nr"},{data:"_id",render:function(e){return Object(oe.vehID)(e)}},{data:"numberPlate",defaultContent:"<i>Not set</i>",searchable:!0},{data:"company",defaultContent:"<i>Not set</i>",searchable:!0},{data:"totalAds",render:function(e){return'<div style="width: 100%;text-align: center;">'.concat(e>0?'<span class="badge badge-success">'.concat(e,"</span>"):'<span class="badge badge-danger">'.concat(e,"</span>"),"</div>")},searchable:!1,orderable:!0}],ajax:"/api/datatable/fleet",rowCallback:function(t,a){t.classList.add("click"),t.onclick=function(){return e.setState({redirect:a._id})}}},e}return Object(b.a)(a,[{key:"componentDidMount",value:function(){console.log("Fleet")}},{key:"render",value:function(){if(this.state.redirect)return r.a.createElement(k.a,{push:!0,to:"/dashboard/vehicle/".concat(this.state.redirect)});var e=this.props.t;return r.a.createElement("div",{className:"container-fluid"},r.a.createElement(N.a,null),r.a.createElement(N.a,null,r.a.createElement(_.a,{xs:12},r.a.createElement(w.a,{className:"m-b-20"},r.a.createElement(w.a.Body,null,r.a.createElement("h4",{className:"mt-0 header-title"},e("db.vehicles.table.title")),r.a.createElement(H,{ajax:this.state.ajax,columns:this.state.columns,thead:this.state.thead,rowCallback:this.state.rowCallback}))))))}}]),a}(n.Component),Gt=Object(s.b)()(Ht),zt=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,c=new Array(n),l=0;l<n;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))).state={main:0,description:"".concat(e.props.t("db.stat.card.activeCampaigns.addition")," 0 \u20ac"),loaded:!1},e.controller=new AbortController,e.render=function(){return r.a.createElement(be,{item:Object(C.a)(Object(C.a)({},e.state),{},{title:e.props.t("db.stat.card.activeCampaigns.title")})})},e}return Object(b.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){var e=Object(h.a)(p.a.mark((function e(){var t,a,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"query{campaignsActive{ budget }}",e.prev=1,e.next=4,L("query{campaignsActive{ budget }}",this.controller.signal);case 4:if(t=e.sent,a=t.campaignsActive){e.next=8;break}return e.abrupt("return");case 8:n=a.map((function(e){return e.budget})).reduce((function(e,t){return e+t}),0),this.setState({description:"".concat(this.props.t("db.stat.card.activeCampaigns.addition")," ").concat(n," \u20ac"),main:a.length,loaded:!0}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),"AbortError"!==e.t0.name&&this.setState({loaded:!0});case 15:case"end":return e.stop()}}),e,this,[[1,12]])})));return function(){return e.apply(this,arguments)}}()}]),a}(n.Component),Qt=Object(s.b)()(zt),Yt=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,c=new Array(n),l=0;l<n;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))).state={main:0,description:"".concat(e.props.t("db.stat.card.totalCampaigns.addition")," 0 \u20ac"),budgets:[],loaded:!1},e.controller=new AbortController,e.render=function(){return r.a.createElement(be,{item:Object(C.a)(Object(C.a)({},e.state),{},{title:e.props.t("db.stat.card.totalCampaigns.title")})})},e}return Object(b.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){var e=Object(h.a)(p.a.mark((function e(){var t,a,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"query{campaigns{ budget }}",e.prev=1,e.next=4,L("query{campaigns{ budget }}",this.controller.signal);case 4:if(t=e.sent,a=t.campaigns){e.next=8;break}return e.abrupt("return");case 8:n=a.map((function(e){return e.budget})).reduce((function(e,t){return e+t}),0),this.setState({description:"".concat(this.props.t("db.stat.card.totalCampaigns.addition")," ").concat(n," \u20ac"),main:a.length,loaded:!0}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),"AbortError"!==e.t0.name&&this.setState({loaded:!0});case 15:case"end":return e.stop()}}),e,this,[[1,12]])})));return function(){return e.apply(this,arguments)}}()}]),a}(n.Component),Zt=Object(s.b)()(Yt),Jt=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,c=new Array(n),l=0;l<n;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))).state={main:"-",description:"".concat(e.props.t("db.stat.card.latestCampaign.addition")," 0 \u20ac"),loaded:!1},e.controller=new AbortController,e.render=function(){return r.a.createElement(be,{item:Object(C.a)(Object(C.a)({},e.state),{},{title:e.props.t("db.stat.card.latestCampaign.title")})})},e}return Object(b.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){var e=Object(h.a)(p.a.mark((function e(){var t,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"query{ campaign { _id name budget }}",e.prev=1,e.next=4,L("query{ campaign { _id name budget }}",this.controller.signal);case 4:t=e.sent,a=t.campaign,this.setState({main:a.name,link:"campaign",id:a._id,description:"".concat(this.props.t("db.stat.card.latestCampaign.addition")," ").concat(a.budget," \u20ac"),loaded:!0}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),"AbortError"!==e.t0.name&&this.setState({loaded:!0});case 12:case"end":return e.stop()}}),e,this,[[1,9]])})));return function(){return e.apply(this,arguments)}}()}]),a}(n.Component),Kt=Object(s.b)()(Jt),Xt=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,c=new Array(n),l=0;l<n;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))).state={main:"0 \u20ac",description:"".concat(e.props.t("db.stat.card.revenueThisMonth.addition")," 0"),loaded:!1},e.controller=new AbortController,e.render=function(){return r.a.createElement(be,{item:Object(C.a)(Object(C.a)({},e.state),{},{title:e.props.t("db.stat.card.revenueThisMonth.title")})})},e}return Object(b.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){var e=Object(h.a)(p.a.mark((function e(){var t,a,n,r,c,l,i,o,s,m;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Date,a='query{campaignsTil(date:"'.concat(new Date(t.getFullYear(),t.getMonth()-1).getTime(),'"){ budget created_at }}'),e.prev=2,e.next=5,L(a,this.controller.signal);case 5:n=e.sent,r=n.campaignsTil,c=new Date(t.getFullYear(),t.getMonth()-1).getTime(),l=0,i=0,o=Object(S.a)(r);try{for(o.s();!(s=o.n()).done;)m=s.value,parseInt(m.created_at)<c?i+=m.budget:l+=m.budget}catch(u){o.e(u)}finally{o.f()}this.setState({main:"".concat(l," \u20ac"),description:"".concat(this.props.t("db.stat.card.revenueThisMonth.addition")," ").concat(i," \u20ac"),loaded:!0}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),"AbortError"!==e.t0.name&&this.setState({loaded:!0});case 17:case"end":return e.stop()}}),e,this,[[2,14]])})));return function(){return e.apply(this,arguments)}}()}]),a}(n.Component),$t=Object(s.b)()(Xt),ea=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,c=new Array(n),l=0;l<n;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))).state={feed:[],loading:!0},e.loading=!1,e.controller=new AbortController,e.activities=[Mt.NEW,Mt.DELETE],e.limit=8,e.load=function(){return Lt(Object(Bt.a)(e),"query{activities(types:".concat(JSON.stringify(e.activities),", skip:").concat(e.state.feed.length,", limit:").concat(e.limit,"){ message created_at }}"))},e.render=function(){return r.a.createElement(Ft,{data:Object(C.a)(Object(C.a)({},e.state),{},{title:"db.feed.sales.activity"}),doLoadMore:e.load,className:"col-xl-12 col-md-6 col-sm-12"})},e}return Object(b.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){this.load()}}]),a}(n.Component),ta=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,c=new Array(n),l=0;l<n;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))).state={feed:[],loading:!0},e.loading=!1,e.controller=new AbortController,e.limit=8,e.activities=[Mt.NOTIFICATION.END,Mt.NOTIFICATION.PRE_END,Mt.NOTIFICATION.START,Mt.NOTIFICATION.PRE_START],e.load=function(){return Lt(Object(Bt.a)(e),"query{activities(types:".concat(JSON.stringify(e.activities),", skip:").concat(e.state.feed.length,", limit:").concat(e.limit,"){ message created_at }}"))},e.render=function(){return r.a.createElement(Ft,{data:Object(C.a)(Object(C.a)({},e.state),{},{title:"db.feed.campaigns.notification"}),doLoadMore:e.load,className:"col-xl-12 col-md-6 col-sm-12"})},e}return Object(b.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){this.load()}}]),a}(n.Component),aa=a(186),na=a.n(aa),ra=a(187),ca=a.n(ra),la=a(188),ia=a.n(la),oa=a(189),sa=a.n(oa),ma=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={cities:[],operator_selected:null,city_selected:null},e.controller=new AbortController,e.getMapData=function(){if(null!==e.state.city_selected){var t,a,n=e.state.city_selected,r=n._id,c=n.longitude,l=n.latitude;return e.state.operator_selected?(a='query{operatorVehicles(_id: "'.concat(e.state.operator_selected.value,'"){ _id haveAds longitude latitude listed }}'),t=function(e){return e.operatorVehicles}):(a='query{cityVehicles(_id: "'.concat(r,'"){ _id haveAds longitude latitude listed }}'),t=function(e){return e.cityVehicles}),{height:624,query:a,latitude:l,longitude:c,getData:t}}},e.handleCityChange=function(t){e.setState({city_selected:null,operator_selected:null}),setTimeout((function(){return e.setState({city_selected:t})}),0)},e.handleOperatorChange=function(t){var a=e.state.city_selected,n=e.state.operator_selected;e.setState({city_selected:null,operator_selected:null}),setTimeout((function(){n&&t.value===n.value?e.setState({city_selected:a,operator_selected:null}):e.setState({city_selected:a,operator_selected:t})}),0)},e}return Object(b.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){var e=Object(h.a)(p.a.mark((function e(){var t,a,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"query{cities{ _id name longitude latitude operators { _id operatorId company } }}",e.prev=1,e.next=4,L("query{cities{ _id name longitude latitude operators { _id operatorId company } }}",this.controller.signal);case 4:t=e.sent,a=(a=(a=t.cities).filter((function(e){return e.operators.length>0}))).map((function(e){return Object(C.a)(Object(C.a)({},e),{},{label:e.name,value:e._id,operators:e.operators.map((function(e){var t=e.company?e.company:e.operatorId;return Object(C.a)(Object(C.a)({},e),{},{label:t,value:e._id})}))})})),n=a.map((function(e){return e.label})).indexOf("Helsinki"),this.setState({cities:a,city_selected:a.length>0?-1!==n?a[n]:a[0]:null}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),"AbortError"!==e.t0.name&&console.log("Fetch failed: ",e.t0.toString());case 15:case"end":return e.stop()}}),e,this,[[1,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.context.role,t=this.props.t;return r.a.createElement(r.a.Fragment,null,r.a.createElement(w.a,{className:"m-b-10"},r.a.createElement(w.a.Body,null,r.a.createElement("h4",{className:"mt-0 mb-3 header-title"},t("db.general.map.title")),r.a.createElement(N.a,{className:"mb-1"},r.a.createElement(_.a,{sm:6},r.a.createElement("div",{className:"m-auto"},r.a.createElement(_.a,{className:"mb-2",style:{zIndex:1004}},r.a.createElement(Ye.a,{value:this.state.city_selected,onChange:this.handleCityChange,options:this.state.cities,required:!0})),this.state.city_selected&&this.state.city_selected.operators.length>1&&r.a.createElement(_.a,{style:{zIndex:1001}},r.a.createElement(Ye.a,{value:this.state.operator_selected,onChange:this.handleOperatorChange,options:this.state.city_selected.operators})))),r.a.createElement(_.a,{sm:6},r.a.createElement("div",{className:"mb-2"},r.a.createElement("img",{src:na.a,alt:"blue"})," ",t("map.marker.blue")),r.a.createElement("div",{className:"mb-2"},r.a.createElement("img",{src:ia.a,alt:"green"})," ",t("map.marker.green")),r.a.createElement("div",{className:"mb-2"},r.a.createElement("img",{src:ca.a,alt:"orange"})," ",t("map.marker.orange")),[5,11].includes(e)&&r.a.createElement("div",{className:"mb-2"},r.a.createElement("img",{src:sa.a,alt:"blue"})," ",t("map.marker.gray")))),r.a.createElement("div",{style:{minHeight:350}},null!==this.state.city_selected&&r.a.createElement(Be,{data:this.getMapData()})))))}}]),a}(n.Component);ma.contextType=A;var ua=Object(s.b)()(ma),da=function(){var e=Object(n.useContext)(A);return r.a.createElement("div",{className:"container-fluid"},5===e.role&&r.a.createElement(N.a,null,r.a.createElement(_.a,{sm:6,xl:3},r.a.createElement(Zt,null)),r.a.createElement(_.a,{sm:6,xl:3},r.a.createElement(Qt,null)),r.a.createElement(_.a,{sm:6,xl:3},r.a.createElement(Kt,null)),r.a.createElement(_.a,{sm:6,xl:3},r.a.createElement($t,null))),r.a.createElement(N.a,null,r.a.createElement(_.a,{xl:8},r.a.createElement(ua,null)),r.a.createElement(_.a,{md:12,xl:4},r.a.createElement(N.a,null,r.a.createElement(ea,null),r.a.createElement(ta,null)))))},pa=function(){return r.a.createElement("div",{className:"container-fluid"},r.a.createElement(ua,null))},ha={general:{roles:[],path:"/general",component:function(){return 1===Object(n.useContext)(A).role?r.a.createElement(pa,null):r.a.createElement(da,null)},nav:!0,icon:"mdi-chart-pie"},users:{roles:[5,11],path:"/users",component:gt,nav:!0,icon:"ion-android-social"},clients:{roles:[3,5,11],path:"/clients",component:re,nav:!0,icon:"ion-briefcase"},campaigns:{roles:[3,5,11],path:"/campaigns",component:lt,nav:!0,icon:"mdi-calendar"},campaign:{roles:[3,5,11],path:"/campaign/:id",component:Ge},sales:{roles:[5,11],path:"/sales",component:le,nav:!0,icon:"mdi-briefcase-check"},operators:{roles:[5,11],path:"/operators",component:kt,nav:!0,icon:"mdi-bus"},vehicles:{roles:[5,11],path:"/fleet",component:Gt,nav:!0,icon:"mdi-bus"},vehicle:{roles:[5,11],path:"/vehicle/:id",component:Wt},teams:{roles:[1,5,11],path:"/teams",component:jt,nav:!0,icon:"fa fa-cogs"},team:{roles:[1,5,11],path:"/team/:id",component:Tt},assignments:{roles:[1,5,11],path:"/assignments",component:z,nav:!0,icon:"fa fa-check"},assign:{roles:[1,5,11],path:"/assign/:id",component:P},mails:{roles:[5,11],path:"/mails",component:pt,nav:!1,icon:"mdi-email"},settings:{roles:[],path:"/settings",component:ie,nav:!1,icon:"mdi-settings"},placements:{roles:[3,5,11],path:"/ads",component:X,nav:!0,icon:"mdi-animation"}},fa=function(e,t){return!e.roles.length||e.roles.includes(t)},ba=function(e){var t=e.to,a=void 0===t?"":t,c=e.className,l=void 0===c?"":c,i=e.react,o=void 0===i||i,s=e.id,m=void 0===s?"":s,u=e.children,d=Object(n.useContext)(A),p=Object(C.a)({},ha[a]);return Object.keys(p).length&&fa(p,d.role)?(p.path="/dashboard"+p.path,p.path.includes(":id")&&(p.path=p.path.replace(":id",m)),o?r.a.createElement(j.b,{to:p.path,className:l},u):r.a.createElement("a",{href:p.path,className:l},u)):r.a.createElement("a",{className:l},u)},ga=a(93),va=a.n(ga),Ea=function(e){return r.a.createElement("li",null,r.a.createElement(ba,{to:e.data.to,className:"waves-effect"},r.a.createElement("i",{className:"mdi "+e.data.icon}),r.a.createElement("span",null,e.data.name)))},ya=Object(s.b)()((function(e){var t,a=e.t,c=Object(n.useContext)(A);return r.a.createElement("div",{className:"left side-menu",style:{zIndex:1005}},r.a.createElement("div",{className:"topbar-left"},r.a.createElement("a",{className:"logo",href:"/dashboard"},r.a.createElement("img",{src:va.a,height:"50",alt:"logo"}))),r.a.createElement("div",{className:"sidebar-inner slimscrollleft"},r.a.createElement("div",{id:"sidebar-menu"},r.a.createElement("ul",null,r.a.createElement("li",{className:"menu-title"}),(t=c.role,Object.entries(ha).filter((function(e){var a=Object(O.a)(e,2)[1];return a.nav&&fa(a,t)})).map((function(e){var t=Object(O.a)(e,2),a=t[0],n=t[1],r=Object(C.a)({},n);return r.name=a,r.translation="db.navbar."+a,r}))).map((function(e){return r.a.createElement(Ea,{key:e.path,data:{name:a(e.translation),badge:"",icon:e.icon,to:e.name}})}))))))})),wa={0:"#355fa7",1:"#4ac18e",3:"#ffbb44",5:"#ea553d",11:"#ea553d"};function xa(e,t){var a,n,r=e&&e.trim();if(e&&0!==r.length)if(1===r.length)a=r[0];else if(r.split(" ").length>1){var c=r.split(" ");a=c[0][0],n=c[c.length-1][0]}else a=r[0],n=r[1];else a="-";var l=document.createElement("canvas");l.style.display="none",l.width=32,l.height=32,document.body.appendChild(l);var i=l.getContext("2d");i.fillStyle=wa[t],i.fillRect(0,0,l.width,l.height),i.font="18px Cousine, monospace",i.fillStyle="#fff";var o=n?a+n:a;i.fillText(o.toUpperCase(),n?5:10,22);var s=l.toDataURL();return document.body.removeChild(l),s}var ka=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={title:e.props.t("dashboard"),lang_toggle:!1,user_toggle:!1},e.togglescreen=function(e){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement?document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen&&document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)},e}return Object(b.a)(a,[{key:"componentDidMount",value:function(){this.context.role&&this.setState({title:"".concat(st(this.context.role,this.props.t)," ").concat(this.props.t("dashboard").toLowerCase())})}},{key:"handleLogout",value:function(e){e.preventDefault(),this.context.logout()}},{key:"render",value:function(){var e=this,t=this.props,a=t.t,n=t.i18n;return r.a.createElement("div",{className:"topbar",style:{zIndex:1010}},r.a.createElement("nav",{className:"navbar-custom"},r.a.createElement("ul",{className:"list-inline float-right mb-0"},r.a.createElement("li",{className:"list-inline-item dropdown notification-list hidden-xs-down"},r.a.createElement("span",{className:"nav-link waves-effect",onClick:this.togglescreen},r.a.createElement("i",{className:"mdi mdi-fullscreen noti-icon"}))),r.a.createElement("li",{onClick:function(){return e.setState({lang_toggle:!e.state.lang_toggle})},className:"list-inline-item dropdown notification-list hidden-xs-down"+(this.state.lang_toggle?" show":"")},r.a.createElement("span",{className:"nav-link dropdown-toggle arrow-none waves-effect text-muted","data-toggle":"dropdown"},n.language.toUpperCase()),r.a.createElement("div",{className:"dropdown-menu dropdown-menu-right language-switch",style:{minWidth:"5rem"}},n.validLangs.map((function(e){var t=e.short,a=e.name;return r.a.createElement("span",{className:"dropdown-item",key:t,style:{cursor:"pointer"}},r.a.createElement("span",{onClick:function(){return n.changeLanguage(t)}},a))})))),r.a.createElement("li",{onClick:function(){return e.setState({user_toggle:!e.state.user_toggle})},className:"list-inline-item dropdown notification-list"+(this.state.user_toggle?" show":"")},r.a.createElement("span",{className:"nav-link dropdown-toggle arrow-none waves-effect nav-user","data-toggle":"dropdown"},r.a.createElement("img",{src:xa(this.context.name,this.context.role),alt:"usr",className:"init-logo"})),r.a.createElement("div",{className:"dropdown-menu dropdown-menu-right profile-dropdown"},r.a.createElement("span",{className:"dropdown-item"},r.a.createElement("i",{className:"dripicons-user text-muted"}),a("toolbar.profile")),r.a.createElement("div",{className:"dropdown-divider"}),r.a.createElement("span",{className:"dropdown-item",onClick:function(t){return e.handleLogout(t)}},r.a.createElement("i",{className:"dripicons-exit text-muted"}),a("toolbar.logout"))))),r.a.createElement("ul",{className:"list-inline menu-left mb-0"},r.a.createElement("li",{className:"list-inline-item"},r.a.createElement("button",{type:"button",className:"button-menu-mobile open-left waves-effect",onClick:this.props.doNavbarDisplay},r.a.createElement("i",{className:"ion-navicon"}))),r.a.createElement("li",{className:"hide-phone list-inline-item app-search"},r.a.createElement("h3",{className:"page-title text-capitalize"},this.state.title)))))}}]),a}(n.Component);ka.contextType=A,ka.imgUrl="https://picsum.photos/100";var Aa=Object(s.b)()(ka),Oa=a(190),Ca=a.n(Oa),ja=function(e){var t=e.title;return r.a.createElement(Ca.a,null,r.a.createElement("title",null,t||"App"))},Sa=function(e){var t=e.component,a=e.title;return function(e){Object(g.a)(c,e);var n=Object(v.a)(c);function c(){return Object(f.a)(this,c),n.apply(this,arguments)}return Object(b.a)(c,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(ja,{title:a}),r.a.createElement(t,this.props))}}]),c}(n.Component)},Na=function(){return document.getElementById("wrapper").classList.toggle("enlarged")},_a=Object(s.b)()((function(e){var t,a=e.t,c=Object(n.useContext)(A);return r.a.createElement("div",{id:"wrapper"},r.a.createElement(ya,null),r.a.createElement("div",{className:"content-page"},r.a.createElement("div",{className:"content"},r.a.createElement(Aa,{doNavbarDisplay:Na}),r.a.createElement("div",{className:"page-content-wrapper"},r.a.createElement(k.d,null,(t=c.role,Object.entries(ha).filter((function(e){var a=Object(O.a)(e,2)[1];return fa(a,t)})).map((function(e){var t=Object(O.a)(e,2),a=t[0],n=t[1],r=Object(C.a)({},n);return r.path="/dashboard"+n.path,r.translation="db.navbar."+a,r}))).map((function(e){return r.a.createElement(k.b,{key:e.path,path:e.path,component:Sa({component:e.component,title:a(e.translation)})})})),r.a.createElement(k.b,{path:"/dashboard/:sth",render:function(){return r.a.createElement(k.a,{to:"/dashboard/general"})}}),r.a.createElement(k.b,{path:"/dashboard/",render:function(){return r.a.createElement(k.a,{to:"/dashboard/general"})}})))),r.a.createElement("footer",{className:"footer"},"\xa9 ",a("company.name"))))})),Da=a(35),Ia=a(95),Ta=a(156),Ba=a(96),Ra=(a(298),function(){var e=Object(h.a)(p.a.mark((function e(t,a,n){var r,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r='mutation{ pictureDelete(id:"'.concat(t,'")}'),e.prev=1,e.next=4,L(r);case 4:c=e.sent,c.pictureDelete?(ee.a.fire({icon:"success",title:n("i.image.remove.form.success.title"),showConfirmButton:!1,timer:1500}),a()):ee.a.fire({icon:"error",title:n("i.image.remove.form.failed.title"),text:n("i.image.remove.form.failed.text"),showConfirmButton:!1,timer:1500}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,a,n){return e.apply(this,arguments)}}()),La=Object(s.b)()((function(e){var t=e.t,a=e.data,n=e.me,c=e.reload,l=e.openLB,i=a.path.split("/");return r.a.createElement(N.a,{className:"pt-2 pb-2 border-bottom border-top font-xs"},r.a.createElement(_.a,{onClick:l},r.a.createElement("img",{src:a.thumbnail||a.path,alt:"i",style:{maxHeight:60,maxWidth:73}})),r.a.createElement(_.a,{className:"align-self-center"},i[i.length-1]),a.user_id===n&&r.a.createElement(_.a,{className:"align-self-center"},r.a.createElement(T.a,{className:"images",variant:"danger",onClick:function(){return Ra(a.id,c,t)}},t("i.image.list.remove"))))})),Fa=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={images:[],index:0,lightbox:!1},e.controller=new AbortController,e.loadImages=Object(h.a)(p.a.mark((function t(){var a,n,r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a='query{campaignPictures(_id:"'.concat(e.props.id,'"){ id path thumbnail user_id }}'),t.prev=1,t.next=4,L(a,e.controller.signal);case 4:n=t.sent,r=n.campaignPictures,e.setState({images:r}),t.next=11;break;case 9:t.prev=9,t.t0=t.catch(1);case 11:case"end":return t.stop()}}),t,null,[[1,9]])}))),e.openLightbox=function(t){e.setState({lightbox:!0,index:t})},e}return Object(b.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){this.loadImages()}},{key:"render",value:function(){var e=this,t=this.props.t,a=this.state,n=a.images,c=a.index;return r.a.createElement(Ba.a,{centered:!0,scrollable:!0,onHide:this.props.handleClose,keyboard:!1,animation:!0,show:!0,className:"text-center"},r.a.createElement(Ba.a.Header,{style:{display:"unset",borderBottom:"unset"}},r.a.createElement(Ba.a.Title,null,t("i.image.campaign.title"))),r.a.createElement(Ba.a.Body,null,n.length>0&&r.a.createElement(r.a.Fragment,null,n.map((function(t,a){return r.a.createElement(La,{key:t.path,openLB:function(){return e.openLightbox(a)},data:t,me:e.context._id,reload:e.loadImages})}))),0===n.length&&r.a.createElement("h5",null,t("i.image.list.empty")),n.length>0&&this.state.lightbox&&r.a.createElement(pe.a,{mainSrc:n[c].path,nextSrc:n[(c+1)%n.length].path,prevSrc:n[(c+n.length-1)%n.length].path,onCloseRequest:function(){return e.setState({lightbox:!1})},onMovePrevRequest:function(){return e.setState({index:(c+n.length-1)%n.length})},onMoveNextRequest:function(){return e.setState({index:(c+1)%n.length})}})),r.a.createElement(Ba.a.Footer,{style:{display:"unset",borderTop:"unset"}},r.a.createElement(T.a,{className:"w-sm",variant:"success",onClick:this.props.handleClose},t("i.image.list.close"))))}}]),a}(n.Component);Fa.contextType=A;var Ma=Object(s.b)()(Fa),Ua=function(){var e=Object(h.a)(p.a.mark((function e(t,a,n){var r,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:sessionStorage.getItem("_t")?r=sessionStorage.getItem("_t"):localStorage.getItem("_t")&&(r=localStorage.getItem("_t")),(c=new FormData).append("campaign_id",a),c.append("img",n),ee.a.fire({title:"Uploading image...",text:"Please wait",timerProgressBar:!0,onBeforeOpen:function(){var e=Object(h.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ee.a.showLoading(),e.t0=ee.a,e.next=4,fetch("/api/upload/picture",{method:"POST",body:c,headers:{Authorization:r?"Bearer ".concat(r):""}});case 4:e.t1=e.sent,e.t0.close.call(e.t0,e.t1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}).then((function(e){200===e.status?ee.a.fire({icon:"success",title:t("i.image.uploading.success.title"),text:t("i.image.uploading.success.text"),showConfirmButton:!1,timer:1500}):ee.a.fire({icon:"error",title:t("i.image.uploading.failed.title"),text:t("i.image.uploading.failed.text"),showConfirmButton:!1,timer:1500})}));case 5:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),qa=Object(s.b)()((function(e){var t=e.t,a=(e.mt,e.onSubmit),n=e.value,c=e.onChange,l=e.placeholder,i=e.trigger;return r.a.createElement(Ia.a,{fixed:"top",className:"pl-1 pr-1 pb-0 navbar-container"},r.a.createElement(Da.a,null,r.a.createElement(N.a,{className:"pl-1 pr-2"},r.a.createElement(_.a,null,r.a.createElement("form",{onSubmit:a},r.a.createElement(B.a,null,r.a.createElement(R.a,{placeholder:t(l),value:n,onChange:c}),r.a.createElement(B.a.Append,null,r.a.createElement(T.a,{variant:"outline-secondary",type:"submit"},r.a.createElement("i",{className:"fa fa-search"})))))),r.a.createElement(_.a,{xs:3},i&&r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{type:"checkbox",id:"h",switch:i.type,checked:i.value,onChange:i.click}),r.a.createElement("label",{htmlFor:"h","data-on-label":t(i.on),"data-off-label":t(i.off),style:{marginTop:7,marginBottom:0}}))))))})),Pa=Object(s.b)()((function(e){var t,a=e.t,c=e.onSubmit,l=(e.mt,e.placeholder),i=e.value,o=e.onChange,s=e.campaign,m=s.name,u=new Date(parseInt(s.startDate)),d=new Date(parseInt(s.endDate)),p=s.placements.map((function(e){return e.count})).reduce((function(e,t){return e+t}),0),h=s.placements.map((function(e){return e.installs.map((function(e){return e.count})).reduce((function(e,t){return e+t}),0)})).reduce((function(e,t){return e+t}),0),f=Object(n.useState)(!1),b=Object(O.a)(f,2),g=b[0],v=b[1];return r.a.createElement(Ia.a,{fixed:"top",className:"pl-1 pr-1 navbar-container"},r.a.createElement(Da.a,{className:"text-center text-white",style:{lineHeight:.9}},!!c&&r.a.createElement(N.a,{className:"pl-1 pr-2"},r.a.createElement(_.a,null,r.a.createElement("form",{onSubmit:c},r.a.createElement(B.a,null,r.a.createElement(R.a,{placeholder:a(l),value:i,onChange:o}),r.a.createElement(B.a.Append,null,r.a.createElement(T.a,{variant:"outline-secondary",type:"submit"},r.a.createElement("i",{className:"fa fa-search"}))))))),r.a.createElement("h5",{className:"m-0 mb-1"},m),r.a.createElement(N.a,null,r.a.createElement(_.a,null,r.a.createElement(N.a,null,r.a.createElement(_.a,null,r.a.createElement("strong",null,u.getDate()," ",a("month."+u.getMonth())),r.a.createElement("div",{className:"description"},a("i.campaign.startDate"))),r.a.createElement(_.a,null,r.a.createElement("strong",null,d.getDate()," ",a("month."+d.getMonth())),r.a.createElement("div",{className:"description"},a("i.campaign.endDate"))))),r.a.createElement(_.a,null,r.a.createElement("strong",null,h,"/",p),r.a.createElement("div",{className:"description"},a("i.campaign.placements")))),r.a.createElement(fe.a,{className:"campaign-progress",variant:"warning",now:100*h/p}),r.a.createElement(N.a,{className:"campaign-images mt-2"},r.a.createElement(_.a,{onClick:function(){return v(!0)}},r.a.createElement("i",{className:"fa fa-th-list"})),r.a.createElement(_.a,null,r.a.createElement("i",{className:"ion ion-images",onClick:function(){return t.click()}}),r.a.createElement("input",{hidden:!0,type:"file",name:"file",ref:function(e){return t=e},onChange:function(e){return Ua(a,s._id,e.target.files[0])}})))),g&&r.a.createElement(Ma,{id:s._id,handleClose:function(){return v(!1)}}))})),Va=Object(s.b)()((function(e){var t=e.t,a=e.i18n,c=e.placeholder,l=e.onSubmit,i=e.onChange,o=e.value,s=Object(n.useContext)(A);return r.a.createElement(Ia.a,{fixed:"top",style:{justifyContent:"space-between"}},r.a.createElement(Ta.a,{title:a.language.toUpperCase(),className:"lang",id:"install-navbar"},a.validLangs.map((function(e){var t=e.short,n=e.name;return r.a.createElement(Ta.a.Item,{key:t,onClick:function(){return a.changeLanguage(t)}},n)}))),r.a.createElement("form",{onSubmit:l,style:{maxWidth:"150px"}},r.a.createElement(B.a,{className:"p-1"},r.a.createElement(R.a,{placeholder:t(c),value:o,onChange:i}),r.a.createElement(B.a.Append,null,r.a.createElement(T.a,{variant:"outline-secondary",type:"submit"},r.a.createElement("i",{className:"fa fa-search"}))))),r.a.createElement(T.a,{variant:"primary",onClick:s.logout},r.a.createElement("i",{className:"dripicons-exit"})," Logout"))}));var Wa=Object(s.b)()((function(e){var t=e.campaign,a=e.t,n=t.name,c=t.client.company,l=new Date(parseInt(t.startDate)),i=new Date(parseInt(t.endDate)),o=t.placements.map((function(e){return e.count})).reduce((function(e,t){return e+t}),0),s=t.placements.map((function(e){return e.installs.map((function(e){return e.count})).reduce((function(e,t){return e+t}),0)})).reduce((function(e,t){return e+t}),0),m=function(e,t){return 100*t/e}(o,s);return r.a.createElement(j.a,{to:"/install/c/"+t._id,style:{color:"black"}},r.a.createElement(w.a,{className:"mb-3 mt-2 shadow",style:{border:"none"}},r.a.createElement(w.a.Body,{className:"waves-effect p-3"},r.a.createElement(w.a.Title,{className:"text-center text-vehicle-info ".concat(t.priority&&"text-danger")},n),r.a.createElement("div",{className:"text-center font-sm"},c),r.a.createElement(N.a,{className:"text-center font-sm"},r.a.createElement(_.a,null,r.a.createElement(N.a,null,r.a.createElement(_.a,{className:"install-col-val"},r.a.createElement("strong",null,l.getDate()," ",a("month."+l.getMonth())),r.a.createElement("div",{className:"description"},a("i.campaign.startDate"))),r.a.createElement(_.a,{className:"install-col-val"},r.a.createElement("strong",null,i.getDate()," ",a("month."+i.getMonth())),r.a.createElement("div",{className:"description"},a("i.campaign.endDate"))))),r.a.createElement(_.a,{className:"install-col-val"},r.a.createElement("strong",null,s,"/",o),r.a.createElement("div",{className:"description"},a("i.campaign.placements"))))),r.a.createElement(fe.a,{className:"card-bottom-progress",striped:!0,variant:m>=100?"success":"warning",now:m,label:!0})))})),Ha=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={search:"",campaigns:[]},e.controller=new AbortController,e.searchTimeout=0,e.loadInCampaigns=Object(h.a)(p.a.mark((function t(){var a,n,r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a='query{ campaignsForInstallers(search:"'.concat(e.state.search,'"){ _id name client{company} priority startDate endDate placements { count installs { count }} }}'),t.prev=1,t.next=4,L(a,e.controller.signal);case 4:n=t.sent,(r=n.campaignsForInstallers)&&e.setState({campaigns:r}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),console.log("error",t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])}))),e.handleSearchChange=function(t){e.setState({search:t.target.value}),clearTimeout(e.searchTimeout),e.searchTimeout=setTimeout(e.loadInCampaigns,600)},e.handleSearchSubmit=function(t){t.preventDefault(),e.loadInCampaigns()},e}return Object(b.a)(a,[{key:"componentDidMount",value:function(){this.loadInCampaigns()}},{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Va,{onSubmit:this.handleSearchSubmit,placeholder:"i.search.campaign",onChange:this.handleSearchChange,value:this.state.search}),r.a.createElement(Da.a,{style:{marginTop:65}},r.a.createElement(N.a,{className:"border-bottom",style:{display:"block"}},r.a.createElement("h4",{className:"text-center text-white"},this.props.t("i.campaigns.title"))),this.state.campaigns.length>0&&this.state.campaigns.map((function(e){return r.a.createElement(Wa,{key:e._id,campaign:e})}))))}}]),a}(n.Component),Ga=Object(s.b)()(Ha),za=Object(s.b)()((function(e){var t=e.t,a=e.data;return r.a.createElement(j.a,{to:"/install/f/".concat(a._id),style:{color:"black"}},r.a.createElement(w.a,{className:"mb-3 mt-2 shadow",style:{border:"none"}},r.a.createElement(w.a.Body,{className:"waves-effect pb-2"},r.a.createElement(N.a,{className:"text-center"},r.a.createElement(_.a,{xs:3,className:"m-auto"},r.a.createElement("img",{src:Object(oe.vehTypeObject)(a._id).img,alt:Object(oe.vehTypeObject)(a._id).name,height:"60"})),r.a.createElement(_.a,{xs:9,className:"m-auto install-col-val",style:{lineHeight:"1.1rem"}},r.a.createElement("strong",null,Object(oe.vehID)(a._id),!a.listed&&r.a.createElement(he.a,{variant:"warning"},t("i.vehicle.unlisted"))),r.a.createElement("div",{className:"description"},a.operator.company),r.a.createElement("h4",null,a.installs.map((function(e){return e.count})).reduce((function(e,t){return e+t}),0),"x ",t("i.vehicle.placements"))))),r.a.createElement(fe.a,{className:"card-bottom-progress",variant:"success",now:100,style:{borderRadius:0}})))})),Qa=Object(s.b)()((function(e){var t=e.t,a=e.data,n=a.activityType===Ut.NEW,c=n?"green":"red",l=new Date(parseInt(a.created_at)),i=n?a.install:a.remove;return r.a.createElement(w.a,{className:"mb-3 mt-2 shadow",style:{border:"none"}},r.a.createElement(j.a,{to:"/install/c/".concat(a.campaign._id,"/").concat(a.vehicle._id,"/").concat(a.placement._id),style:{display:"flex",color:"black"}},r.a.createElement("div",{className:"vertical-text-wrapper",style:{backgroundColor:c}},r.a.createElement("div",{className:"vertical-text"},n?"INSTALLED":"REMOVED")),r.a.createElement(w.a.Body,{className:"waves-effect p-2 pb-1"},r.a.createElement(N.a,{className:"text-center"},r.a.createElement(_.a,{xs:3,className:"m-auto"},r.a.createElement("div",null,r.a.createElement("img",{src:Object(oe.vehTypeObject)(a.vehicle._id).img,alt:Object(oe.vehTypeObject)(a.vehicle._id).name,height:"55"})),r.a.createElement("div",{style:{fontSize:"1rem"}},r.a.createElement("strong",null,Object(oe.vehID)(a.vehicle._id))),!a.vehicle.listed&&r.a.createElement(he.a,{variant:"warning"},t("i.vehicle.unlisted"))),r.a.createElement(_.a,{xs:9,className:"m-auto install-col-val"},r.a.createElement("div",null,a.user.name),r.a.createElement("h4",null,i.count,"x ",a.placement.place.name),r.a.createElement("div",{className:"description"},a.campaign.name),r.a.createElement("div",{className:"float-right description"},l.getDate().toString().padStart(2,"0"),".",(l.getMonth()+1).toString().padStart(2,"0"),".",l.getFullYear()))))),a.vehicle.haveAds&&r.a.createElement(fe.a,{className:"card-bottom-progress",variant:"success",now:100}))})),Ya=Object(s.b)()((function(e){var t=e.t,a=e.path,n=e.doVehicleSelect,c=e.data;return r.a.createElement(j.a,{to:a,onClick:function(){return n(c)},style:{color:"black"}},r.a.createElement(w.a,{className:"mb-3 mt-2 shadow",style:{border:"none"}},r.a.createElement(w.a.Body,{className:"waves-effect pb-2 pt-2"},r.a.createElement(N.a,{className:"text-center font-sm"},r.a.createElement(_.a,null,r.a.createElement(N.a,null,r.a.createElement(_.a,{xs:5,className:"m-auto",style:{padding:0}},r.a.createElement("img",{src:Object(oe.vehTypeObject)(c._id).img,alt:Object(oe.vehTypeObject)(c._id).name,height:"60"})),r.a.createElement(_.a,{xs:7,className:"install-col-val",style:{padding:0}},r.a.createElement("strong",null,Object(oe.vehID)(c._id),!c.listed&&r.a.createElement(he.a,{variant:"warning"},t("i.vehicle.unlisted"))),r.a.createElement("div",null,c.operator.company)))),r.a.createElement(_.a,{className:"m-auto install-col-val",style:{padding:0}},r.a.createElement("strong",null,c.totalAds),r.a.createElement("div",{className:"description"},t("i.vehicle.placements"))))),!!c.totalAds&&r.a.createElement(fe.a,{className:"card-bottom-progress",variant:"success",now:100})))})),Za=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).controller=new AbortController,n.searchTimeout=0,n.installsLoadIn=Object(h.a)(p.a.mark((function e(){var t,a,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t='query{ history(search:"'.concat(n.state.search,'", skip:').concat(n.state.history.length,", all:").concat(n.state.me?"false":"true","){ \n        id user{name}\n        vehicle{_id haveAds listed}\n        campaign{_id name}\n        placement{_id place{name}}\n        install{count}\n        remove{count}\n        activityType created_at }}"),e.prev=1,e.next=4,L(t,n.controller.signal);case 4:a=e.sent,(r=a.history)&&n.setState({history:r}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])}))),n.handleSearchChange=function(e){n.setState({search:e.target.value,history:[]}),clearTimeout(n.searchTimeout),n.searchTimeout=setTimeout(n.installsLoadIn,600)},n.handleSearchSubmit=function(e){e.preventDefault()},n.handleSwitchTrigger=function(){n.setState({me:!n.state.me,history:[]}),setTimeout(n.installsLoadIn,10)},n.scrolling=function(e,t){},n.state={search:"",history:[],loading:!0,me:!0},n}return Object(b.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort(),clearTimeout(this.searchTimeout)}},{key:"componentDidMount",value:function(){this.installsLoadIn()}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(qa,{value:this.state.search,onChange:this.handleSearchChange,placeholder:"i.search.vehicle",onSubmit:this.handleSearchSubmit,trigger:{value:this.state.me,on:"i.switch.me",off:"i.switch.all",type:"none",click:this.handleSwitchTrigger}}),r.a.createElement(Da.a,{style:{marginTop:65}},r.a.createElement(N.a,{className:"border-bottom",style:{display:"block"}},r.a.createElement("h4",{className:"text-center text-white"},this.props.t("i.history.title"))),r.a.createElement("div",null,this.state.history.length>0&&this.state.history.map((function(e){return r.a.createElement(Qa,{key:e.id,data:e})})))))}}]),a}(n.Component),Ja=Object(s.b)()(Za),Ka=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={inUse:!1,search:"",vehicles:[]},e.searchTimeout=0,e.controller=new AbortController,e.handleSwitchTrigger=function(){e.setState({inUse:!e.state.inUse}),setTimeout(e.handleLoadIn,10)},e.handleSearch=function(){var t=Object(h.a)(p.a.mark((function t(a){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setState({search:a.target.value}),clearTimeout(e.searchTimeout),e.searchTimeout=setTimeout(e.handleLoadIn,600);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleLoadIn=function(){e.state.search?e.loadAll():e.loadCampaign()},e.loadCampaign=Object(h.a)(p.a.mark((function t(){var a,n,r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a='query{campaignVehiclesForInstallers(_id: "'.concat(e.props.campaign._id,'", search:"').concat(e.state.search,'", skip:0){_id listed operator{company} totalAds}}'),t.prev=1,t.next=4,L(a,e.controller.signal);case 4:n=t.sent,(r=n.campaignVehiclesForInstallers)&&(e.setState({vehicles:r}),console.log(r)),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),console.log("error",t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])}))),e.loadAll=Object(h.a)(p.a.mark((function t(){var a,n,r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a='query{vehiclesForInstallers(search:"'.concat(e.state.search,'", skip:0){_id listed operator{company} totalAds}}'),t.prev=1,t.next=4,L(a,e.controller.signal);case 4:n=t.sent,(r=n.vehiclesForInstallers)&&e.setState({vehicles:r}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),console.log("error",t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])}))),e.handleSearchSubmit=function(t){t.preventDefault(),e.handleLoadIn()},e}return Object(b.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort(),clearTimeout(this.searchTimeout)}},{key:"componentDidMount",value:function(){this.handleLoadIn()}},{key:"render",value:function(){var e=this,t=this.props.t;return r.a.createElement(Da.a,{style:{marginTop:170}},r.a.createElement(Pa,{value:this.state.search,onSubmit:this.handleSearchSubmit,placeholder:"i.search.vehicle",onChange:this.handleSearch,campaign:this.props.campaign,goBack:this.props.history.goBack}),this.state.vehicles.map((function(t){return r.a.createElement(Ya,{key:t._id,doVehicleSelect:e.props.doVehicleSelect,path:"".concat(e.props.path,"/").concat(t._id),data:t})})),0===this.state.vehicles.length&&r.a.createElement("h3",{className:"pt-2 text-white text-center"},t("i.campaign.fleet.empty")))}}]),a}(n.Component),Xa=Object(s.b)()(Ka),$a=function(e){var t,a={},n=Object(S.a)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;a[r.placement._id]?a[r.placement._id].count+=r.count:a[r.placement._id]=r}}catch(c){n.e(c)}finally{n.f()}return Object.values(a)},en=function(e,t,a,n){var r='mutation{removeAd(vehicle:"'.concat(e,'",placement:"').concat(t,'")}');ee.a.fire({title:a("i.remove.form.confirm.title"),text:a("i.remove.form.confirm.text"),icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:a("i.remove.form.confirm.yes")}).then((function(e){e.value&&tn(r,a,n)}))},tn=function(){var e=Object(h.a)(p.a.mark((function e(t,a,n){var r,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,L(t);case 3:r=e.sent,(c=r.removeAd)?(n&&n(),ee.a.fire({title:"Removed!",text:"".concat(c," ").concat(a("i.remove.form.success.text")),icon:"success",timer:1500,showConfirmButton:!1})):ee.a.fire({icon:"error",title:a("i.remove.form.invalid.unk.title"),text:a("i.remove.form.invalid.unk.text"),showConfirmButton:!1,timer:2500}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),"AbortError"!==e.t0.name&&(ee.a.fire({icon:"error",title:a("i.remove.form.invalid.request.title"),text:a("i.remove.form.invalid.request.text"),showConfirmButton:!1,timer:1500}),console.log("Fetch failed: ",e.t0.toString()));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a,n){return e.apply(this,arguments)}}(),an=a(82),nn=Object(s.b)()((function(e){var t=e.t,a=e.data,n=e.doRemove,c=e.displayCampaign;return r.a.createElement(N.a,{className:"text-center p-2 pt-3 pb-3 shadow mt-2"},r.a.createElement(_.a,{xs:8,className:"m-auto"},r.a.createElement("strong",null,a.count,"x ",a.placement.place.name),!!c&&r.a.createElement("div",{className:"description"},a.campaign.name)),r.a.createElement(_.a,{xs:4,className:"m-auto",style:{padding:0}},r.a.createElement(T.a,{onClick:n,variant:"danger",className:"waves-effect",style:{fontSize:"0.9rem"}},t("i.remove.form.button.label"))))})),rn=function(e){return r.a.createElement(nn,Object.assign({},e,{displayCampaign:!0}))},cn=function(e){ee.a.fire({icon:"success",title:e("i.install.form.successful.title"),showConfirmButton:!1,timer:1500})},ln=function(e){ee.a.fire({icon:"error",title:e("i.install.form.invalid.unk.title"),showConfirmButton:!1,timer:1500})},on=function(e){ee.a.fire({icon:"error",title:e("i.install.form.invalid.request.title"),showConfirmButton:!1,timer:1500})},sn=function(e){ee.a.fire({icon:"error",title:e("i.install.form.invalid.amount.title"),text:e("i.install.form.invalid.amount.text"),showConfirmButton:!1,timer:1800})},mn=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={alert:!0,installs:[],showOthers:!1,count:""},e.controller=new AbortController,e.handlePlacementsLoad=Object(h.a)(p.a.mark((function t(){var a,n,r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a='query{ vehicleInstalls(_id:"'.concat(e.props.vehicle._id,'"){ id count campaign{ _id name } count placement{_id place{name}}}}'),t.prev=1,t.next=4,L(a,e.controller.signal);case 4:n=t.sent,(r=n.vehicleInstalls)&&e.setState({installs:$a(r)}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),console.log("error",t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])}))),e.handleInstall=function(){var t=Object(h.a)(p.a.mark((function t(a){var n,r,c;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(a<=0)){t.next=2;break}return t.abrupt("return");case 2:if(n=e.props.placement.installs.filter((function(e){return e.installed})).map((function(e){return e.count})).reduce((function(e,t){return e+t}),0),!(a+n>e.props.placement.count)){t.next=6;break}return sn(e.props.t),t.abrupt("return");case 6:return r='mutation{ installAd(vehicle:"'.concat(e.props.vehicle._id,'", placement:"').concat(e.props.placement._id,'", count:').concat(a,")}"),t.prev=7,t.next=10,L(r,e.controller.signal);case 10:c=t.sent,c.installAd?(e.props.doCampReload().then((function(){e.props.doPlacementLoad(e.props.match.params.placement)})),e.props.doVehicleReload(),e.handlePlacementsLoad(),cn(e.props.t)):ln(e.props.t),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(7),"AbortError"!==t.t0.name&&on(e.props.t);case 18:case"end":return t.stop()}}),t,null,[[7,15]])})));return function(e){return t.apply(this,arguments)}}(),e.handleSubmit=function(){var t=Object(h.a)(p.a.mark((function t(a){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a.preventDefault(),e.handleInstall(parseInt(e.state.count));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleInstallCountChange=function(t){(""===t.target.value||/^\d+$/.test(t.target.value))&&e.setState({count:t.target.value})},e.handleFullRefresh=function(){e.props.doCampReload().then((function(){e.props.doPlacementLoad(e.props.match.params.placement)})),e.props.doVehicleReload(),e.handlePlacementsLoad()},e}return Object(b.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){this.props.placement._id||this.props.doPlacementLoad(this.props.match.params.placement),this.handlePlacementsLoad()}},{key:"render",value:function(){var e=this;if(!this.props.placement._id)return null;var t=this.props.placement.installs.filter((function(e){return e.installed})).map((function(e){return e.count})).reduce((function(e,t){return e+t}),0),a=this.props.placement.count,n=this.props.t;return console.log("placementView.state",this.state),r.a.createElement(r.a.Fragment,null,r.a.createElement("h4",{className:"text-center mt-0"},n("i.vehicle.placement.selected.title")),r.a.createElement(N.a,{className:"text-center"},r.a.createElement(_.a,null,r.a.createElement("strong",null,this.props.placement.place.name)),r.a.createElement(_.a,null,t,"/",a)),r.a.createElement(fe.a,{striped:!0,variant:"success",now:100*t/a}),r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement(B.a,{className:"mt-2"},r.a.createElement(R.a,{onChange:this.handleInstallCountChange,placeholder:n("i.install.form.input.placeholder"),value:this.state.count}),r.a.createElement(B.a.Append,null,r.a.createElement(T.a,{className:"waves-effect",variant:"primary",type:"submit"},n("i.install.form.button.label"))))),this.state.installs.filter((function(t){return t.campaign._id===e.props.campaign._id})).length>0&&r.a.createElement("h4",{className:"text-center mt-5"},n("i.install.form.title.currentInstalls")),r.a.createElement("div",{className:"mb-3",style:{marginLeft:10,marginRight:10}},this.state.installs.length>0&&this.state.installs.filter((function(t){return t.campaign._id===e.props.campaign._id})).map((function(t){return r.a.createElement(nn,{key:t.id,doRemove:function(){return en(e.props.vehicle._id,t.placement._id,n,e.handleFullRefresh)},data:t})}))),r.a.createElement(an.a,{show:!this.state.showOthers&&this.state.installs.filter((function(t){return t.campaign._id!==e.props.campaign._id})).length>0,variant:"warning",className:"mt-4 mb-0"},r.a.createElement(an.a.Heading,null,n("i.install.form.others.title")),r.a.createElement("p",null,n("i.install.form.others.text")),r.a.createElement("hr",null),r.a.createElement("div",{className:"d-flex justify-content-end"},r.a.createElement(T.a,{onClick:function(){return e.setState({showOthers:!0})},variant:"outline-warning",style:{color:"#856404",borderColor:"#856404"}},n("i.install.form.others.button")))),this.state.showOthers&&r.a.createElement("div",{className:"mt-4 pt-4 mb-2",style:{marginLeft:10,marginRight:10}},r.a.createElement("h4",{className:"text-center"},n("i.install.form.title.otherCampaigns")),this.state.installs.filter((function(t){return t.campaign._id!==e.props.campaign._id})).map((function(t){return r.a.createElement(rn,{key:t.id,doRemove:function(){return en(e.props.vehicle._id,t.placement._id,n,e.handleFullRefresh)},data:t})}))))}}]),a}(n.Component),un=Object(s.b)()(mn),dn=function(e){var t=e.data,a=e.doSelection,n=e.path,c=t.installs.map((function(e){return e.count})).reduce((function(e,t){return e+t}),0),l=t.count;return r.a.createElement(_.a,{xs:6,md:4,onClick:a},r.a.createElement(j.a,{to:"".concat(n,"/").concat(t._id),style:{color:"black"}},r.a.createElement(w.a,{className:"text-center mb-1 mt-2 shadow"},r.a.createElement(w.a.Body,{className:"waves-effect pl-1 pr-1"},r.a.createElement("strong",null,c,"/",l),r.a.createElement("div",{className:"description font-sm"},t.place.name)),r.a.createElement(fe.a,{className:"card-bottom-progress",variant:"success",now:100*c/l,style:{borderRadius:0}}))))},pn=Object(s.b)()((function(e){var t=e.t,a=e.campaign,n=e.doSelection,c=e.path;return r.a.createElement(r.a.Fragment,null,r.a.createElement("h4",{className:"text-center m-0"},t("i.vehicle.placements.title")),r.a.createElement(N.a,{className:"mt-3"},a.placements.map((function(e){return r.a.createElement(dn,{doSelection:function(){return n(e)},key:e._id,path:c,data:e})}))))})),hn=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={selectedPlacement:{}},e.controller=new AbortController,e.handlePlacementLoad=function(t){var a=e.props.campaign.placements.find((function(e){return e._id===t}));a?e.setState({selectedPlacement:a}):console.log("PLACEMENT DOES NOT EXIST")},e.handleSelection=function(t){e.setState({selectedPlacement:t})},e}return Object(b.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){this.props.vehicle._id||this.props.doVehicleLoad()}},{key:"render",value:function(){var e=this,t=this.props.t;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Pa,{campaign:this.props.campaign}),!this.props.vehicle._id&&null,this.props.vehicle._id&&r.a.createElement(Da.a,{style:{marginTop:135}},r.a.createElement(w.a,{className:"mb-2 mt-2 shadow",style:{border:"none"}},r.a.createElement(w.a.Body,{className:"pb-3"},r.a.createElement("h3",{className:"text-center mb-3 mt-0"},t("i.vehicle.placement.title")),r.a.createElement(N.a,{className:"text-center font-sm"},r.a.createElement(_.a,null,r.a.createElement(N.a,null,r.a.createElement(_.a,{xs:5,className:"m-auto",style:{padding:0}},r.a.createElement("img",{src:Object(oe.vehTypeObject)(this.props.vehicle._id).img,alt:Object(oe.vehTypeObject)(this.props.vehicle._id).name,height:"60"})),r.a.createElement(_.a,{xs:7,style:{padding:0}},r.a.createElement("strong",null,Object(oe.vehID)(this.props.vehicle._id),!this.props.vehicle.listed&&r.a.createElement(he.a,{variant:"warning"},t("i.vehicle.unlisted"))),r.a.createElement("div",{className:"description"},this.props.vehicle.operator.company)))),r.a.createElement(_.a,{className:"m-auto",style:{padding:0}},r.a.createElement("strong",null,this.props.vehicle.totalAds),r.a.createElement("div",{className:"description"},t("i.vehicle.placements")))))),r.a.createElement(w.a,null,r.a.createElement(w.a.Body,null,r.a.createElement(k.d,null,r.a.createElement(k.b,{path:"/install/c/:campaign/:vehicle/:placement",render:function(t){return r.a.createElement(un,Object.assign({},t,{doPlacementLoad:e.handlePlacementLoad,doCampReload:e.props.doCampReload,doVehicleReload:e.props.doVehicleLoad,path:"/install/c/".concat(t.match.params.campaign,"/").concat(t.match.params.vehicle,"/").concat(t.match.params.placement),placement:e.state.selectedPlacement,campaign:e.props.campaign,vehicle:e.props.vehicle}))}}),r.a.createElement(k.b,{path:"/install/c/:campaign/:vehicle/",render:function(t){return r.a.createElement(pn,{doSelection:e.handleSelection,path:"/install/c/".concat(t.match.params.campaign,"/").concat(t.match.params.vehicle),campaign:e.props.campaign})}}),r.a.createElement(k.b,{render:function(){return r.a.createElement(k.a,{to:"/install/c/".concat(e.state.campaign)})}}))))))}}]),a}(n.Component),fn=Object(s.b)()(hn),bn=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={selectedCampaign:{},selectedVehicle:{},redirect:!1},e.controller=new AbortController,e.handleCampaignLoading=function(){var t=Object(h.a)(p.a.mark((function t(a){var n,r,c,l;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n='query{campaign(_id:"'.concat(a,'"){ _id name startDate endDate } placementsForInstaller(_id:"').concat(a,'") { _id count place { name } installs { count installed } } }'),t.prev=1,t.next=4,L(n,e.controller.signal);case 4:r=t.sent,c=r.campaign,l=r.placementsForInstaller,c.placements=l,c?e.setState({selectedCampaign:c}):(console.log("Campaign not found",c),e.setState({redirect:!0})),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),console.log("error",t.t0);case 14:case"end":return t.stop()}}),t,null,[[1,11]])})));return function(e){return t.apply(this,arguments)}}(),e.handleVehicleSelect=function(t){e.setState({selectedVehicle:t})},e.handleVehicleLoading=function(){var t=Object(h.a)(p.a.mark((function t(a){var n,r,c;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n='query{ vehicle(_id:"'.concat(a,'"){ _id operator{company} totalAds listed}}'),t.prev=1,t.next=4,L(n,e.controller.signal);case 4:r=t.sent,(c=r.vehicle)?e.setState({selectedVehicle:c}):e.setState({redirect:!0}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),console.log("ERROR",t.t0),e.setState({redirect:!0});case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}(),e}return Object(b.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){this.handleCampaignLoading(this.props.match.params.campaign)}},{key:"render",value:function(){var e=this;return this.state.redirect?r.a.createElement(k.a,{push:!0,to:"/install"}):this.state.selectedCampaign._id?r.a.createElement(k.d,null,r.a.createElement(k.b,{path:"/install/c/:campaign/:vehicle",render:function(t){return r.a.createElement(fn,Object.assign({},t,{campaign:e.state.selectedCampaign,doVehicleLoad:Object(h.a)(p.a.mark((function a(){return p.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.handleVehicleLoading(t.match.params.vehicle);case 2:case"end":return a.stop()}}),a)}))),doCampReload:Object(h.a)(p.a.mark((function a(){return p.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.handleCampaignLoading(t.match.params.campaign);case 2:case"end":return a.stop()}}),a)}))),vehicle:e.state.selectedVehicle}))}}),r.a.createElement(k.b,{path:"/install/c/:campaign",render:function(t){return r.a.createElement(Xa,Object.assign({},t,{path:"/install/c/".concat(t.match.params.campaign),doVehicleSelect:e.handleVehicleSelect,campaign:e.state.selectedCampaign}))}})):null}}]),a}(n.Component),gn=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(e){var n;Object(f.a)(this,a),(n=t.call(this,e)).controller=new AbortController,n.searchTimeout=0,n.handleSearchChange=function(e){n.setState({search:e.target.value}),clearTimeout(n.searchTimeout),n.searchTimeout=setTimeout(n.loadVehicles,400)},n.handleSearchSubmit=function(e){e.preventDefault()},n.loadVehicles=Object(h.a)(p.a.mark((function e(){var t,a,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t='query{ activeVehicles(search:"'.concat(n.state.search,'", skip:0){_id listed operator{company} installs{count}}}'),e.prev=1,e.next=4,L(t,n.controller.signal);case 4:a=e.sent,(r=a.activeVehicles)&&(n.setState({vehicles:r}),console.log("Active vehicles loaded",r)),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),"SyntaxError"===e.t0.name||e.t0.name,console.log("error",e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));var r=n.props.match.params.campaign;return n.state={campaign:r,search:"",vehicles:[]},n}return Object(b.a)(a,[{key:"componentWillUnmount",value:function(){clearTimeout(this.searchTimeout),this.controller.abort()}},{key:"componentDidMount",value:function(){this.loadVehicles()}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(qa,{value:this.state.search,onChange:this.handleSearchChange,onSubmit:this.handleSearchSubmit,placeholder:"i.search.vehicle"}),r.a.createElement(Da.a,{style:{marginTop:65}},r.a.createElement(N.a,{className:"border-bottom",style:{display:"block"}},r.a.createElement("h4",{className:"text-center text-white"},this.props.t("i.vehicles.title"))),this.state.vehicles.map((function(e){return r.a.createElement(za,{key:e._id,data:e})}))))}}]),a}(n.Component),vn=Object(s.b)()(gn),En=Object(s.b)()((function(e){var t=e.data,a=e.doRemoving,n=e.t;return r.a.createElement(N.a,{className:"text-center p-2 pt-3 pb-3 shadow mt-2"},r.a.createElement(_.a,{xs:8,className:"m-auto"},r.a.createElement("strong",null,t.count,"x ",t.placement.place.name),r.a.createElement("div",{className:"description"},t.campaign.name)),r.a.createElement(_.a,{xs:4,className:"m-auto",style:{padding:0}},r.a.createElement(T.a,{onClick:a,variant:"danger",className:"waves-effect",style:{fontSize:"0.9rem"}},n("i.remove.form.button.label"))))})),yn=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={installs:[],vehicle:null,redirect:!1},e.controller=new AbortController,e.handleVehicleLoad=Object(h.a)(p.a.mark((function t(){var a,n,r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a='query{ vehicle(_id:"'.concat(e.props.match.params.vehicle,'"){ _id operator{company} listed}}'),t.prev=1,t.next=4,L(a,e.controller.signal);case 4:n=t.sent,(r=n.vehicle)?(console.log("Vehicle loaded",r),e.setState({vehicle:r})):(console.log("Vehicle not found",r),e.setState({redirect:!0})),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),console.log("ERROR",t.t0),e.setState({redirect:!0});case 13:case"end":return t.stop()}}),t,null,[[1,9]])}))),e.handlePlacementsLoad=Object(h.a)(p.a.mark((function t(){var a,n,r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a='query{ vehicleInstalls(_id:"'.concat(e.state.vehicle._id,'"){ id count campaign{ _id name } count placement{_id place{name}}}}'),t.prev=1,t.next=4,L(a,e.controller.signal);case 4:n=t.sent,(r=n.vehicleInstalls)&&e.setState({installs:$a(r)}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),console.log("error",t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])}))),e}return Object(b.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){var e=this;this.handleVehicleLoad().then((function(){e.handlePlacementsLoad()})).catch((function(){e.setState({redirect:!0})}))}},{key:"render",value:function(){var e=this;if(this.state.redirect)return r.a.createElement(k.a,{to:"/install/f"});if(!this.state.vehicle)return null;var t=this.props.t;return r.a.createElement(Da.a,null,r.a.createElement(w.a,{className:"mt-2 shadow",style:{border:"none"}},r.a.createElement(w.a.Body,null,r.a.createElement(N.a,{className:"text-center"},r.a.createElement(_.a,null,r.a.createElement(N.a,null,r.a.createElement(_.a,{xs:5,className:"m-auto",style:{padding:0}},r.a.createElement("img",{src:Object(oe.vehTypeObject)(this.state.vehicle._id).img,alt:Object(oe.vehTypeObject)(this.state.vehicle._id).name,height:"60"})),r.a.createElement(_.a,{xs:7,style:{padding:0}},r.a.createElement("strong",null,Object(oe.vehID)(this.state.vehicle._id),!this.state.vehicle.listed&&r.a.createElement(he.a,{variant:"warning"},t("i.vehicle.unlisted"))),r.a.createElement("div",{className:"description"},this.state.vehicle.operator.company)))),r.a.createElement(_.a,{className:"m-auto p-0"},r.a.createElement("strong",null,this.state.installs.length&&this.state.installs.map((function(e){return e.count})).reduce((function(e,t){return e+t}),0)),r.a.createElement("div",{className:"description"},t("i.vehicle.placements")))),r.a.createElement("div",{className:"border-top mt-4",style:{marginLeft:10,marginRight:10}},this.state.installs.map((function(a){return r.a.createElement(En,{key:a.id,doRemoving:function(){return en(e.state.vehicle._id,a.placement._id,t,e.handlePlacementsLoad)},data:a})}))))))}}]),a}(n.Component),wn=Object(s.b)()(yn),xn=function(){var e=Object(h.a)(p.a.mark((function e(t){var a,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"query{ installerMe{ _id }}",e.prev=1,e.next=4,L("query{ installerMe{ _id }}");case 4:a=e.sent,n=a.installerMe,t(n||null),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),t(null);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),kn=Object(s.b)()((function(e){var t=e.t,a=Object(n.useState)(""),c=Object(O.a)(a,2),l=c[0],i=c[1];if(null===l){var o=Object(n.useContext)(A);return r.a.createElement(Da.a,{className:"mt-5"},r.a.createElement(w.a,null,r.a.createElement(w.a.Body,{className:"text-center"},r.a.createElement("h4",{className:"text-center"},t("i.noTeam")),r.a.createElement(T.a,{variant:"primary",onClick:o.logout},r.a.createElement("i",{className:"dripicons-exit"})," ",t("i.logout")))))}return""===l?(xn(i),null):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{marginBottom:80}},r.a.createElement(k.d,null,r.a.createElement(k.b,{path:"/install/f/:vehicle/",component:Sa({component:wn,title:t("i.navbar.vehicle")})}),r.a.createElement(k.b,{path:"/install/f",component:Sa({component:vn,title:t("i.navbar.vehicles")})}),r.a.createElement(k.b,{path:"/install/c/:campaign",component:bn}),r.a.createElement(k.b,{path:"/install/h",component:Sa({component:Ja,title:t("i.navbar.history")})}),r.a.createElement(k.b,{path:"/install",component:Sa({component:Ga,title:t("i.navbar.campaigns")})}))),r.a.createElement(Ia.a,{fixed:"bottom",className:"navbar-container bg-main"},r.a.createElement(Da.a,null,r.a.createElement(N.a,{className:"text-white text-center i-bot-nav"},r.a.createElement(_.a,{xs:4},r.a.createElement(j.b,{to:"/install",exact:!0},r.a.createElement("i",{className:"fa fa-home"}))),r.a.createElement(_.a,{xs:4},r.a.createElement(j.b,{to:"/install/f"},r.a.createElement("i",{className:"fa fa-bus"}))),r.a.createElement(_.a,{xs:4},r.a.createElement(j.b,{to:"/install/h"},r.a.createElement("i",{className:"fa fa-history"})))))))})),An=a(155),On=a(153),Cn=Object(s.b)()((function(e){var t=e.i18n;return r.a.createElement(R.a,{defaultValue:t.language,onChange:function(e){return t.changeLanguage(e.target.value)},as:"select"},t.validLangs.map((function(e){var t=e.short;return r.a.createElement("option",{key:t,value:t},t.toUpperCase())})))}));function jn(){var e=Object(Je.a)(["\n  align-items: center;\n  justify-content: center;\n"]);return jn=function(){return e},e}function Sn(){var e=Object(Je.a)(["\n  border-width: 2px;\n  border-color: #a9a9a9ff;\n  border-radius: 4px;\n  padding: 5px;\n  width: 85%;\n"]);return Sn=function(){return e},e}function Nn(){var e=Object(Je.a)(["\n  padding: 5px;\n  margin-left: 10px;\n"]);return Nn=function(){return e},e}var _n=Ke.a.span(Nn()),Dn=Ke.a.input(Sn()),In=Ke.a.div(jn()),Tn=function(e){return r.a.createElement(an.a,{className:"mt-2",variant:e.type,onClose:function(){return e.hide()},dismissible:!0},e.message)},Bn=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={email:"",password:"",remember:!0,logging:null,expired:e.props.expired,invalid:!1,connection:e.props.connection,hidden:!0},e.controller=new AbortController,e.handleSubmit=function(){var t=Object(h.a)(p.a.mark((function t(a){var n,r,c;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),e.state.email&&e.state.password){t.next=3;break}return t.abrupt("return");case 3:return e.setState({logging:!0}),n='query{login(email:"'.concat(e.state.email,'",password:"').concat(e.state.password,'")}'),t.prev=5,t.next=8,L(n,e.controller.signal);case 8:r=t.sent,(c=r.login)?e.context.login(c,e.state.remember):e.setState({invalid:!0,logging:!1,expired:!1}),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(5),"SyntaxError"===t.t0.name?e.setState({connection:!0,logging:!1,expired:!1}):e.setState({invalid:!0,logging:!1,expired:!1});case 16:case"end":return t.stop()}}),t,null,[[5,13]])})));return function(e){return t.apply(this,arguments)}}(),e.handlePasswordToggle=function(){e.setState((function(e){return{hidden:!e.hidden}}))},e.handleUserChange=function(t){e.setState({email:t.target.value})},e.handlePassChange=function(t){e.setState({password:t.target.value})},e.handleRemeber=function(t){e.setState({remember:t.target.checked})},e}return Object(b.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"render",value:function(){var e=this,t=this.props.t,a=this.state.hidden;return r.a.createElement("div",{className:"wrapper-page"},r.a.createElement(w.a,null,r.a.createElement(w.a.Body,null,r.a.createElement("div",{className:"p-2"},r.a.createElement("h3",{className:"text-center m-0"},r.a.createElement("a",{href:"/",className:"logo logo-admin"},r.a.createElement("img",{src:va.a,height:"100",alt:"logo"}))),this.state.expired&&r.a.createElement(Tn,{message:t("login.failed.session"),hide:function(){return e.setState({expired:!1})},type:"warning"}),this.state.invalid&&r.a.createElement(Tn,{message:t("login.failed.invalid"),hide:function(){return e.setState({invalid:!1})},type:"danger"}),this.state.connection&&r.a.createElement(Tn,{message:t("login.failed.connection"),hide:function(){return e.setState({connection:!1})},type:"warning"}),r.a.createElement(I.a,{onSubmit:this.handleSubmit},r.a.createElement(In,null,r.a.createElement(I.a.Group,null,r.a.createElement(N.a,null,r.a.createElement(I.a.Label,null,t("login.email.label"))),r.a.createElement(N.a,null,r.a.createElement(Dn,{type:"email",name:"email",autoComplete:"username",placeholder:t("login.email.placeholder"),value:this.state.username,onChange:this.handleUserChange,required:!0}))),r.a.createElement(I.a.Group,null,r.a.createElement(N.a,null,r.a.createElement(I.a.Label,null,t("login.password.label"))),r.a.createElement(N.a,null,r.a.createElement(Dn,{minLength:"6",type:!0===a?"password":"text",name:"password",autoComplete:"password",placeholder:t("login.password.placeholder"),value:this.state.password,onChange:this.handlePassChange,required:!0}),r.a.createElement(_n,{onClick:this.handlePasswordToggle},!0===a?r.a.createElement(On.a,{icon:An.b}):r.a.createElement(On.a,{icon:An.a}))))),r.a.createElement(N.a,{className:"m-t-20"},r.a.createElement(_.a,{xs:6},r.a.createElement("div",{className:"custom-control custom-checkbox"},r.a.createElement("input",{type:"checkbox",className:"custom-control-input",id:"customControlInline",checked:this.state.remember,onChange:this.handleRemeber}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"customControlInline"},t("login.remember.label")))),r.a.createElement(_.a,{xs:6,className:"text-right"},r.a.createElement(T.a,{variant:"primary",className:"w-md waves-effect waves-light",type:"submit"},this.state.logging&&r.a.createElement(x.a,{animation:"border",size:"sm",className:"mr-1"}),t("login.button.submit.label"))))),r.a.createElement(N.a,null,r.a.createElement(_.a,{className:"m-t-20 p-0 d-flex align-items-center"},r.a.createElement(j.a,{className:"text-muted",to:"/reset_password"},r.a.createElement("i",{className:"mdi mdi-lock"}),t("login.forget.label"))),r.a.createElement(_.a,{xs:2,className:"m-t-20 p-0"},r.a.createElement(Cn,null)))))))}}]),a}(n.Component);Bn.contextType=A;var Rn=Object(s.b)()(Bn),Ln=[1,3,5],Fn=Object(s.b)()((function(e){var t=e.t;return r.a.createElement("div",{className:"wrapper-page"},r.a.createElement(w.a,null,r.a.createElement(w.a.Body,null,r.a.createElement("div",{className:"p-2"},r.a.createElement("div",{className:"text-center m-3"},r.a.createElement(x.a,{animation:"border",variant:"info",style:{width:"4rem",height:"4rem"}})),r.a.createElement("h4",{className:"mt-0 header-title text-center"},t("login.logging"))))))})),Mn=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).controller=new AbortController,n.tokenValidate=Object(h.a)(p.a.mark((function e(){var t,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"query{tokenValidate}",e.prev=1,e.next=4,L("query{tokenValidate}",n.controller.signal);case 4:t=e.sent,a=t.tokenValidate,n.login(a,!0),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),"SyntaxError"===e.t0.name?n.setState({validated:!1,connection:!0}):n.setState({validated:!1,expired:!0});case 12:case"end":return e.stop()}}),e,null,[[1,9]])}))),n.login=function(e,t){if(e){t?(localStorage.setItem("_t",e),sessionStorage.removeItem("_t")):(localStorage.removeItem("_t"),sessionStorage.setItem("_t",e));var a=y()(e);n.setState({token:e,user:{_id:a.userId,name:a.userName,role:a.userRole},tokenExpiration:a.exp,validated:!0,connection:!1,expired:!1})}},n.logout=function(){localStorage.removeItem("_t"),sessionStorage.removeItem("_t"),n.setState({token:null,user:{name:null,role:null},tokenExpiration:null,validated:null})},n.state={validated:null,expired:!1,connection:!1,token:null,user:{name:null,role:null},tokenExpiration:null},sessionStorage.getItem("ACCESS_TOKEN")&&(sessionStorage.setItem("_t",sessionStorage.getItem("ACCESS_TOKEN")),sessionStorage.removeItem("ACCESS_TOKEN")),localStorage.getItem("ACCESS_TOKEN")&&(localStorage.setItem("_t",localStorage.getItem("ACCESS_TOKEN")),localStorage.removeItem("ACCESS_TOKEN")),(sessionStorage.getItem("_t")||localStorage.getItem("_t"))&&(n.state.token=sessionStorage.getItem("_t")||localStorage.getItem("_t"),n.tokenValidate()),n}return Object(b.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"render",value:function(){var e=this.state,t=e.validated,a=e.token,n=e.user,c=e.expired,l=e.connection,i=e.tokenExpiration;return null===t&&null!==a?r.a.createElement(Fn,null):r.a.createElement(A.Provider,{value:{tokenExpiration:i,token:a,_id:n._id,name:n.name,role:n.role,validated:t,login:this.login,logout:this.logout}},!t&&r.a.createElement(Rn,{expired:c,connection:l}),t&&r.a.createElement(k.d,null,r.a.createElement(k.b,{path:"/install",component:kn}),Ln.includes(n.role)&&r.a.createElement(k.b,{path:"/dashboard",component:_a}),r.a.createElement(k.b,{component:function(){return r.a.createElement(Un,{role:n.role})}})))}}]),a}(n.Component),Un=function(e){var t=e.role;return Ln.includes(t)?r.a.createElement(k.a,{to:"/dashboard"}):r.a.createElement(k.a,{to:"/install"})},qn=Mn,Pn=a(46),Vn=Object(Pn.a)(),Wn=Object(s.b)()((function(e){var t=e.t,a=e.doSubmit,n=e.value,c=e.doEmailChange;return r.a.createElement(I.a,{onSubmit:a},r.a.createElement("h4",{className:"mt-0 header-title"},t("forget.title")),r.a.createElement("p",{className:"mb-10"},t("forget.from.email.label")),r.a.createElement(I.a.Group,null,r.a.createElement(I.a.Control,{type:"email",name:"email",autoComplete:"username",placeholder:t("forget.form.email.placeholder"),value:n,onChange:c,required:!0})),r.a.createElement(T.a,{variant:"primary",className:"w-md waves-effect waves-light",type:"submit"},t("forget.form.button.label")))})),Hn=Object(s.b)()((function(e){var t=e.t;return r.a.createElement(r.a.Fragment,null,r.a.createElement("h4",{className:"mt-0 header-title"},t("forget.submit.title")),r.a.createElement("p",{className:"mb-10"},t("forget.submit.description")))})),Gn=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={email:"",submit:!1},e.controller=new AbortController,e.handleSubmit=function(){var t=Object(h.a)(p.a.mark((function t(a){var n;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),e.state.email){t.next=3;break}return t.abrupt("return");case 3:return n='query{passwordRecovery(email:"'.concat(e.state.email,'")}'),t.prev=4,t.next=7,L(n,e.controller.signal);case 7:e.setState({submit:!0}),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(4),console.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[4,10]])})));return function(e){return t.apply(this,arguments)}}(),e.handleEmailChange=function(t){return e.setState({email:t.target.value})},e}return Object(b.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"render",value:function(){return r.a.createElement("div",{className:"wrapper-page"},r.a.createElement(w.a,null,r.a.createElement(w.a.Body,null,r.a.createElement("div",{className:"p-2"},!this.state.submit&&r.a.createElement(Wn,{doEmailChange:this.handleEmailChange,doSubmit:this.handleSubmit,value:this.state.email}),this.state.submit&&r.a.createElement(Hn,null)))))}}]),a}(n.Component),zn=Object(s.b)()((function(e){var t=e.t,a=e.doSubmit,n=e.pass1,c=e.doPassword1Change,l=e.pass2,i=e.doPassword2Change;return r.a.createElement(I.a,{onSubmit:a},r.a.createElement("h4",{className:"mt-0 header-title"},t("reset.title")),r.a.createElement(I.a.Group,null,r.a.createElement(I.a.Label,null,t("reset.form.password1.label")),r.a.createElement(I.a.Control,{type:"password",pattern:".{6,}",placeholder:t("reset.form.password1.placeholder"),value:n,onChange:c,required:!0})),r.a.createElement(I.a.Group,null,r.a.createElement(I.a.Label,null,t("reset.form.password2.label")),r.a.createElement(I.a.Control,{type:"password",pattern:".{6,}",placeholder:t("reset.form.password2.placeholder"),value:l,onChange:i,required:!0})),r.a.createElement(T.a,{variant:"primary",className:"w-md waves-effect waves-light",type:"submit"},t("reset.form.button.submit")))})),Qn=Object(s.b)()((function(e){var t=e.t;return r.a.createElement(r.a.Fragment,null,r.a.createElement("h4",{className:"mt-0 header-title"},t("reset.submit.title")),r.a.createElement("p",{className:"mb-10"},t("reset.submit.description")),r.a.createElement(j.a,{className:"btn btn-primary w-md waves-effect waves-light",to:"/login"},t("reset.submit.button.redirect.login")))})),Yn=Object(s.b)()((function(e){var t=e.t;return r.a.createElement(r.a.Fragment,null,r.a.createElement("h4",{className:"mt-0 header-title"},t("reset.invalid.title")),r.a.createElement("p",{className:"mb-10"},t("reset.invalid.description")),r.a.createElement(j.a,{className:"btn btn-primary w-md waves-effect waves-light",to:"/reset_password"},t("reset.invalid.button.redirect.reset")))})),Zn=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={password1:"",password2:"",token:"",tokenError:!1,success:!1},e.controller=new AbortController,e.handleSubmit=function(){var t=Object(h.a)(p.a.mark((function t(a){var n,r,c,l;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),e.state.token){t.next=3;break}return t.abrupt("return");case 3:if(e.state.password1){t.next=5;break}return t.abrupt("return");case 5:if(e.state.password2){t.next=7;break}return t.abrupt("return");case 7:if(e.state.password1===e.state.password2){t.next=9;break}return t.abrupt("return");case 9:return n='mutation{resetPassword(token:"'.concat(e.state.token,'", password:"').concat(e.state.password1,'")}'),t.prev=10,t.next=13,L(n,e.controller.signal);case 13:r=t.sent,c=r.resetPassword,l=e.props.t,c?(ee.a.fire({icon:"success",title:l("reset.form.success.title"),showConfirmButton:!1,timer:1500}),e.setState({success:!0})):ee.a.fire({icon:"error",title:l("reset.form.invalid.title"),text:l("reset.form.invalid.text"),showConfirmButton:!1,timer:1500}),t.next=22;break;case 19:t.prev=19,t.t0=t.catch(10),console.log(t.t0);case 22:case"end":return t.stop()}}),t,null,[[10,19]])})));return function(e){return t.apply(this,arguments)}}(),e.validateToken=function(){var t=Object(h.a)(p.a.mark((function t(a){var n,r,c;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n='query{recoveryValidate(token:"'.concat(a,'")}'),t.prev=1,t.next=4,L(n,e.controller.signal);case 4:r=t.sent,(c=r.recoveryValidate)?e.setState({token:c}):e.setState({tokenError:!0}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),e.setState({tokenError:!0}),console.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}(),e.handlePassword1Change=function(t){return e.setState({password1:t.target.value})},e.handlePassword2Change=function(t){return e.setState({password2:t.target.value})},e}return Object(b.a)(a,[{key:"componentDidMount",value:function(){this.validateToken(this.props.match.params.token)}},{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"render",value:function(){return this.state.token||this.state.tokenError?r.a.createElement("div",{className:"wrapper-page"},r.a.createElement(w.a,null,r.a.createElement(w.a.Body,null,r.a.createElement("div",{className:"p-2"},this.state.tokenError&&r.a.createElement(Yn,null),!this.state.tokenError&&!this.state.success&&r.a.createElement(zn,{doPassword1Change:this.handlePassword1Change,doPassword2Change:this.handlePassword2Change,doSubmit:this.handleSubmit,pass1:this.state.password1,pass2:this.state.password2}),!this.state.tokenError&&this.state.success&&r.a.createElement(Qn,null))))):null}}]),a}(n.Component),Jn=Object(s.b)()(Zn),Kn=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={campaign:{},loaded:!1,selected:"",progress:{},index:0,lightbox:!1},e.controller=new AbortController,e.handleSelection=function(t){e.state.selected!==t?e.setState({selected:t}):e.setState({selected:""})},e.openLightBox=function(){var t=e.props.t;e.state.campaign&&e.state.campaign.pictures&&e.state.campaign.pictures.length>0?e.setState({lightbox:!0}):ee.a.fire({icon:"info",title:t("db.campaign.images.info.empty.title"),text:t("db.campaign.images.info.empty.text"),showConfirmButton:!1,timer:3e3})},e}return Object(b.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"componentDidMount",value:function(){var e=Object(h.a)(p.a.mark((function e(){var t,a,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t='query{campaign(_id:"'.concat(this.props.match.params.id,'"){\n            _id name client{_id company}creator{_id name}budget startDate endDate created_at cities{name latitude longitude}\n            pictures { path thumbnail created_at }\n            placements{_id place{name} installs{installed vehicle{_id city{name}operator{company operatorId}}created_at count}\n      count isPublic}}}'),e.prev=1,e.next=4,L(t,this.controller.signal,this.props.token);case 4:a=e.sent,(n=a.campaign)?this.setState({campaign:n,loaded:!0}):this.setState({loaded:!0}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.log("Ohnoo, ",e.t0.toString()),this.setState({loaded:!0});case 13:case"end":return e.stop()}}),e,this,[[1,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"getMapData",value:function(){return{height:530,query:'query{campaignVehicles(_id: "'.concat(this.state.campaign._id,'"){_id haveAds longitude latitude}}'),latitude:this.state.campaign.cities[0].latitude,longitude:this.state.campaign.cities[0].longitude,zoom:7,getData:function(e){return e.campaignVehicles},smooth:!0,token:this.props.token,details:!1}}},{key:"totalFleets",value:function(){var e,t=[],a=Object(S.a)(this.state.campaign.placements);try{for(a.s();!(e=a.n()).done;){var n,r=e.value,c=Object(S.a)(r.installs);try{for(c.s();!(n=c.n()).done;){var l=n.value;t.push(l.vehicle._id)}}catch(i){c.e(i)}finally{c.f()}}}catch(i){a.e(i)}finally{a.f()}return new Set(t).size}},{key:"timeLeftPercent",value:function(){return((new Date).getTime()-this.state.campaign.startDate)/(this.state.campaign.endDate-this.state.campaign.startDate)*100}},{key:"render",value:function(){var e=this,t=this.props.t;if(this.state.loaded&&0===Object.keys(this.state.campaign).length)return r.a.createElement("div",{className:"container-fluid text-center"},r.a.createElement("h3",{className:"text-white"},t("db.campaign.404")));var a=this.state.campaign.pictures,n=this.state.index;return r.a.createElement("div",{className:"container-fluid"},this.state.lightbox&&r.a.createElement(pe.a,{mainSrc:a[n].path,nextSrc:a[(n+1)%a.length].path,prevSrc:a[(n+a.length-1)%a.length].path,onCloseRequest:function(){return e.setState({lightbox:!1})},onMovePrevRequest:function(){return e.setState({index:(n+a.length-1)%a.length})},onMoveNextRequest:function(){return e.setState({index:(n+1)%a.length})}}),r.a.createElement(N.a,{className:"border-bottom mb-4"},r.a.createElement(_.a,{xs:12},r.a.createElement("h3",{className:"text-white"},!this.state.loaded&&"Loading...",this.state.loaded&&this.state.campaign.client.company+": "+this.state.campaign.name,this.state.loaded&&r.a.createElement("div",{className:"float-right campview-images",onClick:this.openLightBox},r.a.createElement("i",{className:"ion ion-images"})," Images"," ",r.a.createElement(he.a,{variant:a.length?"success":"danger"},a.length))))),r.a.createElement(N.a,null,r.a.createElement(_.a,{md:12,xl:4,className:"mb-4"},r.a.createElement(Re,{data:{loaded:this.state.loaded,startDate:this.state.loaded&&this.state.campaign.startDate,endDate:this.state.loaded&&this.state.campaign.endDate,now:this.state.loaded&&this.timeLeftPercent()}})),r.a.createElement(_.a,{md:6,xl:4},r.a.createElement(Le,{data:{loaded:this.state.loaded,cities:this.state.loaded&&this.state.campaign.cities.map((function(e){return e.name})).join(", "),vehicles:this.state.loaded&&this.totalFleets()}})),r.a.createElement(_.a,{md:6,xl:4},r.a.createElement(Fe,{data:{loaded:this.state.loaded,creator:this.state.loaded&&this.state.campaign.creator,date:this.state.loaded&&this.state.campaign.created_at}}))),r.a.createElement(N.a,null,r.a.createElement(_.a,{xl:8},r.a.createElement(Ue,{data:{loaded:this.state.loaded,mapData:this.state.loaded&&this.getMapData(),selected:this.state.selected,handleSelection:this.handleSelection}})),r.a.createElement(_.a,{xl:4},r.a.createElement(Pe,{data:{loaded:this.state.loaded,placements:this.state.loaded&&this.state.campaign.placements}}))),r.a.createElement(N.a,null,this.state.loaded&&r.a.createElement(_.a,{xl:8},r.a.createElement(We,{data:{placements:this.state.campaign.placements,rowCallback:function(t,a){return t.onclick=function(){return e.handleSelection(a._id)}}}})),this.state.selected&&r.a.createElement(_.a,{xl:4},r.a.createElement(me,{data:this.state.selected,token:this.props.token}))))}}]),a}(n.Component);Kn.contextType=A;var Xn=Object(s.b)()(Kn),$n=Object(s.b)()((function(e){var t=e.t,a=e.token,n=e.match;return r.a.createElement("div",{id:"wrapper"},r.a.createElement("div",{className:"content-page",style:{marginLeft:0}},r.a.createElement("div",{className:"content"},r.a.createElement("div",{className:"page-content-wrapper",style:{paddingTop:0}},r.a.createElement(Xn,{token:a,match:n,client:!0}))),r.a.createElement("footer",{className:"footer"},"\xa9 ",t("company.name"))))})),er=function(e){var t=e.type,a=e.hide,n=e.message;return r.a.createElement(an.a,{className:"mt-2",variant:t,onClose:function(){return a()},dismissible:!0},n)},tr=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={password:"",logging:null,invalid:!1,connection:!1,token:""},e.controller=new AbortController,e.handleSubmit=function(){var t=Object(h.a)(p.a.mark((function t(a){var n,r,c;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),e.state.password){t.next=3;break}return t.abrupt("return");case 3:return e.setState({logging:!0}),n='query{campaignLogin(_id:"'.concat(e.props.match.params.id,'",password:"').concat(e.state.password,'")}'),t.prev=5,t.next=8,L(n,e.controller.signal);case 8:r=t.sent,(c=r.campaignLogin)?e.setState({token:c}):e.setState({invalid:!0,logging:!1}),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(5),"SyntaxError"===t.t0.name?e.setState({connection:!0,logging:!1}):e.setState({invalid:!0,logging:!1});case 16:case"end":return t.stop()}}),t,null,[[5,13]])})));return function(e){return t.apply(this,arguments)}}(),e.handlePassChange=function(t){return e.setState({password:t.target.value})},e}return Object(b.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"render",value:function(){var e=this;if(this.state.token)return r.a.createElement($n,{token:this.state.token,match:this.props.match});var t=this.props.t;return r.a.createElement("div",{className:"wrapper-page"},r.a.createElement(w.a,null,r.a.createElement(w.a.Body,null,r.a.createElement("div",{className:"p-2"},r.a.createElement("h3",{className:"text-center m-0"},r.a.createElement("a",{href:"/",className:"logo logo-admin"},r.a.createElement("img",{src:va.a,height:"100",alt:"logo"}))),this.state.invalid&&r.a.createElement(er,{message:t("login.failed.invalid"),hide:function(){return e.setState({invalid:!1})},type:"danger"}),this.state.connection&&r.a.createElement(er,{message:t("login.failed.connection"),hide:function(){return e.setState({connection:!1})},type:"warning"}),r.a.createElement(I.a,{onSubmit:this.handleSubmit},r.a.createElement(I.a.Group,null,r.a.createElement(I.a.Label,null,t("login.password.label")),r.a.createElement(I.a.Control,{pattern:".{6,}",type:"password",placeholder:t("login.password.placeholder"),value:this.state.password,onChange:this.handlePassChange,required:!0})),r.a.createElement(I.a.Group,{className:"m-t-20"},r.a.createElement(_.a,{xs:12,className:"text-right"},r.a.createElement(T.a,{variant:"primary",className:"w-md waves-effect waves-light",type:"submit"},this.state.logging&&r.a.createElement(x.a,{animation:"border",size:"sm",className:"mr-1"}),t("login.button.submit.label"))))),r.a.createElement(N.a,null,r.a.createElement(_.a,{className:"m-t-20 p-0"}),r.a.createElement(_.a,{xs:2,className:"m-t-20 p-0"},r.a.createElement(Cn,null)))))))}}]),a}(n.Component),ar=Object(s.b)()(tr),nr=function(){return r.a.createElement(k.c,{history:Vn},r.a.createElement(k.d,null,r.a.createElement(k.b,{path:"/reset_password",component:Gn}),r.a.createElement(k.b,{path:"/new_password/:token",component:Jn}),r.a.createElement(k.b,{path:"/campaign/:id",component:ar}),r.a.createElement(k.b,{component:qn})))};l.a.render(r.a.createElement(nr,null),document.getElementById("root"))},93:function(e,t,a){e.exports=a.p+"static/media/logo.7d82b0fb.svg"}},[[192,1,2]]]);
//# sourceMappingURL=main.d8b96f79.chunk.js.map